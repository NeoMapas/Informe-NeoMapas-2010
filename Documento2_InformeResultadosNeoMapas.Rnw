\documentclass[spanish,12pt]{report}
\usepackage[utf8]{inputenc} 
\usepackage[T1]{fontenc}
\usepackage[spanish]{babel}
\usepackage{lscape}

\usepackage[shiftmargins]{vmargin}
\setpapersize{USletter}
%%\setmarginsrb{left}{top}{right}{bottom}{headhgt}{headsep}{foothgt}{footskip}
\setmarginsrb{3.2cm}{2cm}{1.8cm}{2cm}{0.5cm}{0.5cm}{0.5cm}{0.5cm}

\usepackage[Glenn]{fncychap}
\usepackage{longtable}
%% cambiamos a biblatex
%%\usepackage[authoryear,sort]{natbib}

\usepackage[natbib=true, style=authoryear]{biblatex}
\bibliography{/home/jferrer/NeoMapas/lib/BibTEX/DocumentosNM,%
/home/jferrer/NeoMapas/lib/BibTEX/paquetesR}
%/Users/jferrer/NeoMapas/lib/BibTEX/tesis



\usepackage[pagebackref=false,colorlinks=true,citecolor=black,linkcolor=black,filecolor=black,urlcolor=black]{hyperref}

\newcommand{\HRule}{\rule{\linewidth}{0.5mm}}
\usepackage{titling}

\pretitle{\begin{center} 
\large \colorbox{black}{\textcolor{white}{Iniciativa para el Mapeo de la Biodiversidad Neotropical}} \par \HRule \\[0.4cm] \LARGE }
\posttitle{\par \HRule \\[1.5cm]
\includegraphics[width=8cm]{/home/jferrer/NeoMapas/img/logo_NeoMapas.jpg}
\end{center}\vskip 0.5em}

\preauthor{\large\begin{center}}
\postauthor{\\
Unidad de Biodiversidad, Centro de Ecología y Centro de Estudios Botánicos y Agroforestales\\Instituto Venezolano de Investigaciones Científicas
\end{center}
\par}

\predate{\begin{center}\normalsize Informe de uso interno\\\Sexpr{cdg.doc}\\}
\date{Versión de \today}
\postdate{\par\end{center}}


\title{Informe de resultados de muestreos de NeoMapas a nivel nacional 2001 a 2010}
\author{JR Ferrer-Paris, Jon Paul Rodríguez, Ada Y. Sánchez-Mercado, Gustavo A. Rodríguez}

\begin{document}
\maketitle
%\bibliographystyle{/Users/jferrer/NeoMapas/lib/custom-bib/tesis}


\chapter*{A quien pueda interesar}

Documento de uso interno de la iniciativa NeoMapas que contiene resultados preliminares, y puede contener fragmentos de información, datos y/o análisis tomados de otros informes de la iniciativa. En caso de dudas o inconsistencias por favor consulte la información más actualizada en la página web de NeoMapas: \url{http://www.neomaps.org}.

<<echo=false, eval=true, results=hide>>=
require(foreign)
require(ade4)
require(vegan)
require(cluster)
require(xtable)
require(labdsv)
require(randomForest)
require(gtools)
require(sp)
require(gdata)
require(RColorBrewer)
require(spatstat)
require(ROpenOffice)

paquetes <- (.packages())
paquetes <- paquetes[!(paquetes %in% c("stats", "graphics", "grDevices", "utils", "datasets", "methods", "base", "deldir", "DBI", "RMySQL"))]

luq <- function(x,contar.NA=FALSE) {
	if (contar.NA==F) {
	x <- x[!is.na(x)]
	}
 length(unique(x))
 }

@

El documento es generado por medio de las funciones de \texttt{Sweave} desde una sesión de \emph{R} \citep{pqt::base}, por tanto todas las tablas y figuras se generan y actualizan automáticamente a partir de los datos suministrados. Para acceso al código fuente en \emph{R} y los archivos de datos contacte al primer autor. Dentro de \emph{R} utilizamos los paquetes 
<<citas paquetes, results=tex, echo=false, eval=true>>=
cat(paste("\\emph{",paquetes,"} \\citep{pqt::",paquetes,"}",sep="",collapse="; "))
@
.

El informe se basa en tablas de datos generadas a partir de las bases de datos \texttt{NM\_Mariposas}, \texttt{NM\_Escarabajos}, \texttt{NM2009} y \texttt{NM\_Aves} guardadas en un servidor MySQL, la base de datos de \texttt{NeoMapas Aves} en formato MDB, y tablas con la identificación de escarabajos coprófagos por trampa provistas por Angel Solís.

<<Datos de otras fuentes, eval=true, echo=false, results=hide>>=

##load("~/NeoMapas/Rdata/LIT.rda") ## sustituimos esto por el siguiente: 
load("~/NeoMapas/Rdata/RevisionLiteratura.rda")

load("~/NeoMapas/Rdata/MSM.rda")
##load("~/NeoMapas/Rdata/GBIF.rda")
load("~/NeoMapas/Rdata/GBIFcsv.rda")
## para no ocupar tanto espacio de memoria
rm(list=grep("Plantae",ls(),value=T))
rm(list=grep("Mammalia",ls(),value=T))


if(!exists("lamas")) {
	lamas <- read.ods("~/NeoMapas/etc/1_Coleccion/130_Taxonomia/Lamas2004_2011_06_22_Todo.ods",TRUE,stringsAsFactors=F)
}
if(!exists("tbl.scrb")) {
	tbl.scrb <- read.ods(file="~/NeoMapas/etc/1_Coleccion/130_Taxonomia/20110701_Scarabaeinae.ods",TRUE,stringsAsFactors=F)
}

	Mariposas <- data.frame()
	cols <- colnames(lamas[[2]])
	for (i in names(lamas)[-1]) {
		tt <- lamas[[i]]
		colnames(tt) <- cols
		Mariposas <- rbind(Mariposas, tt)
	}

Escarabajos <- tbl.scrb[["Taxonomia"]]


mrps.BDV <- mrps.cneb[mrps.cneb$adm0 %in% "VEN" & mrps.cneb$validacion %in% c("exacto", "ortografico", "soundex epiteto",  "soundex genero","manual"),]

mrps.BDV$cdg_ref[mrps.BDV$cdg_ref == "Nei 92"] <- "Nei92"
mrps.BDV$cdg_ref[mrps.BDV$cdg_ref == "miza"] <- "MIZA"
mrps.BDV$cdg_ref[mrps.BDV$cdg_ref == "RAC91"] <- "Rac91"
mrps.BDV$cdg_ref[mrps.BDV$cdg_ref == "VIL94a"] <- "Vil94a"
mrps.BDV$cdg_ref[mrps.BDV$cdg_ref == "ViL98"] <- "Vil98"

mrps.BDV0 <- mrps.BDV[!is.na(mrps.BDV$lat) & !is.na(mrps.BDV$lon),]

scrb.BDV <- scrb.cneb[scrb.cneb$adm0 %in% "VEN" & scrb.cneb$validacion %in% c("vld-auto :: concordancia exacta", "heredada", "manual"),]
scrb.BDV0 <- scrb.BDV[!is.na(scrb.BDV$lat) & !is.na(scrb.BDV$lon),]

pird.BDV0 <- mrps.BDV0[grepl("^097",mrps.BDV0$cdg),c("cdg","lon","lat","cneb")]
colnames(pird.BDV0) <- c("especie","lon","lat","cneb")

scrb.otrs <- scrb.BDV0[, c("ecdg","lon","lat","cneb")]
colnames(scrb.otrs) <- c("especie","lon","lat","cneb")

mrps.otrs <- rbind(pird.BDV0,
	jmp.Museos[,c("especie","lon","lat","cneb")])

mrps.otrs$spp <- paste(Mariposas$gen[match(mrps.otrs$especie,Mariposas$ecdg)], Mariposas$esp[match(mrps.otrs$especie,Mariposas$ecdg)], sep=" ")

##mrps.otrs$spp[mrps.otrs$especie %in% c("097-00103","097-00101")] <- "Eurema sp. [daira o elathea]"
mrps.otrs$spp[mrps.otrs$especie %in% c("097-00095","097-00091")] <- "Pyrisitia sp. [nise/venusta]"

mrps.OTR <- table(mrps.otrs$cneb,mrps.otrs$spp)
##tt <- data.frame(t(estimateR.matrix(mrps.OTR)))
##tt <- data.frame(t(estimateR(mrps.OTR)))
tt <- data.frame(t(apply(mrps.OTR,1,estimateR)))

mi.ss <- rowSums(mrps.OTR)>5 & rowSums(mrps.OTR)>rowSums(mrps.OTR>0) & !is.na(tt$se.chao1) & (tt$se.chao1)<tt$S.obs
mrps.slc <- rownames(mrps.OTR)[mi.ss]


scrb.otrs$spp <- paste(Escarabajos$genero[match(scrb.otrs$especie,Escarabajos$cdg_especie)], Escarabajos$epiteto[match(scrb.otrs$especie,Escarabajos$cdg_especie)], sep=" ")

scrb.OTR <- table(scrb.otrs$cneb,scrb.otrs$spp)
##tt <- data.frame(t(estimateR.matrix(scrb.OTR)))
##tt <- data.frame(t(estimateR(scrb.OTR))) #WRONG!
tt <- data.frame(t(apply(scrb.OTR,1,estimateR)))
mi.ss <- rowSums(scrb.OTR)>5 & rowSums(scrb.OTR)>rowSums(scrb.OTR>0) & !is.na(tt$se.chao1) & (tt$se.chao1)<tt$S.obs
scrb.slc <- rownames(scrb.OTR)[mi.ss]


@


<<Cargar Datos NM, echo=false, eval=true, results=hide>>=
## datos de las bases de datos de NeoMapas
load(file="~/NeoMapas/Rdata/NM.rda")

##Definimos tres fases del trabajo de campo
tvn.NM$fase <- NA
tvn.NM$fase[tvn.NM$fecha < "2006-06-30"] <- 1
tvn.NM$fase[tvn.NM$yr %in% c(2009, 2010) & tvn.NM$NM!="97"] <- 3
tvn.NM$fase[tvn.NM$fecha > "2006-06-30" & tvn.NM$yr==2006] <- 2
jmp.NM$fase <- NA
jmp.NM$fase[jmp.NM$tvn %in% tvn.NM$tvn[tvn.NM$fase %in% 1]] <- 1
jmp.NM$fase[jmp.NM$tvn %in% tvn.NM$tvn[tvn.NM$fase %in% 2]] <- 2
jmp.NM$fase[jmp.NM$tvn %in% tvn.NM$tvn[tvn.NM$fase %in% 3]] <- 3
##table(tvn.NM$fase,useNA="always")

mi.tvn <- tvn.NM[tvn.NM$fase %in% 2,]

mi.jmp <- jmp.NM[(jmp.NM$fase %in% 2) &jmp.NM$fam=="Pieridae" & !is.na(jmp.NM$genero) & jmp.NM$especie != "sp.",]

mi.jmp$esp <- paste(mi.jmp$genero,mi.jmp$especie)

##mi.jmp$esp[mi.jmp$esp %in% c("Eurema daira","Eurema elathea")] <- "Eurema sp. [daira o elathea]"

mrps.NM <- tapply(mi.jmp$jmp,list(mi.jmp$NM,mi.jmp$esp),function(x){length(unique(x))})
mrps.NM[is.na(mrps.NM)] <- 0
mrps.NM <- mrps.NM[,colSums(mrps.NM)>0]
mrps.sfrz <- aggregate(mi.tvn$sfrz,by=list(mi.tvn$NM),sum,na.rm=T)
mrps.sfrz <- mrps.sfrz$x[match(rownames(mrps.NM),mrps.sfrz$Group.1)]

mrps.CN <- mrps.NM
rownames(mrps.NM) <- paste("NM",rownames(mrps.NM)," :: ",info.NM$Nombre[match(as.numeric(rownames(mrps.NM)),info.NM$NM)],sep="")
rownames(mrps.CN) <- info.NM$CNEB[match(as.numeric(rownames(mrps.CN)),info.NM$NM)]
@ 

<<Cargar SIG,eval=true, echo=false, results=hide>>=
load(file="~/NeoMapas/Rdata/SIG.rda")
##VBG <- read.dbf("/var/local/gis/mi.gis/Venezuela/NeoMapas/dbf/VBG.dbf")
##VBG <- read.dbf("/Users/jferrer/mi.gis/Venezuela/NeoMapas/dbf/VBG.dbf")
VBG <- read.dbf("/home/jferrer/mi.gis/Venezuela/NeoMapas/dbf/VBG.dbf")
CNEB.nm <- merge(CNEB@data,VBG, by=1:5)
CNEB.nm <- CNEB.nm[match(CNEB@data$cdg,CNEB.nm$cdg),]

##CNEB.nm$bioreg <- factor(CNEB.nm$bioreg)
##CNEB.nm$bioreg <- factor(CNEB.nm$bioreg,labels=c("Otro","Occident","Andean mountains","Coastal mountains","Llanos","Guayana"),levels=c(0,1,5,2,3,4))

CNEB.nm$bioreg <- factor(CNEB.nm$bioreg,labels=c("Otro","Occidente","Andes", "Centro y Costa","Llanos","Guayana"),levels=c(0,1,5,2,3,4))
info.NM[,"Bioregión"] <- CNEB.nm[match(info.NM$CNEB,CNEB.nm$cdg),"bioreg"]


@


<<Cargar Datos Solis, echo=false, eval=true, results=hide>>=

## datos de identificaciones de escarabajos de Solís
tmp <- read.csv("~/NeoMapas/data/AngelSolisDatos/DatosScarabSetiembre2010.csv", sep="\t", header=T, as.is=T,nrow=5)
scrb.solis <- read.csv("~/NeoMapas/data/AngelSolisDatos/DatosScarabSetiembre2010.csv", sep="\t", header=F, as.is=T, skip=2)
colnames(scrb.solis) <- c("NM", "Prd", "Fecha", "Caja", "ADN", colnames(tmp)[6:ncol(tmp)])
##head(tmp)
scrb.solis$yr <- sapply(scrb.solis$Fecha,function(x){strsplit(x,"/")[[1]][3]},simplify=T)
scrb.solis$ttl <- rowSums(scrb.solis[,colnames(tmp)[6:(ncol(tmp)-1)]])
scrb.solis <- scrb.solis[!is.na(scrb.solis$yr) ,]
scrb.solis$NM[scrb.solis$NM=="1000IVIC"] <- "97"
scrb.solis$NM[scrb.solis$NM=="10"] <- "92"
scrb.solis$NM <- sprintf("%02i",as.numeric(scrb.solis$NM))
@


<<Cargar Datos NMAves, echo=false, eval=true, results=hide>>=
## datos de observación de aves de Gustavo Rodríguez
NM.m1 <- read.csv("~/NeoMapas/data/NMAves2010/Muestreo1.total.csv")
NM.m2 <- read.csv("~/NeoMapas/data/NMAves2010/Muestreo2.total.csv")
NM.lista <-  read.csv("~/NeoMapas/data/NMAves2010/AvesVistas.total.csv",as.is=T)

spp.aves <- read.csv("~/NeoMapas/data/NMAves2010/Venezuela.total.csv",as.is=T)
trans.info <- read.csv("~/NeoMapas/data/NMAves2010/Transectas.total.csv",as.is=T)
trans.info[,c("NM","CNEB","Bioregión")] <- 
info.NM[match(trans.info$Nombretransecta,info.NM$Nombre),c("NM", "CNEB", "Bioregión")]
trans.info$NM <- sprintf("%02s",trans.info$NM)


mi.ss <- NM.m1$Especieid!=1379
mi.s2 <- NM.m2$Especieid!=1379
##aves.NM <- table(NM.m1$IDTransecta[mi.ss],NM.m1$Especieid[mi.ss])

##aves.NM <- tapply(c(NM.m1$Ntotal[mi.ss],NM.m2$Ntotal[mi.s2]),list(c(NM.m1$IDTransecta[mi.ss],NM.m2$IDTransecta[mi.s2]),c(NM.m1$Especieid[mi.ss],NM.m2$Especieid[mi.s2])),sum,na.rm=T)
aves.NM <- tapply(c(NM.m1$Ntotal[mi.ss]),list(NM.m1$IDTransecta[mi.ss],NM.m1$Especieid[mi.ss]),sum,na.rm=T)
aves.NM[is.na(aves.NM)] <- 0
@

<<Cargar Datos GPS NMAves, echo=false, eval=true, results=hide>>=
pps <- data.frame()
##/Applications/gpsbabel
for (ff in dir(pattern=".gdb$","~/NeoMapas/lib/gps/Mapsource_NMAves2010/")) {
system(paste("gpsbabel -i gdb -f ~/NeoMapas/lib/gps/Mapsource_NMAves2010/",gsub(" ","\\\\\\ ",ff)," -o csv,prefer_shortnames -F tmp.csv",sep=""))
pps <- rbind(pps,read.csv("tmp.csv",header=F, as.is=T))
}
pps$V3 <- trim(tolower(pps$V3))

muestreos <- pps[grep("^[1-7][a-g]-[0-9]",pps$V3),c("V2","V1","V3")]
muestreos$NM <- substr(muestreos$V3,0,2)
muestreos <- unique(muestreos)

NM.m1$idpunto <- sprintf("%s-%03d",NM.m1$IDTransecta,NM.m1$Punto)
NM.m2$idpunto <- sprintf("%s-%03d",NM.m2$IDTransecta,NM.m2$Punto)

NM.m1[,c("lat","lon")] <-  pps[match(NM.m1$idpunto,pps$V3),c("V1","V2")]
NM.m1[is.na(NM.m1$lat),c("lat","lon")] <-  pps[match(sub("-0","-",NM.m1$idpunto[is.na(NM.m1$lat)]),pps$V3),c("V1","V2")]

NM.m2[,c("lat","lon")] <-  pps[match(NM.m2$idpunto,pps$V3),c("V1","V2")]
NM.m2[is.na(NM.m2$lat),c("lat","lon")] <-  pps[match(sub("-0","-",NM.m2$idpunto[is.na(NM.m2$lat)]),pps$V3),c("V1","V2")]

mi.ss <- NM.m1$Especieid!=1379
mi.s2 <- NM.m2$Especieid!=1379
##aves.NM <- table(NM.m1$IDTransecta[mi.ss],NM.m1$Especieid[mi.ss])

aves.NM <- tapply(c(NM.m1$Ntotal[mi.ss]),list(NM.m1$IDTransecta[mi.ss],NM.m1$Especieid[mi.ss]),sum,na.rm=T)
aves.NM[is.na(aves.NM)] <- 0

colnames(aves.NM) <- spp.aves$Latname[match(colnames(aves.NM),spp.aves$N_ave)]
aves.CN <- aves.NM
rownames(aves.NM) <- trans.info[match(rownames(aves.NM),trans.info$IDTransecta),"Nombretransecta"]

rownames(aves.CN) <- info.NM$CNEB[match(rownames(aves.NM),info.NM$Nombre)]

mi.ss <- NM.m2$Especieid!=1379
m2 <- table(NM.m2$IDTransecta[mi.ss],NM.m2$Especieid[mi.ss])
@ 


<<taxonomia aves, eval=true, echo=false, results=hide>>=
load(file="~/CEBA/Rdata/taxonomia/aves.rda")

spps <- spp.aves[,c("Latname","Name")]

spps$status <- "no determinado"
spps$altname <- spp.aves$Latname

mi.ss <- iocn$Species..Scientific. != ""

spps$status[tolower(spps$Name) %in%  tolower(iconv(iocn$Species..English.[mi.ss],"latin1","utf8"))] <- "nombre en ingles"

spps$status[sub("us$","a",spps$Latname) %in%  iconv(iocn$spp[mi.ss],"latin1","utf8")] <- "correccion ortografica"
spps$status[sub("a$","us",spps$Latname) %in%  iconv(iocn$spp[mi.ss],"latin1","utf8")] <- "correccion ortografica"

spps$status[spps$Latname %in%  iconv(iocn$spp[mi.ss],"latin1","utf8")] <- "valido"


spps$altname[spps$status=="nombre en ingles"] <- iocn[match(spps$Name[spps$status=="nombre en ingles"], iocn$Species..English.),"spp"]

spps$altname[spps$status=="correccion ortografica"] <- iocn[match(sub("a$","us",spps$Latname)[spps$status=="correccion ortografica"], iocn$spp),"spp"]

spps$altname[spps$status=="correccion ortografica" & is.na(spps$altname)] <- iocn[match(sub("us$","a",spps$Latname)[spps$status=="correccion ortografica" & is.na(spps$altname)], iocn$spp),"spp"]


table(spps$Latname==spps$altname,spps$status)

for (j in spps[spps$status=="no determinado","Latname"]) {
guess <- iocn[grep(strsplit(j," ")[[1]][2],iocn$spp),]
if (nrow(guess)==1) {
	cat(paste(j,"==>",guess$spp,"\n"))
	spps[spps$Latname==j,c("status","altname")] <- c("auto: match epiteto",guess$spp)
	} else {
	cat(paste(j," tiene ",nrow(guess), " ", paste(guess$spp, collapse="; ")," matches\n"))
	}
}



spps[spps$Latname=="Caprimulgus carolinensis",c("status","altname")] <- c("cambio manual","Antrostomus carolinensis")
spps[spps$Latname=="Icterus chrysocephalus",c("status","altname")] <- c("cambio manual","Icterus cayanensis")
 
spps[spps$Latname=="Otus roraimae",c("status","altname")] <- c("cambio manual","Megascops roraimae")
spps[spps$Latname=="Otus ingens",c("status","altname")] <- c("cambio manual","Megascops ingens")
spps[spps$Latname=="Otus albogularis",c("status","altname")] <- c("cambio manual","Megascops albogularis")
spps[spps$Latname=="Lophotriccus pilaris",c("status","altname")] <- c("cambio manual","Atalotriccus pilaris")

spps[spps$Latname=="Coeligena eos",c("status","altname")] <- c("cambio manual","Coeligena bonapartei")
spps[spps$Latname=="Amazilia cupreicauda",c("status","altname")] <- c("cambio manual","Amazilia viridigaster")

spps[spps$Latname=="Heliangelus clarisse",c("status","altname")] <- c("cambio manual","Heliangelus amethysticollis")

spps[spps$Latname=="Buarremon torquatus",c("status","altname")] <- c("cambio manual","Arremon torquatus")
spps[spps$Latname=="Buarremon brunneinuchus",c("status","altname")] <- c("cambio manual","Arremon brunneinucha")
spps[spps$Latname=="Ramphotrigon megacephala",c("status","altname")] <- c("cambio manual","Ramphotrigon megacephalum")
spps[spps$Latname=="Pyrrhura caeruleiceps",c("status","altname")] <- c("cambio manual","Pyrrhura picta")
spps[spps$Latname=="Dysithamnus tucuyensis",c("status","altname")] <- c("cambio manual","Dysithamnus leucostictus")
spps[spps$Latname=="Basileuterus roraimae",c("status","altname")] <- c("cambio manual","Basileuterus bivittatus")

table(spps$Latname==spps$altname,spps$status)

table(iocn[iocn$spp %in% spps[match(spp.aves$Latname,spps$Latname),"altname"],"Order"])
table(iocn[iocn$spp %in% spps[match(colnames(aves.NM),spps$Latname),"altname"],"Order"])

Aves.iocn <- merge(spps,iocn,by.x="altname",by.y="spp")

colnames(aves.NM) <- tolower(spps[match(colnames(aves.NM),spps$Latname),"altname"])

@



Utilizamos datos espaciales de la Cuadrícula para el Estudio de la Biodiversidad en Venezuela (CNEB), y de varias variables ambientales y climáticas. Adicionalmente utilizamos datos de fuentes alternativas de información sobre biodiversidad en Venezuela: datos digitalizados de colecciones, revisión de la literatura y consultas al portal de datos de GBIF.

% incluir lista de colaboradores de NeoMapas...

Los datos y los resultados finales de estos análisis serán publicados de manera oportuna. Por favor considere esta información confidencial y no la difunda sin autorización expresa de los autores. La versión más actualizada de este documento está disponible en la página web de \url{http://www.neomaps.org}.


\tableofcontents
%\thispagestyle{mipreambulo}
\listoffigures
%\thispagestyle{mipreambulo}
\listoftables


\chapter{Iniciativa para el Mapeo de la Diversidad Neotropical}



\section{Actividades de NeoMapas}

Entre 2001 y 2010 desarrollamos e implementamos protocolos para el muestreo de tres grupos indicadores en Venezuela: la clase aves, la subfamilia Scarabaeinae o escarabajos coprófagos (Coleoptera) y las 6 familias de Rhopalocera o mariposas diurnas (Lepidoptera). Estas actividades están resumidas en la tabla \ref{TAB:RESUMEN}. 

En los años 2006, 2009 y 2010 ofrecimos el Curso Internacional sobre Inventario y Monitorización de la Biodiversidad Neotropical, dirigido a estudiantes de pre- y posgrado. En 2006 y 2009 el curso estuvo relacionado con las actividades de muestreo de invertebrados. En 2010 el curso estuvo dirigido al desarrollo de proyectos de cada uno de los participantes. Adicionalmente, en marzo de 2010 se ofreció un entrenamiento especial a los participantes del muestreo de Aves.


<<echo=false,results=hide>>=


sfrz <- jmps <- nms <- sfrze <- nme <- jmpe <- sfrza <- nma <- jmpa <- c()
sfrz["2005"] <- sum(tvn.NM$sfrz[tvn.NM$yr %in% 2003:2005],na.rm=T)/60
sfrz["2006"] <- sum(tvn.NM$sfrz[tvn.NM$yr %in% 2006],na.rm=T)/60
sfrz["2009"] <- sum(tvn.NM$sfrz[tvn.NM$yr %in% 2009:2010],na.rm=T)/60

sfrze["2005"] <- sum(trmp.NM$sfrz[trmp.NM$yr %in% 2003:2005],na.rm=T)
sfrze["2006"] <- sum(trmp.NM$sfrz[trmp.NM$yr %in% 2006],na.rm=T)
sfrze["2009"] <- sum(trmp.NM$sfrz[trmp.NM$yr %in% 2009:2010],na.rm=T)

nms["2005"] <- luq(tvn.NM$NM[tvn.NM$yr %in% 2003:2005])
nms["2006"] <- luq(tvn.NM$NM[tvn.NM$yr %in% 2006])
nms["2009"] <- luq(tvn.NM$NM[tvn.NM$yr %in% 2009:2010])

nme["2005"] <- luq(trmp.NM$NM[trmp.NM$yr %in% 2003:2005])
nme["2006"] <- luq(trmp.NM$NM[trmp.NM$yr %in% 2006])
nme["2009"] <- luq(trmp.NM$NM[trmp.NM$yr %in% 2009:2010])

jmps["2005"] <- length(jmp.NM$jmp[jmp.NM$tvn %in% tvn.NM$tvn[tvn.NM$yr %in% 2003:2005]])
jmps["2006"] <- length(jmp.NM$jmp[jmp.NM$tvn %in% tvn.NM$tvn[tvn.NM$yr %in% 2006]])
jmps["2009"] <- length(jmp.NM$jmp[jmp.NM$tvn %in% tvn.NM$tvn[tvn.NM$yr %in% 2009:2010]])


jmpe["2005"] <- sum(scrb.solis[scrb.solis$yr %in% "05",6:(ncol(scrb.solis)-3)],na.rm=T)+nrow(scr.NM[scr.NM$yr =="2005" & scr.NM$NM %in% c("09","24","26"),])

jmpe["2006"] <- sum(scrb.solis[scrb.solis$yr %in% "06",6:(ncol(scrb.solis)-3)],na.rm=T)
jmpe["2009"] <- sum(scrb.solis[scrb.solis$yr %in% "09",6:(ncol(scrb.solis)-3)],na.rm=T)


sfrza["2002"] <- sum(avs.NM$sfrz[substr(avs.NM$fch,1,4) %in% c("2001","2002")])/60

sfrza["2010"] <- ((nrow(unique(NM.m1[,c("IDTransecta","Punto")]))*3)+(nrow(unique(NM.m2[,c("IDTransecta","Punto")]))*9))/60

nma["2002"] <- luq(avs.NM$NM[substr(avs.NM$fch,1,4) %in% c("2001","2002")])
nma["2010"] <- luq(NM.m1$IDTransecta)

jmpa["2010"] <- nrow(unique(NM.m1))+nrow(unique(NM.m2))

jmpa["2002"] <- nrow(obs.NM)

sfrze <- round(sfrze,1)
sfrz <- round(sfrz,1)
sfrza <- round(sfrza,1)
@ 


\begin{table}[hbp]
\caption{Resumen de las acividades de NeoMapas entre 2001 y 2010. \emph{URAs} se refiere al número de unidades regionales de análisis (transecciones o celdas de la cuadrícula) en las cuales se agrupan los muestreos; unidades de esfuerzo de muestreo, \emph{h*c}: horas colector, \emph{h*t}: horas trampa, \emph{h*o}: horas observador.}
\label{TAB:RESUMEN}
\begin{center}
\begin{tabular}{cp{5cm}cccp{2.1cm}}
\hline
Grupo & Actividad & Año & URAs & Esfuerzo & Ejemplares / registros\\
\hline
Mariposas & Calibración y estudio piloto & 2003-2005 & \Sexpr{nms["2005"]} & \Sexpr{sfrz["2005"]} h*c &\Sexpr{jmps["2005"]}  \\ 
Mariposas & Muestreo nacional & 2006 & \Sexpr{nms["2006"]} & \Sexpr{sfrz["2006"]} h*c &\Sexpr{jmps["2006"]}  \\ 
Mariposas & Muestreo nacional & 2009-2010 &  \Sexpr{nms["2009"]} &\Sexpr{sfrz["2009"]} h*c &\Sexpr{jmps["2009"]}  \\ 
\hline
Escarabajos & Calibración de métodos & 2005 & \Sexpr{nme["2005"]} & \Sexpr{sfrze["2005"]} h*t &\Sexpr{jmpe["2005"]}  \\ 
Escarabajos & Estudio piloto & 2006 & \Sexpr{nme["2006"]} & \Sexpr{sfrze["2006"]} h*t &\Sexpr{jmpe["2006"]}  \\ 
Escarabajos & Muestreo nacional & 2009-2010 &  \Sexpr{nme["2009"]} &\Sexpr{sfrze["2009"]} h*t &\Sexpr{jmpe["2009"]}  \\ 
\hline
Aves & Calibración de métodos & 2001-2002 & \Sexpr{nma["2002"]} & \Sexpr{sfrza["2002"]} h*o &\Sexpr{jmpa["2002"]}  \\ 
Aves & Muestreo nacional & 2010 &  \Sexpr{nma["2010"]} &\Sexpr{sfrza["2010"]} h*o  &\Sexpr{jmpa["2010"]} \\ 
\hline
\end{tabular}
\end{center}
\end{table}

<<echo=false, results=hide>>=

ttl.loc <- nrow(unique(round(rbind(tvn.NM[,c("lon","lat")], trmp.NM[,c("lon","lat")], avs.NM[,c("lon","lat")], NM.m1[,c("lon","lat")], NM.m2[,c("lon","lat")]),3)))

ttl.spp <- luq(NM.m1$Especieid)+luq(jmp.NM$especie)+luq(paste(scr.NM$genero,scr.NM$especie))

@

\setkeys{Gin}{width=.75\textwidth}
\begin{figure}[htb]
\begin{center}
<<mapaResumen,fig=true, echo=false, results=hide>>=
par(mar=c(1,0,2,0))

slc.avs <- c(info.NM$CNEB[match(rownames(aves.NM),info.NM$Nombre)],info.NM$CNEB[match(as.numeric(unique(avs.NM$NM)),info.NM$NM)])

slc.scrb <- info.NM$CNEB[match(as.numeric(unique(trmp.NM$NM)),info.NM$NM)]
slc.scrb <- slc.scrb[!is.na(slc.scrb)]

slc.mrps <- info.NM$CNEB[match(as.numeric(unique(tvn.NM$NM)),info.NM$NM)]
slc.mrps <- slc.mrps[!is.na(slc.mrps)]

br <- CNEB.nm$bioreg[order(CNEB.nm$row,CNEB.nm$col)]
mi.col <- c(0,"thistle","palegoldenrod","peachpuff3","whitesmoke","wheat")
plot(CNEB,col=mi.col[br],
     border=mi.col[br])

plot(vzla[!(vzla@data$ID %in% 36),],border="grey57",add=T)
plot(vzla[vzla@data$ID %in% 36,],add=T,border="grey57",col="grey87")

tds <- data.frame(scrb=CNEB@data$cdg %in% slc.scrb,mrps=CNEB@data$cdg %in% slc.mrps,aves=CNEB@data$cdg %in% slc.avs)

stars(tds[rowSums(tds)>0,],draw.segments=T,locations=coordinates(CNEB[rowSums(tds)>0,]),labels="",add=T,col.segments=NA,len=.25,lwd=2,key.labels=colnames(tds),key.loc=c(-72,1))
text(coordinates(vzla),sub("Dependencias Federales","",iconv(as.character(vzla@data$ESTADO),"latin1","utf8")),cex=.5)

legend(-73,5,levels(br)[-1],fill=mi.col[-1],bty="n")
@ 
\end{center} 
\caption[Mapa resumen de muestreos de NeoMapas]{Ubicación de los muestreos de NeoMapas desde 2001 para cada uno de los tres grupos taxonómicos (mrps: mariposas papilionoidea y hesperioidea, scrb: subfamilia scarabaeinae y aves: clase aves), en las cinco bioregiones consideradas.}
\label{MAPA:RESUMEN}
\end{figure}


\section{Productos}

Las actividades de NeoMapas han generado una colección entomológica de mariposas y escarabajos, y una base de datos con la información de los muestreos de los tres grupos taxonómicos.

El esfuerzo acumulado en este periodo de tiempo alcanzó \Sexpr{ttl.loc} localidades de muestreo y observación, \Sexpr{sum(jmpe,jmps)} especímenes de invertebrados capturados y \Sexpr{sum(jmpa)} registros de aves. Los datos representan \Sexpr{ttl.spp} especies/morfotipos hasta la fecha, pero todavía quedan muchos ejemplares por identificar. 

NeoMapas tiene datos de al menos un grupo taxonómico para \Sexpr{luq(c(slc.mrps,slc.scrb,slc.avs))} celdas de la Cuadrícula de referencia para el estudio de la biodiversidad en Venezuela (CNEB), esto representa  \Sexpr{round(100*luq(c(slc.mrps,slc.scrb,slc.avs))/sum(CNEB.nm$VEN),1)}\% de las celdas que cubren todo el país, y \Sexpr{round(100*luq(c(slc.mrps,slc.scrb,slc.avs))/sum(CNEB.nm$UM),1)}\% de las celdas accesibles por carretera.

Estos datos estarán accesibles desde la página web de NeoMapas: \url{http://www.neomapas.org}.

\section{Resultados}

NeoMapas puede ser considerado el mayor registro sistemático para cualquier país tropical. Actualmente estamos dedicados al análisis de los datos obtenidos durante las diferentes actividades de NeoMapas. En este documento presentaremos un resumen de los métodos empleados para realizar los muestreos a nivel nacional, y de los principales resultados obtenidos hasta el momento.

En el capítulo \ref{CAP:DISEÑO} mostraremos los detalles del diseño muestral de NeoMapas. Luego en los capítulo \ref{CAP:MRPS}, \ref{CAP:SCRB}, \ref{CAP:AVES} mostraremos el resumen de los muestreos de Mariposas, el muestreo de escarabajos y el muestreo de Aves. En el capítulo \ref{CAP:RSLTS} mostramos análisis preliminares enfocados en una parte de los datos de NeoMapas, y cerramos con conclusiones y recomendaciones en el capítulo \ref{CAP:DSCN}.

\chapter{Diseño Muestral}
\label{CAP:DISEÑO}

El diseño muestral utilizado está orientado hacia zonas representativas de los gradientes ambientales observados a nivel nacional, mientras que los métodos de colecta de cada grupo taxonómico han sido adaptados para poder estimar la detectabilidad a nivel individual y específico.

Para diseñar un inventario extensivo, estructurado y eficiente es necesario
lograr un registro de especies representativo en cada unidad de análisis  \citep{YNB01,WMH02} y garantizar una óptima cobertura de los gradientes o patrones de variación esperados, de forma tal que permita una extrapolación de las variables de interés  \citep{HL05,Wal.98,Fer02}.%cita de hortal y lobo 2005, biodiversity and conservation.

Un diseño muestral anidado permite cumplir con estos dos propósitos  \citep{Bal.98,Nal.98,Mal.06a}. Primero definimos un conjunto de regiones por medio de un criterio de selección que garantice la representación de la diversidad ambiental  \citep[por ejemplo por medio de un muestreo aleatorio estratificado, complementariedad, gap análisis o algoritmos de ubicación óptima, ver][]{FW96,Bel95,HL05}. Estas regiones constituyen las Unidades Regionales de Análisis (URAs). Para cada URA definimos una transecta o ruta que cubre un gradiente de máxima variación ambiental  \citep[``gradsects'', ver ][]{Wal.98}, a lo largo del cual se toman muestras en una serie de localidades por medio de un protocolo de campo estandarizado. Estas localidades son las Unidades Elementales de Muestreo (UEM). 

El esfuerzo total de muestreo se debe repartir entre la escala de muestreo y la escala regional de tal forma que sea posible comparar patrones (i) dentro de cada URA a lo largo de las transecciones definidas, (ii) entre dos o más URAs al hacer comparaciones entre los totales de las transecciones, (iii) a lo largo de gradientes ambientales mayores o regiones biogeográficas según las variables que se hayan utilizado para definir las URAs, y (iv) en variables no asociadas a la escala espacial, por ejemplo patrones estacionales, ciclos diarios de actividad y asociación a condiciones micro-climáticas o tipos de hábitats.% Dr. Who?

Si bien este diseño muestral general puede ser válido para muchos taxones diferentes, existen algunos elementos que deben ajustarse a las particularidades del organismo de estudio. Debido a la limitación de recursos, siempre habrá un compromiso entre el número de URA y el esfuerzo de muestreo dentro de cada URA \citep{Bee06}. Por ello la repartición de las unidades de muestreo debe adecuarse a los patrones de variación espacial y temporal en la detectabilidad, abundancia y distribución de cada organismo \citep{Tal.03,YNB01,Mal.06a}. Igualmente la selección del protocolo de campo utilizado en cada UEM debe ser específica para cada grupo y garantizar que los resultados obtenidos para cada taxón sean comparables. % buscar una cita sobre la necesidad de adaptar el protocolo de campo

Por último, el deseo de realizar un inventario sistemático no debe imponer un esquema riguroso de muestreo \citep{LL10}%Lindenmayer 2010
. Según los resultados que se vayan obteniendo, debe ser posible ajustar el esfuerzo de muestreo para rellenar vacíos de información no previstos anteriormente \citep{HL05}.

\section{La Cuadrícula Nacional para el Estudio de la Biodiversidad y el universo muestral}

Una cuadrícula de referencia nacional permite la división objetiva del territorio en unidades de estudio comparables y permite guiar y planificar esfuerzos de investigación y conservación eficientemente \citep{Gibbons1994}. Por ello proponemos el uso de una cuadrícula de referencia (Cuadrícula Nacional para el Estudio de la Biodiversidad, CNEB) compuesta por celdas cuadradas de 0,5 grados en coordenadas geográficas (apróximadamente 55,5 km en la proyección acimutal de Lambert de áreas equivalentes, o 3\,080,35 km$^2$). 

Dentro de esta cuadrícula definimos el universo muestral como el conjunto de celdas del CNEB que tuviesen al menos un 40\% (1\,250 km$^2$) de su área en la Venezuela continental y la Isla de Margarita, y que presentara al menos 30 km$^2$ cubiertos por carretera (Fig.~\ref{MAPA:CNEB}). Las celdas de las cuadrículas se identifican por una combinación de letras de la \emph{a} a la \emph{w} (filas) y números del 01 al 27 (columnas).

\setkeys{Gin}{width=\textwidth}
\begin{figure}[htbp]
\begin{center}

<<mapaUM1, fig=true, eval=true, echo=false,results=hide>>=
um <- as.character(CNEB.nm$cdg[CNEB.nm$UM==1])
par(mar=c(1,0,1,0))

##Cuadrícula con los códigos en los bordes
plot(vzla,col=NA,border=NA,ylim=c(0,13))

text(rep(-73.5,23),unique(CNEB@data$y),unique(CNEB@data$fila),cex=.5)
text(unique(CNEB@data$x),rep(12.4,27),unique(CNEB@data$col),cex=.5)
## División política
plot(CNEB[CNEB@data$cdg %in% um,],border="grey77",col="grey77",add=T)
plot(vzla,border="maroon",add=T)
plot(vzla[vzla@data$ID %in% 36,],add=T,border="maroon",col="grey87")

plot(CNEB[CNEB@data$cdg %in% VBG$cdg[VBG$vzla>0],],border="grey47",add=T)
text(coordinates(vzla),sub("NA","",sub("Dependencias Federales","",iconv(as.character(vzla@data$ESTADO),"latin1","utf8"))),cex=.5)

xs <- seq(-72,-60,by=2)
ys <- rep(0.5,length(xs))
points(xs,ys,pch=3,cex=.7)
text(xs,ys-.3,paste(abs(xs),"º00' W",sep=""),cex=.7)

ys <- seq(1,11,by=2)
xs <- rep(-58,length(ys))
points(xs,ys,pch=3,cex=.7)
text(xs+.3,ys,paste(abs(ys),"º00' N",sep=""),cex=.7,srt=90)

## agregar mapa de ubicación continental [bajar resolución...]
##op <- par(fig=c(0.03,.3,0.15,.45),new=TRUE,xpd=F,mar=c(0.5,2,0.5,2))
##plot(amgnsn,border="grey73", xlim=c(-4500004,4000004),ylim=c(-6568465,8264709))
##abline(h=0,lty=3,col=2)
##plot(amgnsn[amgnsn@data$COUNTRY %in% "VENEZUELA",],col=1,add=T)
##box()
##par(op)

@

\end{center} 
\caption[CNEB y universo muestral de NeoMapas]{Primera propuesta de la Cuadrícula Nacional para el Estudio de la Biodiversidad (CNEB) y el universo muestral (UM, celdas grises) de NeoMapas; los ejes derecho e inferior muestran las coordenadas geográficas, mientras que los ejes izquierdo y superior muestran el código de las filas y columnas de cada celda de la cuadrícula.}
\label{MAPA:CNEB}
\end{figure}

\setkeys{Gin}{width=.85\textwidth}

Utilizamos datos disponibles de distribución de especies para estos tres grupos taxonómicos, y elaboramos curvas de acumulación de especies para todo el país y para el universo muestral de NeoMapas. Los resultados en la figura \ref{FIG:TAUUM} muestran que el universo muestral es un subconjunto representativo de la riqueza de especies en Venezuela. 

\begin{figure}[htbp]
\begin{center}
<<tauUM,echo=false, results=hide, fig=true>>=
tmp1 <- CNEB.mtz.Aves[rownames(CNEB.mtz.Aves) %in% CNEB.nm$cdg[CNEB.nm$UM==1],]
tmp1 <- tmp1[,colSums(tmp1)>0]
tmp2 <- CNEB.mtz.Aves[rownames(CNEB.mtz.Aves) %in% CNEB.nm$cdg[CNEB.nm$VEN==1],]
tmp2 <- tmp2[,colSums(tmp2)>0]

tau.avs.um <- specaccum(tmp1,method="exact",conditioned=FALSE,gamma="chao")
tau.avs.ve <- specaccum(tmp2,method="exact",conditioned=FALSE,gamma="chao")

tmp1 <- scrb.OTR[rownames(scrb.OTR) %in% CNEB.nm$cdg[CNEB.nm$UM==1],]
tmp1 <- tmp1[,colSums(tmp1)>0]
tmp2 <- scrb.OTR[rownames(scrb.OTR) %in% CNEB.nm$cdg[CNEB.nm$VEN==1],]
tmp2 <- tmp2[,colSums(tmp2)>0]

tau.scrb.um <- specaccum(tmp1,method="exact",conditioned=FALSE,gamma="chao")
tau.scrb.ve <- specaccum(tmp2,method="exact",conditioned=FALSE,gamma="chao")

tmp1 <- mrps.OTR[rownames(mrps.OTR) %in% CNEB.nm$cdg[CNEB.nm$UM==1],]
tmp1 <- tmp1[,colSums(tmp1)>0]
tmp2 <- mrps.OTR[rownames(mrps.OTR) %in% CNEB.nm$cdg[CNEB.nm$VEN==1],]
tmp2 <- tmp2[,colSums(tmp2)>0]


tau.mrps.um <- specaccum(tmp1,method="exact",conditioned=FALSE,gamma="chao")
tau.mrps.ve <- specaccum(tmp2,method="exact",conditioned=FALSE,gamma="chao")

layout(matrix(1:4,ncol=2))
par(oma=c(0,0,0,0))
 plot(tau.avs.ve, main="Aves")
plot(tau.avs.um,add=T,col=2)
 plot(tau.scrb.ve,main="Scarabaeinae")
plot(tau.scrb.um,add=T,col=2)
 plot(tau.mrps.ve,main="Pieridae")
plot(tau.mrps.um,add=T,col=2)
@
\end{center} 
\caption{Comparación de la riqueza de especies esperada para toda Venezuela (curvas e intervalos negros) y para el universo muestral de NeoMapas (curvas e intervalos rojos). Para la curva de Aves utilizamos datos de una consulta a GBIF, para los Scarabaeinae utilizamos registros georeferenciados de una revisión de la literatura disponible, para las mariposas (familia Pieridae) utilizamos registros digitalizados y georeferenciados de una revisión de la literatura y de varias colecciones entomológicas (ver Apéndice \ref{CAP:FUENTES}).}
\label{FIG:TAUUM}
\end{figure}


\section{Variabilidad ambiental y estratos ambientales}


Utilizamos la altura, la tempratura media anual, la precipitación anual total, el número de meses secos, la cobertura arborea total y la cobertura de bosque decíduo tomadas de \citet{BO96,Hal.05} y \citet{Dal.00c}. Para cada variable calculamos los valores promedios, y el intervalo de variación dentro de cada celda de la CNEB. Adicionalmente consideramos la latitud y longitud media de cada celda como una variable espacial. De este conjunto de 14 variables eliminamos variables altamente correlacionadas hasta conseguir un valor del factor de inflación de la varianza menor a 2 para todas las variables restantes. El resultado fueron 10 variables que se muestran en la tabla \ref{TAB:VIF}.

<<eval=true, echo=false,results=hide>>=
## variables que faltaban
rngs <- CNEB.nm[,grep("max",colnames(CNEB.nm),value=T)]-CNEB.nm[,grep("min",colnames(CNEB.nm),value=T)]

colnames(rngs) <- sub("max","rng",colnames(rngs))
CNEB.nm <- cbind(CNEB.nm,rngs)

vars.nm <- c("lon", "lat", "altr_avrg", "altr_rng", "tmpm_avrg", "tmpm_rng", "prcp_avrg", "prcp_rng", "mscs_avrg", "mscs_rng", "bosq_avrg", "bosq_rng", "decd_avrg", "decd_rng")

mi.cneb <- CNEB.nm[CNEB.nm$UM==1,vars.nm]
rownames(mi.cneb) <- CNEB.nm[CNEB.nm$UM==1,"cdg"]
VIFs.a <- c()
for (mv in vars.nm) {
	VIFs.a <- c(VIFs.a,(sqrt(1/(1-summary(step(lm(formula(paste(mv,"~",".")),mi.cneb)))$adj.r.squared))))
}
names(VIFs.a) <- vars.nm

vars.nm <- c("altr_avrg", "prcp_rng","prcp_avrg", "tmpm_rng", "mscs_avrg", "mscs_rng", "bosq_avrg", "bosq_rng", "decd_avrg", "decd_rng")

alt.cneb <- CNEB.nm[CNEB.nm$UM==1,vars.nm]
rownames(alt.cneb) <- CNEB.nm[CNEB.nm$UM==1,"cdg"]
VIFs <- c()
for (mv in vars.nm) {
	VIFs <- c(VIFs,(sqrt(1/(1-summary(step(lm(formula(paste(mv,"~",".")),mi.cneb)))$adj.r.squared))))
}
names(VIFs) <- vars.nm

vars.alt <- c("altr_avrg", "altr_rng", "tmpm_avrg", "tmpm_rng", "prcp_avrg", "prcp_rng", "mscs_avrg", "mscs_rng", "bosq_avrg", "bosq_rng", "decd_avrg", "decd_rng")

## podemos eliminar lo de la variance inflation según sugerencia 
## de un arbitro (vars.alt) o lo dejamos tal cual (vars.nm)
mi.cneb <- CNEB.nm[CNEB.nm$UM==1,vars.nm]
rownames(mi.cneb) <- CNEB.nm[CNEB.nm$UM==1,"cdg"]


@

<<VIFs, echo=false, results=tex>>=
tmp <- merge(VIFs.a, VIFs, by="row.names", all=T)
tmp$var.nombre <- gsub("lat", "Latitud", gsub("lon", "Longitud", gsub("prcp", "Precipitación total anual", gsub("tmpm", "Temperatura media anual", gsub("altr", "Altitud", gsub("decd", "Cobertura bosque deciduos", gsub("mscs", "Número de meses secos", gsub("bosq", "Cobertura boscosa total", gsub("_", " ", gsub("rng", "(intervalo)", gsub("avrg", "(promedio)", tmp[,1])))))))))))

colnames(tmp) <- c("Codigo.variable","VIF.previo","VIF.seleccion","Variable")
tab <- xtable(tmp[c(7,8,1:6,9:14),c(4,1:3)],caption="Factor de inflación de la varianza (VIF) para las variables consideradas en el diseño muestral",label="TAB:VIF")

print(tab,include.rownames=F, caption.placement="top")
@ 

<<echo=false>>=
alt.pc <- rda(alt.cneb,scale=T)
env.pc <- rda(mi.cneb,scale=T)

##plot(scores(alt.pc,display="sites",choice=1),scores(env.pc,display="sites",choice=1))
##abline(a=0,b=1)

env.pc2 <- dudi.pca(mi.cneb,nf=10,scale=T, scannf=F)

env.sco <- scores(env.pc,choice=1:3,display="wa")
alt.sco <- scores(alt.pc,choice=1:3,display="wa")

## hay que hacer esto para incluir celdas que inicialmente no fueron consideradas en el universo muestral
env.sco.full <- predict(env.pc,CNEB.nm,type="wa",scaling=2)
alt.sco.full <- predict(alt.pc,CNEB.nm,type="wa",scaling=2)

##env.sco.full[CNEB.nm$UM==1,1]

env.str <- alt.str <- env.sco 
env.str[,1] <- env.sco[,1]>median(env.sco[,1])
env.str[,2] <- env.sco[,2]>median(env.sco[,2])
env.str[,3] <- env.sco[,3]>median(env.sco[,3])

alt.str[,1] <- alt.sco[,1]>median(alt.sco[,1])
alt.str[,2] <- alt.sco[,2]>median(alt.sco[,2])
alt.str[,3] <- alt.sco[,3]>median(alt.sco[,3])

##env.dudi <- dudi.pca(mi.cneb,scannf=F,nf=3)
##CNEB.nm$PC1 <- CNEB.nm$PC2 <- CNEB.nm$PC3 <- numeric(nrow(CNEB.nm))
##CNEB.nm[CNEB.nm$UM==1,c("PC1","PC2","PC3")] <- scores(env.pc, choices=1:3,display="sites")

for (i in 1:10) {
CNEB.nm[,paste("PC",i,sep="")] <- numeric(nrow(CNEB.nm))
}
##CNEB.nm[CNEB.nm$UM==1,paste("PC",1:10,sep="")] <- scores(env.pc, choices=1:10,display="sites")

CNEB.nm[,paste("PC",1:10,sep="")] <- env.sco.full

## que tanto cambia la clasificación...
sum(apply(table(CNEB.nm$est[CNEB.nm$UM==1],apply(env.str,1,paste,collapse="")),2,max))/sum(table(CNEB.nm$est[CNEB.nm$UM==1],apply(env.str,1,paste,collapse="")))



@ 

Utilizamos un análisis de componentes principales para extraer tres componentes que explican el \Sexpr{100*round(cumsum(eigenvals(env.pc))/sum(eigenvals(env.pc)),2)[3]}\% de la varianza de los datos. En la tabla \ref{TAB:COVPC} vemos la correlación de las variables originales con los scores de esos tres componentes. El primer eje (PC1) está relacionado con altura, precipitacion y temperatura, PC2 con cobertura boscosa y PC3 con la cantidad de meses secos.


<<echo=false, results=tex>>=

## PC1 altura precipitacion y temperatura
## PC2 cobertura boscosa
## PC3 meses secos
print(xtable(t(cor(scores(env.pc,choice=1:3,display="wa"),mi.cneb)),caption="Correlación entre las variables originales y los scores de los componentes principales",label="TAB:COVPC"), caption.placement="top")

@ 

Los componentes principales encontrados fueron divididos en intervalos con igual número de cuadrantes cada uno, utilizando la mediana como punto de corte  (Fig. \ref{FIG:PC2}). De esta forma se definieron dos niveles (\textbf{a}lto y \textbf{b}ajo) dentro de cada uno de los tres primeros componentes principales. La combinación de estos niveles fueron utilizadas para definir los estratos ambientales.

\begin{figure}[htbp]
\begin{center}

<<pc2, fig=true, eval=true, echo=false, results=hide>>=
d.cp1 <- density(env.sco[,2])
q.cp1 <- quantile(env.sco[,2],probs=seq(0,1,1/2))
d.cp1.1 <- density(env.sco[,2],from=q.cp1[1],to=q.cp1[2])
d.cp1.2 <- density(env.sco[,2],from=q.cp1[2],to=q.cp1[3])

plot(d.cp1,type="n",main="",xlab="Valor en el primer componente principal",ylab="Densidad de observaciones")

polygon(c(q.cp1[1],d.cp1.1$x,q.cp1[2]),c(0,d.cp1.1$y,0),col="lightskyblue",border="lightskyblue")
polygon(c(q.cp1[2],d.cp1.2$x,q.cp1[3]),c(0,d.cp1.2$y,0),col="lightblue",border="lightblue")
polygon(d.cp1)
abline(v=q.cp1,lty=3)
rug(env.sco[,2])
@
\end{center} 
\caption[Distribución de valores del segundo componente principal]{Distribución de valores del segundo componente principal, divididos en dos intervalos por la mediana (lineas punteadas).}
\label{FIG:PC2}
\end{figure}


Los estratos ambientales fueron definidos como combinaciones de los estratos de los primeros 3 componentes principales, asi el estrato 1 representa la combinación ``a a a'', el estrato 2 la combinación ``a a b'', y asi succesivamente hasta el estrato 8 que representa la combinación ``b b b'' (ver figura \ref{PCA:EST}). Estos estratos no forman necesariamente grupos cerrados de cuadrantes; como se puede ver en la figura \ref{MAPA:EST}a, algunos de ellos están distribuidos a lo largo de diferentes bioregiones.


<<eval=true, echo=false, results=hide>>=
## Utilizamos \emph{random forests} para llenar la cuadrícula con una predicción de los estratos (así removemos ceros).
mi.rf <- randomForest(y=as.factor(CNEB.nm$est[CNEB.nm$UM==1 & CNEB.nm$est>0]),x=CNEB.nm[CNEB.nm$UM==1  & CNEB.nm$est>0,15:47])
CNEB.nm$est.pr <- predict(mi.rf,CNEB.nm)
CNEB.nm$est.pr[CNEB.nm$UM==1 & CNEB.nm$est>0] <- CNEB.nm$est[CNEB.nm$UM==1 & CNEB.nm$est>0]
CNEB.nm$est.pr <- factor(CNEB.nm$est.pr)

info.NM[,"Estrato"] <- CNEB.nm[match(info.NM$CNEB,CNEB.nm$cdg),"est.pr"]

@ 

\setkeys{Gin}{width=\textwidth}

\begin{figure}[htbp]
\begin{center}
<<mapaEST, fig=true, eval=true, echo=false, width=7, height=9>>=

layout(matrix(1:2,ncol=1))
par(mar=c(.5,.5,.5,.5))

um <- as.character(CNEB.nm$cdg[CNEB.nm$UM==1])

par(mar=c(1,0,1,0))
##Cuadrícula con los códigos en los bordes
plot(vzla,col=NA,border=NA,ylim=c(0,13))
text(rep(-73.5,23),unique(CNEB@data$y),unique(CNEB@data$fila),cex=.5)
text(unique(CNEB@data$x),rep(12.4,27),unique(CNEB@data$col),cex=.5)

cols <- brewer.pal(8,"Accent")
plot(CNEB[CNEB@data$cdg %in% um,],border=cols[CNEB.nm$est.pr[CNEB.nm$cdg %in% um]], col=cols[CNEB.nm$est.pr[CNEB.nm$cdg %in% um]],add=T)


##división política
title(main="(a)",line=-1)

plot(vzla,border="maroon",add=T)
plot(vzla[vzla@data$ID %in% 36,],add=T,border="maroon",col="grey87")

plot(CNEB[CNEB@data$cdg %in% VBG$cdg[VBG$vzla>0],],border="grey47",add=T)
legend(-73,5, paste("Estrato",1:8),fill=cols,cex=.7)


slc.avs <- info.NM$CNEB[match(rownames(aves.NM),info.NM$Nombre)]
slc.scrb <- info.NM$CNEB[match(as.numeric(unique(trmp.NM$NM[!is.na(trmp.NM$NM)])),info.NM$NM)]
slc.mrps <- info.NM$CNEB[match(rownames(mrps.NM),info.NM$Nombre)]
um <- unique(c(as.character(CNEB.nm$cdg[CNEB.nm$UM==1]),c(slc.scrb,slc.avs,slc.mrps)))

par(mar=c(1,0,2,0))
mi.ds <- c(0,30,40,20,35,70)
mi.ag <- c(0,45,135,135,45,135)
mi.cl <- c(0,"grey36","grey56","grey77","grey56","grey77")

plot(vzla,col=NA,border=NA,ylim=c(0,13))
plot(CNEB[CNEB@data$cdg %in% VBG$cdg[VBG$vzla>0],],border="grey77",add=T)
text(rep(-73.5,23),unique(CNEB@data$y),unique(CNEB@data$fila),cex=.5)
text(unique(CNEB@data$x),rep(12.4,27),unique(CNEB@data$col),cex=.5)

title(main="(b)",line=-1)

br <- CNEB.nm$bioreg[order(CNEB.nm$row,CNEB.nm$col)]
br[!(CNEB.nm$cdg[order(CNEB.nm$row,CNEB.nm$col)] %in% um)] <- "Otro"
plot(CNEB,density=mi.ds[br],
     border=mi.cl[br],
     angle=mi.ag[br],col=mi.cl[br],add=T)

## División política
plot(vzla,border="maroon",add=T)
plot(vzla[vzla@data$ID %in% 36,],add=T,border="maroon",col="grey87")

legend(-73,5,levels(br)[-1],density=mi.ds[-1],
     angle=mi.ag[-1],bty="n",cex=.7,col=mi.cl[-1],border=mi.cl[-1])

@
\end{center} 
\caption{Mapas de la distribución de los (a) estratos ambientales, y (b) bioregiones en el universo muestral de NeoMapas.}
\label{MAPA:EST}
\end{figure}



Tabla de eigenvectors y eigenvalues.
<<echo=false, results=tex>>=
 xtable(rbind(env.pc$CA$v[,1:3],env.pc$CA$eig[1:3]))
@ 


\begin{figure}[htbp]
\begin{center}
<<UMenPCs,fig=true, eval=true, echo=false, results=hide>>=
plot(env.pc, type="n", xlab="PC1",ylab="PC2")
##points(env.sco[,1],env.sco[,2], col=c("blue3","red3")[env.str[,3]+1])

cols <- brewer.pal(8,"Accent")
symbols(env.sco[,1],env.sco[,2],circle=env.sco[,3]+abs(min(env.sco[,3]))+.01,add=T,inches=.1, bg=cols[CNEB.nm$est.pr[match(rownames(env.sco),CNEB.nm$cdg)]], fg=cols[CNEB.nm$est.pr[match(rownames(env.sco),CNEB.nm$cdg)]])
mi.ss <- CNEB.nm$M2006[CNEB.nm$UM==1]==1
symbols(env.sco[mi.ss,1],env.sco[mi.ss,2],circle=env.sco[mi.ss,3]+abs(min(env.sco[,3]))+.01,add=T,inches=.1, fg=1, bg=cols[CNEB.nm$est.pr[match(rownames(env.sco[mi.ss,]),CNEB.nm$cdg)]],lwd=2)
@
\end{center} 
\caption{Estratos ambientales en espacio de componentes principales. Cada círculo corresponde con una celda de la CNEB, el color denota el estrato ambiental (ver leyenda del mapa superior en la figura \ref{MAPA:EST}), los ejes corresponden a los scores de los dos primeros componentes principales (PC1 y PC2), y el tamaño del círculo es proporcional al score del tercer componente. Las celdas de la selección muestral inicial de 27 celdas están resaltadas con un borde negro grueso.}
\label{PCA:EST}
\end{figure}

\section{Estratos biogeográficos o bioregiones}

El componente biogeográfico fue tomado en cuenta al dividir el universo muestral en grupos de cuadrantes basados en la clasificación de bioregiones o ámbitos de Venezuela \citep{PDVSA1995,InformeDiversidadVZL}. Esta clasificación coincide en grandes rasgos con las bioregiones consideradas por \citet{Linares1998} para los mamiferos y \citet{Hilty2003} para las aves de Venezuela. %y las bioregiones del informe sobre la biodiversidad de \citet{InformeDiversidadVZL}. 
Cada uno de los cuadrantes del universo muestral fueron asignados a la bioregión de mayor cobertura dentro del cuadrante. Estas bioregiones fueron reconsideradas en base a los resultados del análisis de componentes geográficos. Algunas bioregiones fueron agrupadas posteriormente en base a criterios de proximidad y semejanza en los gradientes ambientales con el fin de mantener un balance en el tamaño de los estratos (figura \ref{MAPA:EST}b).

\section{Selección muestral}

Dentro del universo muestral se seleccionó, por medio de un método aleatorio estratificado, un conjunto mínimo de 27 celdas que representasen los principales gradientes ambientales y las regiones biogeográficas más importantes. 

La siguiente tabla muestra todas las combinaciones de estratos biogeográficos y ambientales presentes en el universo muestral.

<<>>=
## combinaciones de estratos y bioregiones 
##dim(unique(CNEB.nm[CNEB.nm$UM==1,c("bioreg","est.pr")]))
table(CNEB.nm[CNEB.nm$UM==1,c("bioreg","est.pr")])
@ 

Por lo general los estratos están representados en 3 bioregiones, excepto por el estrato 1, que sólo está representado en la bioregión llanos, y los estratos 6 y 8 que están representados en todas las bioregiones. Podría decirse que la bioregión más variable es la de los llanos, en la que están representados todos los estratos, pero lo cierto que sólo tres de ellos dominan, y los demás podrían considerarse como casos intermedios agrupados en los puntos de contacto entre bioregiones. En la bioregión occidente domina el estrato 4, en el centro y la costa el estrato 6, en Guayana el 5 y en los Andes todas menos una de las celdas corresponden al estrato 8. 

Hay 5 celdas que corresponden con combinaciones únicas de bioregiones y estratos y por tanto fueron seleccionadas automáticamente. Para las 21 combinaciones restantes se escogio una celda de forma aleatoria. Finalmente se agregó una celda de la combinación Andes/estrato 8 para incluir el ecosistema páramo.

Esta selección inicial ``ideal'' está completamente balanceada en la representación de estratos y bioregiones. Sin embargo los muestreos realizados se desviaron ligeramente de esta selección por diferentes motivos. Algunas regiones fueron excluídas por falta de permisos, deterioro de las condiciones del terreno, o problemas de seguridad, y fueron reemplazadas por transectas similares. Concretamente en el muestreo de mariposas de 2006 no se pudieron realizar muestreos en dos celdas por falta de permisos, y en otros dos casos se hicieron modificaciones por problemas de accesibilidad, el resultado dejó dos combinaciones fuera de la selección:

<<results=verbatim, echo=false>>=
slc.mrps <- as.numeric(unique(tvn.NM$NM[tvn.NM$yr %in% 2006]))
slc.mrps <- slc.mrps[!is.na(slc.mrps) & slc.mrps!=92]
slc.mrps <- info.NM$CNEB[match(slc.mrps,info.NM$NM)]

table(CNEB.nm[CNEB.nm$cdg %in% slc.mrps,c("bioreg","est.pr")])
@

Posterior al muestreo de 2006 adoptamos cambios en esta selección para dar más énfasis a los estratos y regiones más diversas.  En base a una evaluación preliminar de los datos de 2006 se sugirió aumentar el esfuerzo de muestreo para invertebrados en los Andes y en zonas boscosas, y disminuirlo en zonas áridas y los llanos. Sin embargo para cada grupo taxonómico los patrones pueden ser diferentes, por ejemplo, para algunas familias de mariposas la mayor diversidad está en el gradiente altitudinal, mientras que para otras familias, y para los escarabajos coprófagos se sospecha que la mayor diversidad está al sur del Orinoco. Por otro lado algunos expertos sugirieron localidades específicas a incluir para complementar los muestreos para cada uno de los grupos

Estos cambios fueron más drásticos para el caso de los escarabajos, por ello los muestreos de 2006, 2009 y 2010 incluyen sólo 16 combinaciones, pero hace enfásis en los Andes y Guayana, especialmente en las zonas del Delta e Imataca:

<<results=verbatim, echo=false>>=
slc.scrb <- info.NM$CNEB[match(as.numeric(unique(trmp.NM$NM[trmp.NM$yr %in% c(2006, 2009, 2010)])),info.NM$NM)]
slc.scrb <- slc.scrb[!is.na(slc.scrb)]

table(CNEB.nm[CNEB.nm$cdg %in% slc.scrb,c("bioreg","est.pr")])
@

Para los muestreos de Aves de 2010 discutimos varias alternativas, y al final se hicieron algunas modificaciones para incluir una localidad al norte de Bolívar y otra en la cordillera de la Costa, además de las celdas del Delta e Imataca. Al final se muestrearon 21 combinaciones diferentes con enfasis en Guayana y menor esfuerzo en los llanos:

<<results=verbatim, echo=false>>=
slc.avs <- info.NM$CNEB[match(rownames(aves.NM),info.NM$Nombre)]
table(CNEB.nm[CNEB.nm$cdg %in% slc.avs,c("bioreg","est.pr")])
@

\section{Transecciones: diseño muestral a nivel de la región}

Para muestrear cada una de las celdas escogidas utilizamos el método de transectas a lo largo de gradientes de máxima variación, también conocido como ``gradsect'' o transección \citep{Wal.98}. Generalmente se utilizó una transección por celda, exepto en casos de celdas muy heterogéneas en las cuales no existían una única ruta que cubriera estos gradientes de máxima variación. En algunas celdas se trazaron varias transecciones alternativas o complementarias, y algunas transecciones se extienden más allá de los límites de la celda. 

La unidad regional de análisis (URA) se puede referir a una celda (cuando hay una única transección, o cuando las transecciones muestreadas se toman como unidades complementarias), o a una transección. La distinción entre ambos casos se puede realizar por el código de referencia utilizado. En el caso de las celdas se adopta el código de la CNEB, y se supone que se están considerando todos los muestreos realizados en dicha celda. En el caso de las transecciones se utiliza un código entre ``NM01'' y ``NM99''. La lista completa de transectas programadas se presenta en la tabla \ref{TAB:URAs}, pero sólo algunas de ellas se consideran activas (han sido incluidas en los muestreos realizados y  están planificadas para incluirlas en los próximos muestreos).

<<tabla URA, results=tex, echo=false>>=
tbl <- info.NM[1:97,c("NM","CNEB","Nombre","ADM1", "Bioregión", "Estrato")]

tbl$NM <- sprintf("NM%02d",tbl$NM)
tbl[89,3] <- "UNET"
colnames(tbl) <- c("NM","CNEB","Nombre","Estado","Bioregión", "Estrato")

print(xtable(tbl, label="TAB:URAs", caption="Lista de transecciones de NeoMapas planificadas. Para una lista de las transecciones activas, y más detalles de cada una, consulte \\url{http://www.neomapas.org}."), size="footnotesize", caption.placement="top", include.rownames=FALSE, floating=FALSE, tabular.environment="longtable", add.to.row=list(pos=list(-1), command="\\hline\\endhead\n\\hline\\endlastfoot\n\\hline\\multicolumn{4}{l}{Continúa en la página siguiente}\n\\hline\\endfoot\n"))
@

El primer conjunto de transecciones (NM01 al NM27) se trazaron entre 2002 y 2003 para incluir la selección muestral inicial, con algunas transecciones adicionales de respaldo. Entre 2007 y 2009 se planificaron y trazaron varias transectas alternativas para poder flexibilizar el plan de muestreo, incluyendo hábitats poco representados (bosques, páramos, etc) y regiones que estaban al borde del universo muestral original. Esta lista de transecciones planificadas garantiza la posibilidad de cubrir 27 combinaciones distintas de estratos ambientales y bioregiones:
<<echo=false>>=
table(CNEB.nm[CNEB.nm$cdg %in% tbl$CNEB,c("bioreg","est.pr")])
@


La mayoría de las transecciones abarcan una ruta contínua de 40 km, pero existen algunas rutas cortas (por ejemplo la NM92 o NM97) que se utilizan en pruebas y ensayos de métodos, y otras que fueron segmentadas (como NM59 y NM65) por problemas de acceso, y por tanto deben realizarse por partes.

A lo largo de estas transecciones se ubican las unidades elementales de muestreo (UEM), según el protocolo de campo de cada grupo taxonómico. El diseño original está basado en las rutas de los censos de aves del ``Breeding Bird Survey'' realizado todos los años en América del Norte \citep{RobbinsEtAl1986,SauerEtAl2003}. Por ello se suelen trazar 50 o 51 puntos en intervalos de 800 metros a lo largo de una ruta o transección de 40 km. Sin embargo el número y disposición de las UEM dentro de la ruta escogida depende del esfuerzo de muestreo necesario para caracterizar una URA (que a la vez depende del protocolo de captura adoptado para cada taxón) y de los recursos logísticos disponibles. %En base a los datos del estudio piloto se calculó un valor óptimo cómo se verá más adelante.

Para algunos muestreos de mariposas realizados en el periodo de calibración de métodos (2003 a 2005), no se utilizaron transecciones para muestrear las URAs, sino que las UEM se dispusieron aleatoriamente en las celdas muestreadas, por lo que pueden existir en la base de datos localidades de muestreo que estén asignadas a una celda, pero no a una transección. Igualmente, las capturas u observaciones incidentales, realizadas fuera de los muestreos, son ingresadas a la base de datos sin código de transección, pero sí con código de celda.


<<echo=false, results=hide>>=
xys <- rbind(tvn.NM[,c("lon","lat")], trmp.NM[,c("lon","lat")], avs.NM[,c("lon","lat")], NM.m1[,c("lon","lat")], NM.m2[,c("lon","lat")])

xys <- unique(xys[!is.na(xys$lon) & !is.na(xys$lat) & xys$lon < 0 & xys$lon > -74 & xys$lat >2,]) 
@

En total existen \Sexpr{nrow(unique(round(xys,5)))} puntos de muestreo registrados en todas bases de datos de NeoMapas, pero que, tomando en cuenta el error de posicionamiento de las unidades de GPS utilizadas, probablemente se reduzca a unas \Sexpr{nrow(unique(round(xys,3)))} localidades diferentes.

Evaluamos el sesgo espacial y la representatividad de las variables ambientales a partir de la distribución espacial de las UEM efectivamente muestreadas. Para estudiar la distribución espacial del esfuerzo de muestreo utilizamos un procedimiento basado en conteos ponderados localmente en dos dimensiones (las dos coordenadas geográficas), y una comparación de esta distribución con una distribución aleatoria homogénea \citep{BA97}. El resultado se muestra en la figura \ref{FIG:DENSPUNTO}. La región del Sur del Lago de Maracaibo, este de Lara y Yaracuy,  la península de Araya en oriente, y el este del estado Bolívar junto con el sur del estado Delta Amacuro son las regiones mejor representadas en los muestreos de NeoMapas. Los estados Guárico, Anzoátegui, Apure y el noroeste del estado Bolívar están subrepresentados. 

\begin{figure}[htbp]
\begin{center}
<<echo=false, results=hide, fig=true>>=
mi.ppp <- ppp(xys$lon,xys$lat,window=convexhull.xy(xys))
Z <- density(mi.ppp, sigma=.75)
mi.rnd <- rpoint(n=nrow(xys), f=median(Z), win=convexhull.xy(xys))
Z0 <- density(mi.rnd, sigma=.75)

ZD <- Z
ZD$v <- Z$v-Z0$v

par(mar=c(0,0,0,1.6))
plot(ZD,main="")
plot(vzla,add=T,border="maroon")
contour(ZD,add=T,col="grey17")
@
\end{center} 
\caption{Sesgo en la distribución espacial de los puntos de muestreos. La escala muestra la diferencia entre la densidad de los puntos de muestreos y la densidad esperada para una distribución aleatoria uniforme de localidades de muestreo. Los valores positivos (verdes y amarillos) indican áreas bien representadas, y los valores negativos (azul oscuro) representan áreas no muestreadas o subrepresentadas.}
\label{FIG:DENSPUNTO}
\end{figure}


\setkeys{Gin}{width=\textwidth}
\begin{figure}[htbp]
\begin{center}
<<SesgoPC3, fig=true, echo=false, results=hide>>=
tmp <- crossdist(xys$lon,xys$lat,CNEB@data$x,CNEB@data$y)
xys$cneb <-  as.character(CNEB@data$cdg[apply(tmp,1,which.min)])
tmp2 <- table(xys$cneb)

layout(matrix(1:6,ncol=2, byrow=T))
par(mar=c(3,3,2,0))
d1 <- density(CNEB.nm$PC1[CNEB.nm$UM==1])
d2 <- density(CNEB.nm$PC1[match(names(tmp2),CNEB.nm$cdg)], weights=tmp2/sum(tmp2))

plot(d1,log="", main="PC1",ylim=c(0,1))
lines(d2,col=2)

par(mar=c(0,0,0,0))
CNEB.nm$bias.PC1 <- 0
qq <- table(cc <- cumsum((d2$y > d1$y)+0))
for (i in names(qq)[qq>1]) {
	CNEB.nm$bias.PC1[CNEB.nm$PC1 > min(d2$x[cc == i]) & CNEB.nm$PC1 < max(d2$x[cc == i])] <- 1
	}
plot(CNEB,col=c("white","slateblue4")[CNEB.nm$bias.PC1*CNEB.nm$UM+1], border=c(NA,"slateblue4")[CNEB.nm$UM+1])
	plot(vzla,add=T)

d1 <- density(CNEB.nm$PC2[CNEB.nm$UM==1])
d2 <- density(CNEB.nm$PC2[match(names(tmp2),CNEB.nm$cdg)], weights=tmp2/sum(tmp2))

par(mar=c(3,3,2,0))
plot(d1,log="", main="PC2",ylim=c(0,1))
lines(d2,col=2)

par(mar=c(0,0,0,0))
CNEB.nm$bias.PC2 <- 0
qq <- table(cc <- cumsum((d2$y > d1$y)+0))
for (i in names(qq)[qq>1]) {
	CNEB.nm$bias.PC2[CNEB.nm$PC2 > min(d2$x[cc == i]) & CNEB.nm$PC2 < max(d2$x[cc == i])] <- 1
	}
plot(CNEB,col=c("white","slateblue4")[CNEB.nm$bias.PC2*CNEB.nm$UM+1], border=c(NA,"slateblue4")[CNEB.nm$UM+1])
	plot(vzla,add=T)


d1 <- density(CNEB.nm$PC3[CNEB.nm$UM==1])
d2 <- density(CNEB.nm$PC3[match(names(tmp2),CNEB.nm$cdg)], weights=tmp2/sum(tmp2))

par(mar=c(3,3,2,0))
plot(d1,log="", main="PC3",ylim=c(0,1))
lines(d2,col=2)

par(mar=c(0,0,0,0))
CNEB.nm$bias.PC3 <- 0
qq <- table(cc <- cumsum((d2$y > d1$y)+0))
for (i in names(qq)[qq>1]) {
	CNEB.nm$bias.PC3[CNEB.nm$PC3 > min(d2$x[cc == i]) & CNEB.nm$PC3 < max(d2$x[cc == i])] <- 1
	}
plot(CNEB,col=c("white","slateblue4")[CNEB.nm$bias.PC3*CNEB.nm$UM+1], border=c(NA,"slateblue4")[CNEB.nm$UM+1])
	plot(vzla,add=T)

@
\end{center} 
\caption{Sesgo en la representación de los tres primeros componentes principales según la intensidad de localidades de muestreo por celda. En los gráficos de la izquierda la línea negra muestra la distribución de valores en el universo muestral, la línea roja muestra la distribución de valores representados en los muestreos según la densidad de localidades de muestreo por celda. Los mapas del lado derecho muestras las celdas subrepresentadas en los muestreos (para las cuales la línea roja está por debajo de la línea negra.}
\label{FIG:BIASPC3}
\end{figure}

\setkeys{Gin}{width=.75\textwidth}
\begin{figure}[htbp]
\begin{center}
<<SesgoPCs, fig=true, echo=false, results=hide>>=
CNEB.nm$bias.PCs <- 0
for (j in paste("PC",1:10,sep="")) {
d1 <- density(CNEB.nm[CNEB.nm$UM==1,j],)
d2 <- density(CNEB.nm[match(names(tmp2),CNEB.nm$cdg),j], weights=tmp2/sum(tmp2))

qq <- table(cc <- cumsum((d2$y > d1$y)+0))
for (i in names(qq)[qq>1]) {
	CNEB.nm$bias.PCs[CNEB.nm[,j] > min(d2$x[cc == i]) & CNEB.nm[,j] < max(d2$x[cc == i])] <- 
	CNEB.nm$bias.PCs[CNEB.nm[,j] > min(d2$x[cc == i]) & CNEB.nm[,j] < max(d2$x[cc == i])]+1
	}
	}
cols <- c(NA,NA,NA,NA,NA,brewer.pal(max(CNEB.nm$bias.PCs)-4,"YlOrRd"))
plot(CNEB,col=cols[CNEB.nm$bias.PCs*CNEB.nm$UM+1], border=c(NA,"grey54")[CNEB.nm$UM+1])
		plot(vzla,add=T)
##legend(-73,5,...)

@
\end{center} 
\caption{Sesgo en la representación de la variabilidad ambiental. Las celdas con colores oscuros tienen condiciones ambientales subrepresentadas en las localidades muestreadas y podrían complementar muestreos futuros.}
\label{FIG:BIASVAR}
\end{figure}


Adicionalmente comparamos la distribución de los scores de los componentes principales en el universo muestral con los valores representados en las celdas muestreadas ponderadas por la intensidad de muestreo para detectar combinaciones de variables no representadas en la muestra \citep{FR02,Bus86}. En la figura \ref{FIG:BIASPC3} se muestra el resultado de esta comparación para los primeros tres componentes principales, y en la figura \ref{FIG:BIASVAR} se muestra el resultado agregado de los 10 componentes. Según este criterio los llanos centrales deben considerarse una prioridad para complementar muestreos futuros.

%A manera de prueba se generaron, para cada celda del universo muestral, listas de especies basadas en la distribución conocida de tres familias de aves. Luego se compararon las curvas de acumulación de especies para todo el universo muestral con las curvas de acumulación de especies del muestreo propuesto. El muestreo propuesto resultó ser una selección eficiente y representativa de la riqueza de especies total del universo muestral.

\chapter{Muestreos de Mariposas 2003-2010}
\label{CAP:MRPS}

Escogimos a las mariposas (orden Lepidoptera: superfamilias Papilionoidea y Hesperioidea) como uno de los primeros grupos modelos para probar, diseñar e implementar la estrategia de muestreo de NeoMapas. 

\section{Protocolo de campo para el muestreo de mariposas}

Los métodos estándares de muestreo de mariposas tropicales se basan en una combinación de observación, capturas con redes manuales y captura con trampas tipo Van Sommeren-Rydon \citep{Bro72,Sal.94}. Sin embargo, la identificación de mariposas tropicales al vuelo requiere de experiencia en taxonomía y destreza en campo, por lo que sería necesario la participación de expertos en los grupos taxonómicos con los que se desea trabajar. Por otro lado, el uso de trampas y cebos atrayentes requiere de una mayor dedicación de recursos (tiempo y personal) y sólo es efectivo para algunas especies. Por ello estos métodos no han podido implementarse sistemáticamente para el estudio de las faunas nacionales. 

Para garantizar resultados comparables entre varias unidades de muestreo es necesario utilizar un método que sea rápido, sencillo y eficaz, de forma que pueda ser aplicado en poco tiempo por personal no necesariamente especializado; pero a la vez que cuente con reglas claras y estandarizadas \citep{Pol77,NM91}. La captura con redes entomológicas combinada con la identificación en laboratorio cumple con estas condiciones \citep{CR03}. Se trata de la adaptación de los conteos visuales a lo largo de recorridos fijos propuestos por \citet{Pol77}, del cuál existen algunas variantes \citep{NM91}. Para un entorno tropical los conteos visuales se substituyen por capturas con redes a lo largo de una ruta (preestablecida o improvisada) durante 30 minutos. \citet{CR03} encontraron que esta técnica simple se adapta muy bien a diferentes condiciones de campo; que los datos obtenidos en múltiples ensayos por grupos diferentes de colectores son consistentes, repetibles y comparables, incluso cuando son llevados a cabo por personal sin experiencia; y que el número de ejemplares capturados es comparable con conteos visuales realizados en condiciones similares por personal más experimentado. Para nuestro estudio, adaptamos este método para utilizarlos con modelos de captura con remoción con el fin de estimar conjuntamente la detectabilidad y la abundancia de mariposas \citep{Fal.02,MSS04}. 

\section{Ensayo y aplicación del protocolo de campo}

Entre 2003 y 2010 se realizó un programa de muestreo de mariposas a nivel nacional. Podemos distinguir tres fases diferentes de trabajo de campo: una primera fase de carácter exploratorio, cuyo fin era ajustar los métodos de campo, y los dos inventarios sistematizados que constituyen el primer esfuerzo por lograr una muestra representativa de la diversidad de mariposas de Venezuela. 


\subsection{Fase 1: ensayo de métodos}

Para ensayar diferentes variantes de los métodos de campo se realizaron salidas de campo en el oriente y occidente del país entre 2003 y principios de 2006. Las URAs para estas salidas de campo fueron escogidas para incluir hábitats contrastantes. Esta fase del proyecto era de carácter exploratorio y en el primer año se realizó con un presupuesto muy limitado por lo que no fue posible contar con una planificación estricta de las fechas y condiciones del trabajo de campo. Durante parte del 2005 se contó con financiamiento confiable que permitió una mejor planificación. 

En la primera fase exploratoria la disposición espacial de las UEM dentro de la URA fue variable, en algunos casos se dispusieron aleatoriamente, en otros casos fueron seleccionadas \emph{a priori} para cubrir diferentes condiciones ambientales.

El número de colectores por sesión de captura varió entre uno y siete, según la disponibilidad de voluntarios, y el tiempo total de cada sesión varió según limitaciones logísticas y condiciones ambientales entre cinco y 90 minutos. Cada sesión se dividió en periodos de tres, cinco, 10 ó 12 minutos y las mariposas capturadas en cada periodo se mantuvieron en sobres diferentes. Las sesiones de captura fueron realizadas entre las ocho a.m.~y las seis p.m.,~pero con mayor concentración de esfuerzo de muestreo entre las 10 a.m.~y las dos p.m.~Siempre que fue posible, las condiciones meteorológicas (temperatura ambiental, velocidad del viento y nubosidad) fueron registradas durante el periodo de muestreo por un anotador, asimismo, en algunas ocasiones se incluyeron descripciones y fotos del hábitat y las condiciones del muestreo. 

Se realizaron salidas de campo en diferentes épocas del año, pero hubo mayor concentración de esfuerzo de muestreo en los meses de junio a septiembre. Durante las sesiones no existieron restricciones al desplazamientos de el/los colector(es), sin embargo se estima que durante un recorrido cada colector abarca un área entre 900 y 5\,000 m$^2$. Todos los animales colectados fueron sacrificados y llevados a laboratorio para su identificación. 
El número y disposición de UEMs y la suma total de esfuerzo de muestreo estuvieron igualmente condicionados a la disponibilidad de tiempo, transporte y voluntarios para cada viaje.

<<fase 1 mrps, eval=true, echo=false, results=hide>>=
mi.tvn <- tvn.NM[tvn.NM$fase %in% 1,]
mi.jmp <- jmp.NM[jmp.NM$fase %in% 1,]
n.vst <- luq(mi.tvn$vst)
sfrz <- sum(mi.tvn$sfrz,na.rm=T)
n.jmp <- nrow(mi.jmp)
p.id <- sum(mi.jmp$status_id %in% c("definitiva","preliminar","morfo-especie"))
n.CN <- luq(mi.tvn$CN)
n.NM <- luq(mi.tvn$NM)
@

Durante la primera fase del experimento piloto se realizaron
\Sexpr{n.vst} recorridos cronometrados, repartidos en \Sexpr{n.CN} celdas de la CNEB, y que en conjunto sumaron \Sexpr{sfrz} $m*p$ (alrededor de \Sexpr{round(sfrz/60,2)} horas-persona) de esfuerzo de captura. A pesar de la amplia cobertura geográfica, sólo en \Sexpr{n.NM} celdas se hicieron muestreos utilizando transecciones como unidades regionales. Se capturaron \Sexpr{n.jmp} ejemplares de mariposas (o \Sexpr{round(n.jmp*60/sfrz,2)} ejemplares por hora-persona), \Sexpr{round(p.id*100/n.jmp,1)}\% de los cuales se ha identificado al menos a nivel de morfo-especie. 


\setkeys{Gin}{width=\textwidth}
\begin{figure}[htbp]
\begin{center}
<<EsfuerzoFase, fig=true, echo=false, results=hide, width=7, height=5>>=
tt <- tapply(tvn.NM$sfrz,list(tvn.NM$CN,tvn.NM$fase),sum,na.rm=T)
tt <- tt[rowSums(tt,na.rm=T)>100,]
par(mar=c(0,0,0,0))
plot(CNEB[CNEB@data$cdg %in% rownames(tt),],border=NA)
plot(vzla,add=T,border="maroon")

stars((tt>0)+0, draw.segment=T, scale=F, col.segments=c("grey77","pink2","palegreen"), add=T, len=.23, 
key.labels=c("2003-2005","2006","2009-2010"), key.loc=c(-72,4.8),
locations=coordinates(CNEB)[match(rownames(tt),CNEB@data$cdg),], cex=1,labels=NULL,lwd=2)

stars((tt>1000)+0, draw.segment=T, scale=F, col.segments=1:3,add=T, len=.23, key.labels=c("2003-2005","2006","2009-2010"), key.loc=c(-72,5.8), locations=coordinates(CNEB)[match(rownames(tt),CNEB@data$cdg),], cex=1,labels=NULL,lwd=2)
@
\end{center} 
\caption{Distribución espacial y temporal del esfuerzo de muestreo de mariposas de NeoMapas. Los segmentos indican cuales celdas fueron visitadas en cada una de las fases del trabajo de campo, los casos en que el esfuerzo de muestreo fue mayor a 1000 m*p están resaltados con colores oscuros.}
\label{MAPA:MRPSFASE}
\end{figure}

\subsection{Fase 2: primer inventario nacional de mariposas}
Entre julio y septiembre de 2006 se realizó el curso ``Inventario y monitorización de la biodiversidad'' en el Centro de Ecología del IVIC. Durante la primera semana del curso los estudiantes (seis venezolanos y seis extranjeros provenientes de Estados Unidos, Francia, Gran Bretaña y República Dominicana), recibieron clases teóricas sobre la exploración y conservación de la biodiversidad y fueron entrenados en las técnicas de campo para la captura de mariposas y escarabajos. En las siguientes ocho semanas participaron, junto a otros voluntarios y personal del IVIC, en un extenso trabajo de campo y  procesando las muestras en el laboratorio.

Durante estos meses se recorrieron las 27 URAs seleccionadas anteriormente incluyendo algunas ligeras modificaciones y se aplicó un protocolo de captura uniforme. Las UEM fueron muestreadas en sesiones de 30 minutos divididas en seis periodos de cinco minutos, con uno a cuatro colectores por sesión. Se anotaron, en la medida posible, las condiciones meteorológicas del muestreo, la descripción y/o fotografías del hábitat y la ruta de muestreo. Durante las sesiones no existieron restricciones al desplazamiento de el/los colector(es). Se estimó que el tamaño muestral óptimo para cada URA era de 40 UEMs con dos colectores por UEM. Cuando habían más de dos colectores por UEM, era posible realizar un número menor, pero siempre se procuró que fueran al menos 30. En algunas URAs selectas fue posible realizar hasta 53 UEMs.

 
<<fase 2 mrps, eval=true, echo=false, results=hide>>=
mi.tvn <- tvn.NM[tvn.NM$fase %in% 2,]
mi.jmp <- jmp.NM[jmp.NM$fase %in% 2,]
n.vst <- luq(mi.tvn$vst)
sfrz <- sum(mi.tvn$sfrz,na.rm=T)
n.jmp <- nrow(mi.jmp)
p.id <- sum(mi.jmp$status_id %in% c("definitiva","preliminar","morfo-especie"))
n.CN <- luq(mi.tvn$CN)
n.NM <- luq(mi.tvn$NM)
@ 
Durante la segunda fase de trabajo de campo se realizaron \Sexpr{n.vst} recorridos cronometrados que sumaron más de \Sexpr{sfrz} $m*p$ (más de \Sexpr{round(sfrz/60,2)} horas-persona) de esfuerzo de captura. Los muestreos estuvieron concentrados en \Sexpr{n.NM} transecciones, pero que en algunos casos abarcan más de una celda, por ello el número total de celdas asciende a \Sexpr{n.CN}. Se capturaron al menos \Sexpr{n.jmp} ejemplares de mariposas, osea \Sexpr{round(n.jmp*60/sfrz,2)} ejemplares por hora-persona. Hasta  la fecha se han identificado \Sexpr{round(p.id*100/n.jmp,1)} \% de ellos, en su mayoría se trata de ejemplares pertenecientes a la familia Pieridae y a un grupo de especies comunes de Nymphalidae y Papilionidae.

%Todo el material colectado fue sacrificado y llevado a laboratorio para su identificación y procesamiento. 

\subsection{Fase 3: segundo muestreo nacional de mariposas}
Entre julio y agosto de 2009 se realizó el segunod curso ``Inventario y monitorización de la biodiversidad'' en el Centro de Ecología del IVIC. La organización del curso fue similar, pero con mayor cantidad de participantes y una duración menor. Contamos con un grupo de 17 estudiantes y 6 preparadores de diferentes países latinoamericanos para formar seis grupos de trabajo. Las actividades se organizaron en una semana de teoría y entrenamiento, una etapa de trabajo de campo de tres semanas y media, y una semana de trabajo de laboratorio. 

Durante el entrenamiento de los preparadores se muestrearon 6 URAs, luego, durante el curso los seis grupos visitaron un total de 18 URAs, y en los meses posteriores se incluyeron dos URAs más en septiembre de 2009 y dos en junio y julio de 2010. El protocolo de muestreo fue similar al empleado en 2006, pero con menor esfuerzo de muestreo por URA, ya que los equipos de trabajo debían realizar simultáneamente el muestreo de escarabajos coprófagos. Se estimó que el tamaño muestral mínimo para cada URA, en estas condiciones de trabajo, debía ser de alrededor de 20 UEMs con tres colectores por UEM. 


<<fase 3 mrps, eval=true, echo=false, results=hide>>=
mi.tvn <- tvn.NM[tvn.NM$fase %in% 3,]
mi.jmp <- jmp.NM[jmp.NM$fase %in% 3,]
n.vst <- luq(mi.tvn$vst)
sfrz <- sum(mi.tvn$sfrz,na.rm=T)
n.jmp <- nrow(mi.jmp)
p.id <- sum(mi.jmp$status_id %in% c("definitiva","preliminar","morfo-especie"))
n.CN <- luq(mi.tvn$CN)
n.NM <- luq(mi.tvn$NM)

##table(substr(mi.tvn$fecha,1,7),mi.tvn$NM)
##tapply(mi.tvn$vst,mi.tvn$NM,luq)

@ 

Durante la tercera fase de trabajo de campo se realizaron \Sexpr{n.vst} recorridos cronometrados que sumaron más de \Sexpr{sfrz} $m*p$ (más de \Sexpr{round(sfrz/60,2)} horas-persona) de esfuerzo de captura. Los muestreos estuvieron concentrados en \Sexpr{n.NM} transecciones, pero que en algunos casos abarcan más de una celda, por ello el número total de celdas asciende a \Sexpr{n.CN}. Se capturaron al menos \Sexpr{n.jmp} ejemplares de mariposas, osea \Sexpr{round(n.jmp*60/sfrz,2)} ejemplares por hora-persona. Hasta la fecha se ha identificado \Sexpr{round(p.id*100/n.jmp,1)} \% de los ejemplares en colección, en su mayoría se trata de ejemplares pertenecientes a la familia Pieridae y a un grupo de especies comunes de Nymphalidae y Papilionidae.


\begin{figure}[htbp]
\begin{center}
<<EjemplaresEsfuerzo, fig=true, echo=false, results=hide>>=

t2 <- tapply(jmp.NM$jmp,list(jmp.NM$CN,jmp.NM$fase),luq)
t2 <- t2[rownames(t2) %in% rownames(tt),]
##t2[is.na(t2)] <- 0

plot(t2~tt,log="y", xlab="Esfuerzo de muestreo", ylab="Ejemplares capturados", col=c(rep(1,nrow(t2)),rep(2,nrow(t2)),rep(3,nrow(t2))),cex=1.9)
text(tt,t2,rownames(t2),col=c(rep(1,nrow(t2)),rep(2,nrow(t2)),rep(3,nrow(t2))),cex=.38)

lines(supsmu(tt[!is.na(tt)],t2[!is.na(tt)],bass=1), lwd=2, col="slateblue4")

@
\end{center} 
\caption{Relación entre número de ejemplares y esfuerzo de muestreo. Cada círculo representa una celda identificada por el código de la CNEB. El color indica la fase del trabajo de campo. Negro: fase 1, rojo: fase 2, verde: fase 3.}
\label{FIG:SFRZJMP}
\end{figure}

\section{Cuantificación de sesgos geográficos y taxonómicos}

\subsection{Distribución geográfica del esfuerzo de muestreo}
Para poder comparar los resultados del muestreo de mariposas entre las tres fases agrupamos los muestreos por celdas de la CNEB. Debido a las diferencias en los métodos empleados entre años, el esfuerzo de muestreo por celda fue muy variables, y estuvo repartido de manera heterogénea. Durante la primera fase del trabajo de campo el esfuerzo estuvo concentrado en el occidente y el oriente del país, durante la fase dos se expandió el muestreo a la región central y los llanos. Luego en la fase tres se incorporaron más muestreos en los Andes y la región de Imataca y el delta del Orinoco. En occidente se visitaron más regiones que en oriente, lo cual se justifica parcialmente por la diversidad de ecosistemas asociados a los Andes venezolanos (Fig.~\ref{MAPA:MRPSFASE}). 


<<echo=false, results=hide>>=
tt <- tapply(tvn.NM$sfrz,list(tvn.NM$CN,tvn.NM$fase),sum,na.rm=T)
tt <- tt[rowSums(tt,na.rm=T)>100,]
ttl.CN <- nrow(tt)
cmpl.CN <- sum(rowSums(tt>0,na.rm=T)==3)
## esto muestra algo similar a la figura {MAPA:MRPSFASE}
##tt[rowSums(tt>0,na.rm=T)==3,]
@
Los resultados obtenidos sugieren que un esfuerzo mínimo de 1000 m*p garantiza números comparables de ejemplares capturados (Fig.~\ref{FIG:SFRZJMP}). De \Sexpr{ttl.CN} celdas, \Sexpr{sum(rowSums(tt>1000,na.rm=T)>0)} tuvieron un  esfuerzo de muestreo mayor a 1000 m*p en al menos una de las fases de trabajo de campo. Consideramos que los datos de estas celdas son confiables para estudiar patrones espaciales en riqueza y composición de especies. Por su parte, de las \Sexpr{cmpl.CN} celdas muestreadas en las tres fases, sólo Araya (d20), el norte de Guri (i22) y el norte de Yaracuy (d10) tuvieron un esfuerzo de muestreo suficiente en cada fase, y podrían servir para comparar patrones temporales en riqueza y composición de especies (Fig.~\ref{MAPA:MRPSFASE}).


\subsection{Identificación y composición taxonómica}

Las familias Nymphalidae y Pieridae fueron las más abundantes durante las tres fases del trabajo de campo (Tabla \ref{TAB:FAMMRPS}). Las proporciones entre grupos son similares aunque la efectividad en la captura de mariposas fue ligeramente inferior en la tercera fase de los muestreos. Probablemente la familia más variable sea Hesperiidae, la cual fue proporcionalmente más abundante en la fase dos.

<<tablaFamiliaFase,echo=false,results=tex>>=
jmp.NM$bioreg <- CNEB.nm[match(jmp.NM$CN,CNEB.nm$cdg),"bioreg"]

mi.tt <- table(jmp.NM$fase,jmp.NM$familia,useNA="ifany")
fams <- c("Hesperiidae", "Papilionidae", "Pieridae", "Lycaenidae", "Riodinidae", "Nymphalidae")
colnames(mi.tt)[is.na(colnames(mi.tt)) | colnames(mi.tt) %in% "por asignar"] <- "Sin Id"
mi.tt <- mi.tt[1:3,c(fams,"Sin Id")]
colnames(mi.tt) <- c(abbreviate(fams),"Sin Id")
rownames(mi.tt) <- paste("Fase",rownames(mi.tt))
## mosaicplot(mi.tt)

mi.tt <- cbind(mi.tt,total=rowSums(mi.tt))
mi.tt <- rbind(mi.tt,total=colSums(mi.tt))
xtab <- xtable(mi.tt,digits=0,caption=paste("Ejemplares capturados por familia en cada una de las fases del trabajo de campo. ", paste(abbreviate(unique(fams)),": ",unique(fams),sep="", collapse="; "),"; Sin Id: ejemplares no revisados o con identificación dudosa.",sep=""), label="TAB:FAMMRPS")

print(xtab, caption.placement="top")
##mi.tt <- table(jmp.NM$bioreg,jmp.NM$familia,useNA="ifany")
##colnames(mi.tt) <- c("No identificado", "Hesperiidae", "Lycaenidae", "Nymphalidae", "Papilionidae", "Pieridae",  "Riodinidae")
##mi.tt <- mi.tt[c(2,6,3,4,5,7),]
@ 




\begin{figure}[htbp]
\begin{center}
<<MrpsID, fig=true, echo=false, results=hide>>=
jmp.NM$familia[is.na(jmp.NM$familia)] <- "por asignar"
jmp.NM$familia <- factor(jmp.NM$familia,levels=c("por asignar", "Hesperiidae", "Papilionidae", "Pieridae", "Lycaenidae", "Riodinidae", "Nymphalidae"))
jmp.NM$spp <- paste(jmp.NM$genero,jmp.NM$especie)
jmp.NM$spp[jmp.NM$spp %in% c("Eurema daira","Eurema elathea", "Eurema sp. [daira / elathea]")] <- "Eurema sp. [daira o elathea]"

jmp.NM$valido <- "SI"
jmp.NM$valido[is.na(jmp.NM$genero)] <- "NO"
jmp.NM$valido[is.na(jmp.NM$especie)] <- "NO"
jmp.NM$valido[grep("NA",jmp.NM$spp)] <- "NO"

mi.ss <- jmp.NM$valido == "SI"

tmp <- data.frame(id=tapply(mi.ss,jmp.NM$CN,sum), ttl=tapply(mi.ss,jmp.NM$CN,length))
tmp$p.id <- tmp$id*100/tmp$ttl
xys <- coordinates(CNEB)[match(rownames(tmp),CNEB@data$cdg),]
grps <-cut(tmp$p.id,breaks=c(-1,20,40,60,80,101))

par(mar=c(0,0,0,0))
plot(CNEB[CNEB@data$vzla>0,],border="grey86")
plot(vzla[vzla@data$ESTADO %in% "Zona en Reclamaci\xf3n",],density=29,add=T,col="maroon",border="maroon")
plot(vzla,border="maroon",add=T)
text(rep(-73.5,23),unique(CNEB@data$y),unique(CNEB@data$fila),cex=.5)
text(unique(CNEB@data$x),rep(12.4,27),unique(CNEB@data$col),cex=.5)

symbols(xys[,1],xys[,2],circle=sqrt(tmp$ttl),bg=c("red","orange","yellow","green","blue")[grps],fg=c("red","orange","yellow","green","blue")[grps],inches=.12,add=T)
legend(-73.4, 5, c("0-20%","20-40%","40-60%","60-80%","80-100%"), fill=c("red","orange","yellow","green","blue"),title="Porcentaje de\n identificación",cex=.7,bty="n")
 
 text(-69.5,5,"Número de\nejemplares",font=2,cex=.7)
 symbols(rep(-70,5),seq(2.6,4.4,length=5),circle=sqrt(quantile(tmp$ttl)),inches=.12,add=T)
 text(rep(-69,5),seq(2.6,4.4,length=5),round(quantile(tmp$ttl)),cex=.7)
@
\end{center} 
\caption{Número de ejemplares capturados (tamaño de los círculos) y porcentaje de ejemplares identificados (color de los círculos) por celda de la CNEB para las tres fases de muestreo de mariposas de NeoMapas.}
\label{MAPA:MRPSID}
\end{figure}


<<FamIDMrps, echo=false, results=tex>>=
##mariposas
grp <- paste(jmp.NM$familia, "::", jmp.NM$subfamilia)
grp[is.na(jmp.NM$subfamilia)] <- paste(jmp.NM$familia[is.na(jmp.NM$subfamilia)], " por asignar a subfamilia")

grp[is.na(jmp.NM$familia)] <- paste(" por asignar a familia")

mi.tt <- table(grp,jmp.NM$status_id %in% c("definitiva","preliminar"))
colnames(mi.tt) <- c("id. pendiente","id. confiable")
xtab <- xtable(mi.tt, caption="Número de ejemplares con identificación confiable e identificación pendiente por familia y subfamilia.", label="TAB:FAMID")
print(xtab,caption.placement="top", size="footnotesize")
@ 


Sin embargo el análisis de los datos de mariposas se vé limitado porque gran parte del material colectado carece de identificaciones confiables (Fig.~\ref{MAPA:MRPSID}). El progreso de identificación ha sido mayor para algunas familias, subfamilias o tribus que cuentan con herramientas de identificación actualizadas y válidas para Venezuela \citep{MIZA,Nei92,PieridaeColombia}. Por ahora los análisis de los muestreos de mariposas debe limitarse a estos grupos bien identificadas (Tab.~\ref{TAB:FAMID}) o a especies relativamente comunes de amplia distribución y fácil identificación (Fig. \ref{FIG:MRPSRAD}). Por ejemplo, la mayor parte de los ejemplares de las subfamilias Heliconiinae y Nymphalinae, y las tres subfamilias de la familia Pieridae tienen identificaciones confiables, y tienen varios representantes entre las 30 especies más comunes en la colección de NeoMapas.


<<echo=false, results=hide, eval=false>>=
tvn.NM$bioreg <- CNEB.nm[match(tvn.NM$CN,CNEB.nm$cdg),"bioreg"]
tapply(tvn.NM$vst,list(tvn.NM$bioreg,tvn.NM$fase),luq)
tapply(tvn.NM$sfrz,list(tvn.NM$bioreg,tvn.NM$fase),sum,na.rm=T)
@ 


\begin{figure}[htbp]
\begin{center}
<<RADmrps, fig=true, echo=false, results=hide>>=
tt <- table(jmp.NM$fase[jmp.NM$valido=="SI"],jmp.NM$spp[jmp.NM$valido=="SI"])
tt <- tt[,colSums(tt)>0]
tt <- tt[,rev(order(colSums(tt)))]
layout(matrix(1:2,ncol=1))
par(mar=c(4,4,1,2))
plot(1:ncol(tt),colSums(tt,na.rm=T),type="l",log="y",xlab="Especies ordenadas por conteos totales", ylab="Nr. de ejemplares capturados")
matpoints(1:ncol(tt),t(tt),log="y",type="p",pch=1,cex=.5)

par(mar=c(6,4,1,2))
plot(1:ncol(tt),colSums(tt,na.rm=T),type="l",log="y",xlim=c(1,30),axes=F, xlab="", ylab="Nr. de ejemplares capturados")
matpoints(1:ncol(tt),t(tt),log="y",type="p",pch=1,cex=1)
axis(2)
axis(1,1:30,colnames(tt)[1:30],las=2,cex.axis=.5)
box()
@
\end{center} 
\caption{Gráfico de abundancias de las especies ordenadas según  los conteos totales (línea negra). Se muestra el conteo de cada una de las fases (círculos) por color (negro: fase 1, rojo: fase 2 y verde: fase 3). En la figura superior se muestran todas las especies identificadas, en la figura inferior se muestran las 30 especies con mayores conteos.}
\label{FIG:MRPSRAD}
\end{figure}

\subsection{Especies representativas}

Los \Sexpr{sum(jmp.NM$valido=="SI")} ejemplares identificados hasta la fecha (\Sexpr{round(sum(jmp.NM$valido=="SI")*100/length(jmp.NM$valido),2)}\% del total) pertenecen a \Sexpr{ncol(tt)} especies. Las \Sexpr{sum(colSums(tt)>100)} especies con mayor número de ejemplares (100 o más ejemplares en las colectas de NeoMapas), representan \Sexpr{round(sum(colSums(tt)[colSums(tt)>100])/length(jmp.NM$valido)*100,1)} \% de los ejemplares colectados (Fig.~\ref{FIG:MRPSRAD}). Por lo general estas especies fueron capturadas abundantemente en la fase 2, en la cual se realizó el mayor esfuerzo de muestreo a nivel nacional, y mantienen proporciones similares en las otras fases del trabajo de campo (fase 2 > fase 3 > fase 1). Entre las especies de abundancias intermedias y bajas dominan las especies capturadas en la fase 1, sin embargo esto puede reflejar sesgos en la identificación, que por diversos motivos ha avanzado más en el material más antiguo.

Utilizamos el análisis de valor indicador de \citep{DL97} para cuantificar cuales especies se pueden considerar representativas de cada bioregión. Se considera una especie representativa aquella que es más abundante en una región que en las otras, y que está presente en la mayor parte de las localidades (en este caso celdas de la CNEB) de una región. 

\footnotesize
<<eval=true, echo=false>>=
## hacer una comparación por fase/celda, de la composición de especies o buscar especies con potencial indicador para los estratos ambientales o las bioregiones...
mi.ss <- jmp.NM$valido=="SI"
jmp.NM$URA <- paste(jmp.NM$CN,jmp.NM$fase,sep=".")
tt <- tapply(jmp.NM$jmp[mi.ss],list(jmp.NM$URA[mi.ss],jmp.NM$spp[mi.ss]),luq)
tt <- data.frame(tt)
tt[is.na(tt)] <- 0

mi.iv <- indval(tt, as.numeric(CNEB.nm[match(substr(rownames(tt),1,3), CNEB@data$cdg), "bioreg"]))

summary(mi.iv, p=0.01)
@
\normalsize

Del total de \Sexpr{length(mi.iv$pval)} especies analizadas \Sexpr{sum(mi.iv$pval<=.01)} tuvieron valores significativos para alguna región. En la región andina se observó mayor cantidad de especies características. Las especies representativas de los Llanos resultaron ser de las especies más abundantes y frecuentes.


\section{Caso de estudio de la familia Pieridae}

Para un análisis detallado de la riqueza y diversidad en este grupo taxonómico nos concentramos en los datos de los muestreos de 2006 de la familia Pieridae. Este material está identificado en más de un 90\% y es por ello idóneo para los análisis que presentamos a continuación. Estos análisis podrán extenderse a medida que progrese la identificación del material de otras fases del trabajo de campo y de otras familias.

La familia Pieridae es una de las mejor estudiadas y conocidas en Venezuela y está representada por unas 117 especies \citep{Vil00,Par08}.


\setkeys{Gin}{width=.75\textwidth}
\begin{figure}[htbp]
\begin{center}
<<MrpsCRE,eval=true,echo=false,results=hide,fig=true,width=6,height=6>>=

mrps.MSM.um <- mrps.OTR[rownames(mrps.OTR) %in% CNEB.nm$cdg[CNEB.nm$UM==1],]
mrps.MSM.um <- mrps.MSM.um[,colSums(mrps.MSM.um)>0]


max.mrps <- 106
mrps.NM.alpha <- rowSums(mrps.NM>0)
mrps.MSM.alpha <- rowSums(mrps.MSM.um>0)
mrps.cneb <- CNEB.nm[match(rownames(mrps.CN),CNEB.nm$cdg),]
mrps.msm.cneb <- CNEB.nm[match(rownames(mrps.MSM.um),CNEB.nm$cdg),]

mrps.tau <- specaccum(mrps.NM,method="exact",conditioned=FALSE,gamma="chao")
mrps.msm.tau <- specaccum(mrps.MSM.um,method="exact",conditioned=FALSE,gamma="chao")

cols <- c("grey42","grey77","pink3")
cols <- c("slateblue4","lightseagreen","pink3")
## realizamos una figura con las curvas para cada grupo
par(mar=c(4,4,2,1))

plot(mrps.msm.tau,
     xlab="", ylab="",  
     ylim=c(0,max.mrps*1.10),
     ci.type="polygon", col = cols[2], ci.col = cols[2],border=cols[2],main="")
plot(mrps.msm.tau,add=T,ci=0)
plot(mrps.tau,add=T,ci.type="polygon", col = 1, ci.col = cols[1],border=cols[1])
abline(h=max.mrps,lty=3,col=2)
text(60,max.mrps+3,paste("Viloria (1990):",max.mrps,"spp."),col=2,cex=.8)
title(xlab="Celdas de la CNEB", ylab="Nr. de especies detectadas")

@
\end{center} 
\caption{Curva de rarefacción del número de especies por unidad regional de análisis para las mariposas de la familia Pieridae según los datos de NeoMapas (color azul), y los de la literatura y colecciones nacionales (color verde).}
\label{FIG:MRPSCRE}
\end{figure}


\begin{figure}[htbp]
\begin{center}
<<mrpsBoxPlot, eval=true,echo=false,results=hide,fig=true,width=6,height=6>>=
cols <- c("grey42","grey77")
cols <- c("slateblue4","lightseagreen","pink3")
## realizamos una figura con las curvas para cada grupo
par(mar=c(4,4,1,1),oma=rep(0,4))

max.y <- 43
boxplot(mrps.NM.alpha~mrps.cneb$bioreg,at=c(1:6)-.25,width=rep(.1,6),xlim=c(1.6,6.47),varwidth=T,boxwex=.3,ylim=c(0,max.y),notch=F,axes=F,col = cols[1])
title(xlab="Bioregión", ylab="Número de especies por celda", line=3)
axis(2)
axis(1,1:6,rep("",6))
axis(1,seq(1,6,by=2),levels(mrps.cneb$bioreg)[seq(1,6,by=2)],line=-.4,lty=0)
axis(1,seq(2,6,by=2),levels(mrps.cneb$bioreg)[seq(2,6,by=2)],line=.4,lty=0)
##mrps.cneb$bioreg[mrps.NM.alpha>40]
##boxplot(rowSums(mrps.OTR>0)~m2.cneb$bioreg)
boxplot(mrps.MSM.alpha~mrps.msm.cneb$bioreg,at=c(1:6)+.25,add=T,varwidth=T,boxwex=.3,col=cols[2],notch=F,axes=F)#,subset=names(mrps.MSM.alpha) %in% mrps.slc)
box()

text(as.numeric(mrps.msm.cneb$bioreg[mrps.MSM.alpha>max.y])+.25,rep(max.y,sum(mrps.MSM.alpha>max.y)),mrps.MSM.alpha[mrps.MSM.alpha>max.y], cex=.7)
arrows(as.numeric(mrps.msm.cneb$bioreg[mrps.MSM.alpha>max.y])+.25, rep(max.y-4,sum(mrps.MSM.alpha>max.y)), as.numeric(mrps.msm.cneb$bioreg[mrps.MSM.alpha>max.y])+.25, rep(max.y-1.2,sum(mrps.MSM.alpha>max.y)),length = 0.03)


@ 

\end{center} 
\caption{Riqueza $\alpha$ de la familia Pieridae (número de especies por transección/celda de la CNEB) para cada bioregión según los datos de NeoMapas (2006), y los datos de la literatura y colecciones nacionales.}
\label{FIG:MRPSALPHA}
\end{figure}


<<TablaSppPieridae, eval=true, echo=false, fig=false, results=tex>>=
rws <- unique(c(rownames(mrps.MSM.um),as.character(mrps.cneb$cdg)))
cls <- unique(c(colnames(mrps.MSM.um),colnames(mrps.NM)))

mtz <- matrix(0,ncol=length(cls),nrow=length(rws),dimnames=list(rws,cls))

mtz[rownames(mrps.MSM.um),colnames(mrps.MSM.um)] <- mtz[rownames(mrps.MSM.um),colnames(mrps.MSM.um)]+mrps.MSM.um

mtz[as.character(mrps.cneb$cdg),colnames(mrps.NM)] <- 
mtz[as.character(mrps.cneb$cdg),colnames(mrps.NM)] + as.matrix(mrps.NM)


dts.mrps <- data.frame()
for (br in levels(CNEB.nm$bioreg)[-1]) {
	cdgs <- CNEB.nm$cdg[CNEB.nm$bioreg %in% br]
	sp1 <- specpool(mtz[rownames(mtz) %in% cdgs,])
	sp2 <- specpool(mrps.NM[mrps.cneb$cdg %in% cdgs,])
	sp3 <- specpool(mrps.MSM.um[rownames(mrps.MSM.um) %in% cdgs,])
  dts.mrps <- rbind(dts.mrps,
                    data.frame(bioreg=br,                    			n.NM=sp2$n,
                               spp.NM=sp2$Species,
                               chao.NM=sp2$chao,
                               se.NM=sp2$chao.se,
                                 C.NM=sp2$Species/sp2$chao,
              	n.GBIF=sp3$n,
                               spp.GBIF=sp3$Species,
                               chao.GBIF=sp3$chao,
                               se.GBIF=sp3$chao.se,
                                 C.GBIF=sp3$Species/sp3$chao,
              	n.total=sp1$n,
                               spp.total=sp1$Species,
                               chao.total=sp1$chao,
                               se.total=sp1$chao.se,
                                 C.total=sp1$Species/sp1$chao))

}

	br <- "total"
	cdgs <- CNEB.nm$cdg
	sp1 <- specpool(mtz[rownames(mtz) %in% cdgs,])
	sp2 <- specpool(mrps.NM[mrps.cneb$cdg %in% cdgs,])
	sp3 <- specpool(mrps.MSM.um[rownames(mrps.MSM.um) %in% cdgs,])
  dts.mrps <- rbind(dts.mrps,
                    data.frame(bioreg=br,                    			n.NM=sp2$n,
                               spp.NM=sp2$Species,
                               chao.NM=sp2$chao,
                               se.NM=sp2$chao.se,
                                 C.NM=sp2$Species/sp2$chao,
              	n.GBIF=sp3$n,
                               spp.GBIF=sp3$Species,
                               chao.GBIF=sp3$chao,
                               se.GBIF=sp3$chao.se,
                                 C.GBIF=sp3$Species/sp3$chao,
              	n.total=sp1$n,
                               spp.total=sp1$Species,
                               chao.total=sp1$chao,
                               se.total=sp1$chao.se,
                                 C.total=sp1$Species/sp1$chao))



Cci <- function(S.obs,S.est,S.var) {
	C <- S.obs/S.est
	var <- ((S.obs/S.est^2)^2) * S.var
	ci <- sqrt(var)*1.96
	sprintf("%.3f (%.3f -- %.3f)",C,C-ci,C+ci)
}
##Cci(rowSums(mrps.NM>0),Chao.mrps, sec.mrps^2)

##Cci(dts.mrps$spp.NM,dts.mrps$chao.NM, dts.mrps$se.NM^2)
##Cci(dts.mrps$spp.GBIF,dts.mrps$chao.GBIF, dts.mrps$se.GBIF^2)

##with(dts.mrps,1.64 * sqrt((se.NM^2)/chao.NM^2))
## with(dts.mrps,plot(se.GBIF^2/chao.GBIF,C.GBIF))


sd.mrps <- apply(log1p(mrps.NM),1,sd)
abnd.mrps <- apply(log1p(mrps.NM),1,mean)
H0.mrps <- diversity(mrps.NM, index = "shannon")
H1.mrps <- renyi(mrps.NM,scales=1)

ACE.mrps <- estimateR(mrps.NM)["S.ACE",]
## realmente, según el código de estimateR es standard deviation
se.mrps <- estimateR(mrps.NM)["se.ACE",]

Chao.mrps <- estimateR(mrps.NM)["S.chao1",]
sec.mrps <- estimateR(mrps.NM)["se.chao1",]

mrps.completitud <-  rowSums(mrps.NM>0)/ACE.mrps
mrps.complet1 <-  rowSums(mrps.NM>0)/Chao.mrps


mrps.varc <- (rowSums(mrps.NM>0)/Chao.mrps^2)^2 * sec.mrps^2

mrps.cci <- sqrt(mrps.varc)*1.96
##mrps.cci <- 1.96*((sec.mrps)/Chao.mrps)
mrps.cmin <- mrps.completitud-mrps.cci
mrps.cmax <- mrps.completitud+mrps.cci




mrps.rslt.data <- data.frame(cdg=rownames(mrps.NM),sfrz=mrps.sfrz, N.jmp=rowSums(mrps.NM), S.obs=rowSums(mrps.NM>0), log.abnd=abnd.mrps,sd.log.abnd=sd.mrps, H0=H0.mrps, ACE=ACE.mrps, se.ACE=se.mrps,C.ACE=mrps.completitud, Chao=Chao.mrps, se.Chao=sec.mrps, C.chao=mrps.complet1, cneb=mrps.cneb$cdg)

tt.OTR <- t(estimateR(mrps.MSM.um[rownames(mrps.MSM.um) %in% mrps.cneb$cdg,]))
## comparar valores de NeoMapas para estas celdas...

mrps.rslt.data <- merge(mrps.rslt.data,tt.OTR,by.x="cneb",by.y="row.names",all.x=T)

mrps.rslt.data$S.ACE <- NULL
mrps.rslt.data$se.ACE.y <- NULL

with(mrps.rslt.data,mean(S.obs.x/S.obs.y,na.rm=T))
##with(mrps.rslt.data,coin::wilcoxsign_test(Chao~S.chao1))
require(coin)
with(mrps.rslt.data,coin::wilcoxsign_test(S.obs.x~S.obs.y))

##with(aves.rslt.data[aves.rslt.data$cneb %in% aves.slc,],
##coin::wilcoxsign_test(S.obs.x~S.obs.y))


@ 

\subsection{Riqueza a nivel nacional y entre bioregiones}

La curva de acumulación de especies de NeoMapas no alcanza un inventario completo de las especies de Pieridae reportadas para el país, y está por debajo de la curva de las fuentes alternativas de información (Fig.~\ref{FIG:MRPSCRE}). Se podría considerar que las fuentes alternativas son más completas y eficientes, y la diferencia entre las curvas refleja probablemente problemas de detectabilidad de NeoMapas, relacionados con el esfuerzo total de muestreo: Los datos de NeoMapas provienen de una única temporada de muestreo, mientras los datos de otras fuentes reflejan varias décadas de colecta en campo.

<<especiesRaras,fig=false, echo=false, results=hide>>=
tt <- colSums(mrps.OTR>0)

t2 <- colSums(mrps.NM>0)
t3 <- colSums(mrps.NM)

df <- merge(data.frame(tt),data.frame(t2),by="row.names",all=T)
df <- merge(df,data.frame(t3),by.x="Row.names",by.y="row.names",all=T)

##layout(matrix(1:2,ncol=1))
##truehist(df[!is.na(df$t2),"tt"],prob=F)
##truehist(df[is.na(df$t2),"tt"],prob=F)
amplia <- paste("\\\\emph{",df[is.na(df$t2) & df$tt>=8,1],"}", sep="", collapse=", ")
reducida <- paste("\\\\textit{",df[is.na(df$t2) & df$tt<8 & df$tt>3,1],"}", sep="", collapse=", ")
restringida <- paste("\\\\textit{",df[is.na(df$t2) & df$tt<4,1],"}", sep="", collapse=", ")

ss <- colSums(mrps.OTR[rownames(mrps.OTR) %in% rownames(mrps.CN),!(colnames(mrps.OTR) %in% colnames(mrps.CN))])

@

De las especies no detectadas por NeoMapas durante los muestreos de 2006, \Sexpr{length(df[is.na(df$t2) & df$tt>=8,1])} pueden considerarse de distribución amplia según las fuentes consultadas\footnote{Especies de amplia distribución: \Sexpr{amplia}} y otras \Sexpr{length(df[is.na(df$t2) & df$tt<8,1])} son de distribución restringida\footnote{menos de 7 celdas en el CNEB: 
\Sexpr{reducida}} o muy restringida\footnote{3 o menos celdas en el CNEB: \Sexpr{restringida}}. De todas estas especies, \Sexpr{sum(ss>0)} han sido reportadas en colecciones o literatura para alguna de las celdas de la CNEB muestreadas por NeoMapas en 2006. El hecho de que no hayan sido detectadas por NeoMapas puede reflejar sesgos en los métodos de muestreos, o cambios recientes en las condiciones ambientales que afectan la presencia de estas especies. El diseño de los muestreos futuros debe tomar en cuenta el problema de estas especies no detectadas.

Los valores de riqueza regional observada y estimada según NeoMapas fueron muy parecidos entre bioregiones, a excepción de la bioregión de Occidente que tiene valores superiores, aunque con menor precisión del estimado de Chao (Tab.~\ref{TAB:MRPSBRG}). Los datos de la literatura parecen dar una imágen completamente distinta, con valores de riqueza mayores en los Andes, y Centro y Costa, y valores extremadamente bajos en Guayana. Aparentemente la riqueza de esta última región está pobremente representada en NeoMapas y las fuentes consultadas, con sólo \Sexpr{dts.mrps[dts.mrps$bioreg=="Guayana","total"]} especies. 

En general los totales observados y estimados por NeoMapas para cada bioregión estuvieron por debajo de los valores obtenidos por otras fuentes, y el valor estimado total es mucho menor que el valor esperado para todo el país. Sin embargo, para todas las bioregiones los valores medios de especies por transección de NeoMapas estuvieron por encima de los valores calculados con otras fuentes de datos, y presentaron también una menor dispersión (Fig.~\ref{FIG:MRPSALPHA}). Los resultados sugieren que NeoMapas ofrece valores menos sesgados de la riqueza local promedio (riqueza $\alpha$) para cada una de las bioregiones, pero observamos que en algunas celdas la literatura ha reportado valores muy superiores. Por otro lado el número total de especies detectadas es considerado un estimador \emph{naïve} de la riqueza, que no toma en cuenta la probabilidad de detección. 

\begin{landscape}
<<VariablesDependientesMariposas,echo=false, results=tex>>=

print(xtable(dts.mrps, caption="Total de especies por bioregión ($S_{obs}$) y estimado de riqueza basados en incidencia de especies ($S_{chao}$) para los muestreos de mariposas Pieridae de NeoMapas, y datos de literatura y colecciones. N: Número de transecciones o celdas de la CNEB. $S_{total}$: total de especies detectadas entre ambas fuentes de datos.",label="TAB:MRPSBRG", align="l|l|ccrlc|ccrlc|ccrlc|"), caption.placement="top", include.rownames=F, include.colnames=F, add.to.row=list(pos=list(-1,5), command=c("\\hline\nBioregión & \\multicolumn{5}{c|}{NeoMapas} & \\multicolumn{5}{c|}{Literatura + Colecciones} & \\multicolumn{5}{c|}{Total} \\\\\n & N & $S_{obs}$ & \\multicolumn{2}{c|}{$S_{chao} \\pm SE$} & $C_{chao}$ & N & $S_{obs}$ & \\multicolumn{2}{c|}{$S_{chao} \\pm SE$} & $C_{chao}$ &  N & $S_{obs}$ & \\multicolumn{2}{c|}{$S_{chao} \\pm SE$} & $C_{chao}$\\\\\n ","\\hline\n")), size="small")


mrps.rslt <- xtable(mrps.rslt.data, caption="Estimados de abundancia, riqueza de especies y diversidad  para los datos de Pieridae de 2006 de NeoMapas. $E$: esfuerzo de muestreo en minutos*colector (m*c), $N_{total}$: número total de ejemplares de Pieridae, $S_{obs}$: número de especies detectadas.", label="TAB:MRPSEST", align="|c|cl|cccrlcrlcrlc|crl|", digits=c(0,0,0, 0,0,0, 2,2,2, 2,2,2, 2,2,2, 0,2,2))


 print(mrps.rslt, caption.placement="top", include.rownames=F, include.colnames=F, add.to.row=list(pos=list(-1), command=c("
 \\hline\n \\multicolumn{2}{|c|}{} & \\multicolumn{12}{|c|}{NeoMapas} & \\multicolumn{3}{|c|}{Otras fuentes} \\\\\n
 \\hline\n \\multicolumn{2}{|c|}{} & $E$ (m*c) & $N_{total}$ & $S_{obs}$& \\multicolumn{2}{c}{$\\log N (\\mu \\pm \\sigma)$} & $H$ & \\multicolumn{2}{c}{ACE $\\pm$ s.e.} & $C_{ACE}$ & \\multicolumn{2}{c}{Chao $\\pm$ s.e.} & $C_{Chao}$ & $S_{obs}$ & \\multicolumn{2}{c}{Chao $\\pm$ s.e.} \\\\")), hline.after=c(-1,length(abnd.mrps)), size="footnotesize")
 
  mrps.rslt.data$Complementariedad.OTR <- with(mrps.rslt.data,Cci(S.obs.y,S.chao1,se.chao1^2))
mrps.rslt.data$Complementariedad.NM <- with(mrps.rslt.data,Cci(S.obs.x,ACE,se.ACE.x^2))
write.csv(file="TablaMrpsSI.csv",mrps.rslt.data,dec=".", row.names=F)

 
@ 
\end{landscape}
\subsection{Riqueza y diversidad por transección}

El estimador de riqueza de $\mathrm{ACE}$ estima la proporción de especies no detectadas en base a las abundancias relativas. Para los datos de NeoMapas este estimado estuvo un \Sexpr{round((median(ACE.mrps/rowSums(mrps.NM>0),na.rm=T)-1)*100,2)}\%  por encima de los valores observados, pero en  \Sexpr{sum(is.na(ACE.mrps))} transecciones no fue posible estimarlo (Tab.~\ref{TAB:MRPSEST}). Entre las transecciones muestreadas en 2006 el valor mínimo se observó en \Sexpr{names(which.min(ACE.mrps))}  (\Sexpr{round(min(ACE.mrps,na.rm=T),2)}) y el máximo en \Sexpr{names(which.max(ACE.mrps))} ( \Sexpr{round(max(ACE.mrps,na.rm=T),2)}). Las transecciones \Sexpr{paste(sub("NM[0-9]+ :: ","",rownames(mrps.NM)[rank(1/rowSums(mrps.NM>0))<6 & rank(1/ACE.mrps)<6 & rank(1/H0.mrps)<6]),collapse=", ")} estuvieron entre las 5 primeras en $S_{obs}$, $\mathrm{ACE}$ y del índice de diversidad de Shannon-Weaver ($H$). La dispersión en la distribución de abundancias ($\log \sigma$) es un estimador de la equidad dentro de cada transección, pero en este caso, las transecciones con valores más bajos (\Sexpr{paste(sub("NM[0-9]+ :: ", "", names(sd.mrps)[rank(sd.mrps,na.last=T)<6]), collapse=", ")}) fueron aquellas con menor número de ejemplares (promedio de \Sexpr{median(rowSums(mrps.NM)[rank(sd.mrps,na.last=T)<6])}) y especies (promedio de \Sexpr{median(rowSums(mrps.NM>0)[rank(sd.mrps,na.last=T)<6])}).

\subsection{Composición entre transecciones}

La matrix $\mathbf{D}_{chao}$ muestra un conjunto de 16 transecciones de cuatro bioregiones que resultaron estrechamente relacionadas, con valores bajos de disimilitud (< .25) y seis transecciones de zonas montañosas o semi-áridas aisladas de las demás con valores altos de disimilitud (>.65, Fig.~\ref{FIG:MRPSDNDR}). Las bioregiones Llanos y Centro y Costa fueron las más homogéneas y más parecidas entre sí, los Andes fue la más heterogénea, pero a la vez la que más se diferencia del resto de las bioregiones. Occidente y Guayana representan casos intermedios: las transecciones dentro de la región son muy disímiles entre sí, y las diferencias con otras bioregiones son intermedias.


\begin{figure}[tb]
\begin{center}
<<DDRGmrps,eval=true, echo=false, results=hide, fig=true, width=7, height=5>>=
mi.mtz <- mrps.NM
d1.mrps <- vegdist(mi.mtz,"chao")
mi.h1 <- as.dendrogram(as.hclust(agnes(d1.mrps)), hang=.2)
mi.mrpp <- meandist(d1.mrps,mrps.cneb$bioreg)
clrs <- brewer.pal(6,"Set1")
names(clrs) <- levels(mrps.cneb$bioreg)
pchs <- c(20,21,22,23,24,25)
names(pchs) <- levels(mrps.cneb$bioreg)

mis.clrs <- mi.col <- clrs[mrps.cneb$bioreg]
##c(0,"thistle","palegoldenrod","peachpuff3","whitesmoke","wheat")
names(mis.clrs) <- rownames(mi.mtz)


mis.pchs <- pchs[mrps.cneb$bioreg]
names(mis.pchs) <- rownames(mi.mtz)

 colLab <- function(n) {
           if(is.leaf(n)) {
             a <- attributes(n)
             attr(n, "nodePar") <- c(a$nodePar,
                                     list(lab.font=1,
                                          col=1,bg=mis.clrs[a$label],
                                          lab.col=1,
                                          pch=mis.pchs[a$label],cex=1.15,
                                          lab.cex=.68))

           }
           n
     }
     h0e <- dendrapply(mi.h1, colLab)

par(mar=c(7,4,1,1))
plot(h0e,ylab="Índice de disimilitud (Chao)")

op <- par(fig=c(0.3,.6,0.55,.85),new=TRUE,xpd=NA,mar=c(1,1,1,1),cex=.8)
cl <- hclust(as.dist(mi.mrpp), method="average")
cl <- as.dendrogram(cl, hang = 0)
w <- diag(mi.mrpp)[labels(cl)]
tr <- unlist(dendrapply(cl, function(n) attr(n, "height")))
root <- attr(cl, "height")
ylim <- range(c(w, tr, root), na.rm = TRUE)
plot(cl, ylim = ylim, leaflab = "none", axes = T, main="Disimilitud media por bioregión")
box(fg="grey66")
for (i in 1:length(w)) segments(i, tr[i], i, w[i])
pos <- ifelse(w < tr, 1, 3)
pos[is.na(pos)] <- 1
w[is.na(w)] <- tr[is.na(w)]
text(1:length(w), w, labels = labels(cl), pos = pos, 
            srt = 0,col=clrs[labels(cl)], font=2)
points(1:length(w), w,bg=clrs[labels(cl)],pch=pchs[labels(cl)])

##legend(4.3,.65,levels(mrps.cneb$bioreg)[-1],pt.bg=brewer.pal(6,"Set1")[-1],pch=21:25,cex=.85,title="Bioregiones")

@ 
\end{center} 
\caption{Dendrograma de la clasificación de las transecciones de Mariposas del muestreo de 2006 basado en la composición de mariposas Pieridae utilizando el estimado de disimilitud de Chao y el algoritmo de aglomeración jerárquica.}
\label{FIG:MRPSDNDR}
\end{figure}


\subsection{Correlación con variables ambientales y biogeográficas}


<<tablaAICmrps,echo=false, eval=true, results=tex>>=
## según sugerencia de Kate
	aics.ttl <- data.frame()
	mis.vars <- c("bioreg","PC1","PC2","PC3")
	##mis.vars <- c("bioreg","bosq_avrg","prcp_avrg","tmpm_avrg")
	k <- length(mis.vars)
	tds.vars <- "bioreg+PC1+PC2+PC3+PC4+PC5+PC6+PC7+PC8+PC9+PC10"
	##tds.vars <- "bioreg+PC1+PC2+PC3"
aves.sfrz <- NULL
## realmente para aves la tendencia es casi lineal, exceptuando los valore en la extrema derecha (mayor completitud y menor se)
## plot(1/se.aves~aves.completitud)
## para mariposas si se deben esperar mayores diferencias
##plot(1/se.mrps~mrps.completitud)
## plot(mrps.sfrz~mrps.completitud)

for (grp in c("mrps")) {
	mi.cneb <- get(paste(grp,"cneb",sep="."))
for (mi.vd in c("abnd","sd","H0","ACE")) {
	
	switch(mi.vd, ACE= {## usamos 1/sigma^2
		mi.wg <- 1/(get(paste("se",grp,sep="."))^2)
		mi.wg <- (get(paste(grp,"completitud",sep=".")))
		},
		H0={
		mi.wg <- (get(paste(grp,"completitud",sep=".")))
		},
		sd={
		mi.wg <- (get(paste(grp,"sfrz",sep=".")))
		mi.wg <- (get(paste(grp,"completitud",sep=".")))
		},
		abnd={
		mi.wg <- (get(paste(grp,"sfrz",sep=".")))
		mi.wg <- (get(paste(grp,"completitud",sep=".")))
		})
		
	aics <- data.frame()
	mi.lm <- lm(formula(paste(paste(mi.vd, grp, sep="."), "~", 1)),data=mi.cneb, weights=mi.wg)
	aics <- data.frame(grp=grp, vd=mi.vd, formula="~1", R2.adj=summary(mi.lm)$adj.r.squared, logLik=logLik(mi.lm)[[1]], k=mi.lm$rank+1, n=nrow(mi.lm$model), AIC=AIC(mi.lm), deltaAIC=NA, wi=NA, aic.weights=NA)			
	
	for (i in 1:k) {
		kiis <- combinations(k,i)
		for (j in 1:nrow(kiis)) {
			mi.frm <- paste(paste(mi.vd, grp, sep="."), "~", paste(mis.vars[kiis[j,]], collapse="+"))
			mi.lm <- lm(formula(mi.frm),data=mi.cneb, weights=mi.wg)
			aics <- rbind(aics, data.frame(grp=grp,vd=mi.vd, formula=paste(mis.vars[kiis[j,]], collapse="+"), R2.adj=summary(mi.lm)$adj.r.squared, logLik=logLik(mi.lm)[[1]], k=mi.lm$rank+1,n=nrow(mi.lm$model), AIC=AIC(mi.lm), deltaAIC=NA,wi=NA, aic.weights=NA))			
		}
	}
	

	aics$AICc <- aics$AIC + (2*aics$k*(aics$k+1))/(aics$n-aics$k-1)
	
	aics$deltaAIC <- aics$AICc - min(aics$AICc)
	aics$wi<-exp(1)^(-0.5*aics$deltaAIC)
	aics$aic.weights<-aics$wi/sum(aics$wi)

	mi.lm <- lm(formula(paste(paste(mi.vd,grp,sep="."),"~",
			tds.vars)),data=mi.cneb, weights=mi.wg)
	mi.st <- step(mi.lm, trace=FALSE)			
	aics <- rbind(aics, data.frame(grp=grp,vd=mi.vd, formula=paste(colnames(mi.st$model)[2:(ncol(mi.st$model))]
, collapse=" + "), R2.adj=summary(mi.st)$adj.r.squared, logLik=logLik(mi.st)[[1]],k=mi.st$rank+1, n=nrow(mi.st$model),  	AIC=AIC(mi.st),deltaAIC=NA, wi=NA, aic.weights=NA, AICc=NA))

	aics <- rbind(aics, data.frame(grp=grp, vd=mi.vd, formula=tds.vars, R2.adj=summary(mi.lm)$adj.r.squared, logLik=logLik(mi.lm)[[1]],k=mi.lm$rank+1, n=nrow(mi.lm$model), AIC=AIC(mi.lm), deltaAIC=NA, wi=NA,aic.weights=NA, AICc=NA))

	aics.ttl <- rbind(aics.ttl,aics)
}
}

aics.mrps <- aics.ttl[!is.na(aics.ttl$aic.weights), ]

print(xtable(aics.mrps[aics.mrps$aic.weights>0.1, c("vd","formula","k","n","logLik","AICc","aic.weights","R2.adj")], caption="Pesos de Akaike para todos los modelos ajustados a la riqueza, diversidad y abundancia de mariposas Pieridae en los muestreos de 2006.", label="TAB:AICCMRPS", digits=c(0,0,0,0,0,2,2,3,2)), caption.placement="top", size="footnotesize", include.rownames=F)

@ 

Un modelo lineal con \Sexpr{aics.ttl[aics.ttl$vd=="ACE" & aics.ttl$deltaAIC==0 & !is.na(aics.ttl$deltaAIC),"formula"]} explica hasta el \Sexpr{round(aics.ttl[aics.ttl$vd=="ACE" & aics.ttl$deltaAIC==0 & !is.na(aics.ttl$deltaAIC),"R2.adj"]*100)}\% de la variación en $\mathrm{ACE}$, pero ninguna de las variables consideradas realizó un aporte significativo para explicar la variación en $H$ o $\log \sigma$ (Tab.~\ref{TAB:AICCMRPS}). 

Estos resultados sugieren que las variables asociadas a los componentes PC1 y PC3 son las que están más relacionadas con los patrones de riqueza en las regiones muestreadas por NeoMapas. La riqueza estimada es mayor en las transecciones de mayor altitud, con mayor cobertura boscosa y más heterogeneas en las condiciones de temperatura y precipitación (Fig.~\ref{FIG:MRPSACE}).

\begin{figure}[tb]
\begin{center}
<<ACEPCs, echo=false, results=hide, fig=true>>=
##plot(env.pc, display = "sites", choices = c(1, 3), scaling = 2, col="grey77",pch=19)
plot(PC3~PC1,CNEB.nm,col="grey77", xlim=c(-2,1))
abline(h=0, v=0, col="aliceblue")
abline(h=0, v=0, lty=3, col="slateblue4")
arrows(x0=0,y0=0,x1=scores(env.pc, display = "species", choices = c(1), scaling = 2),y1=scores(env.pc, display = "species", choices = c(3), scaling = 2), col="maroon", length=.08, angle=25)
abline(h=0,v=0,col="aliceblue")
symbols(mrps.cneb$PC1,mrps.cneb$PC3,circles=ACE.mrps,inches=.1,bg=3,add=T)
text(env.pc, display = "species", choices = c(1, 3), scaling = 2, col=1,cex=.7,font=2)

@
\end{center} 
\caption{Relación entre el valor calculado de riqueza de mariposas Pieridae por transección y los scores de los componentes PC1 y PC3 del universo muestral. Los círculos grises representan celdas no muestreadas, los círculos verdes representan el muestreo realizado en 2006, y el tamaño es proporcional al número de especies estimadas según el $ACE$.}
\label{FIG:MRPSACE}
\end{figure}

Analizamos la composición de especies con este mismo conjunto de variables utilizando el método análisis permutacional y multivariado de la varianza (PMANOVA):

\footnotesize
<<eval=true, echo=false, fig=false>>=
mrps.cneb <- CNEB.nm[match(rownames(mrps.CN),CNEB.nm$cdg),]
##table(mrps.cneb[,c("bioreg","est.pr")])
##adonis(mi.d1~bioreg+est.pr,scrb.cneb)
tmp <- adonis(d1.mrps~bioreg+(PC1+PC2+PC3),mrps.cneb)
print(tmp)
@ 
\normalsize

El \Sexpr{round(sum(tmp$aov.tab$R2[tmp$aov.tab[,"Pr(>F)"]<.05 & !is.na(tmp$aov.tab[,"Pr(>F)"])])*100)} \% de la variación en la composición es explicado por la bioregión y PC1.

El aporte de NeoMapas para el estudio de la diversidad de mariposas Pieridae está limitado por la detectabilidad imperfecta asociada a los métodos de muestreo, sin embargo resulta ser una fuente importante para el estudio a nivel local, llenando vacíos en la información que proveen otras fuentes. Para un análisis exhaustivo de la riqueza de especies en Venezuela y las bioregiones será necesario utilizar varias fuentes de datos y aplicar métodos de predicción espacial para llenar los lagunas de información. Los datos de composición y conteos permiten analizar otros aspectos de la diversidad más allá del número de especies, pero es necesario ajustar los estimados por detectabilidad, y buscar fuentes alternativas de información que permitan calibrar adecuadamente los resultados obtenidos.

\chapter{Muestreo de Escarabajos 2005-2010}
\label{CAP:SCRB}


Escogimos a los escarabajos coprófagos como un grupo indicador en 2005. Ese año realizamos un estudio de calibración de métodos en cuatro regiones del país, y en 2006 realizamos un estudio piloto en un tercio de las localidades de muestreo de mariposas. En 2008 hicimos un muestreo adicional en las inmediaciones en la sede principal del IVIC en Altos de Pipe. Posteriormente, planificamos un muestreo a nivel nacional, pero enfocado principalmente en las bioregiones de Guayana y los Andes. 


<<ResumenScrb, echo=false, results=hide>>=
trmp.NM$cb <- "sin cebo"
trmp.NM$cb[trmp.NM$cebo %in% c("heces humanas", "bosta de caballo", "heces de perro", "Heces Humanas", "HH", "HV", "Estiercol", "Heces Cerdo", "bosta de vaca",  "heces perro")] <- "heces"

trmp.NM$cb[trmp.NM$cebo %in% c("higado", "pulmon", "Viceras", "insecto", "hongos", "fruta")] <- "otros"


trmp.NM$cb[trmp.NM$cebo %in% c("pescado", "pollo", "rata", "Carne Podrida", "Polo", "Pollo",  "carne podrida", "Pollo Podrido", "carne", "pescado ", "CP", "PP", "Carne de Cerdo", "carne molida",   "Pescado", "POLLO", "PARECE CARNE EN ", "Carne molida")] <- "carne"

##trmp.NM$cebo %in% c("sin cebo", "robado", "??", "", "NA")

tt <- aggregate(scrb.solis[,6:(ncol(scrb.solis)-3)],by=list(scrb.solis$NM,scrb.solis$yr),sum,na.rm=T)
colnames(tt)[1:2] <- c("NM","yr")

tmp1 <- aggregate(trmp.NM[,c("sfrz","njmp")],  by=list(trmp.NM$yr, trmp.NM$NM), sum)
colnames(tmp1) <- c("yr","NM","sfrz","njmp")

tmp2 <- aggregate(trmp.NM[,c("Prd","vst","fch","cb")], by=list(trmp.NM$yr,trmp.NM$NM),luq)
colnames(tmp2)[1:2] <- c("yr","NM")

tmp3 <- merge(tmp1,tmp2)

tmp4 <- data.frame(NM=tt[,1],
			yr=sprintf("20%s",tt[,2]),
			solis.jmp=rowSums(tt[,-(1:2)]),
			solis.spp=rowSums(tt[,-(1:2)]>0))

tmp5 <- aggregate(scr.NM[,c("jmp","spp")],by=list(scr.NM$NM,scr.NM$yr),luq)
colnames(tmp5)[1:2] <- c("NM","yr")

tmp6 <- aggregate(scr.NM[,c("vst")],by=list(scr.NM$NM,scr.NM$yr),luq)
colnames(tmp5)[1:2] <- c("NM","yr")


scrb.rsm <- merge(tmp5,merge(tmp3,tmp4,by=c("NM","yr"),all=T), by=c("NM","yr"), all=T)
##scrb.rsm <- merge(tmp3,tmp4,by=c("NM","yr"),all=T)
scrb.rsm <- scrb.rsm[order(scrb.rsm$yr,scrb.rsm$NM),]


scrb.rsm$jmp[!is.na(scrb.rsm$solis.jmp)] <- scrb.rsm$solis.jmp[!is.na(scrb.rsm$solis.jmp)]

scrb.rsm$spp[!is.na(scrb.rsm$solis.spp)] <- scrb.rsm$solis.spp[!is.na(scrb.rsm$solis.spp)]

scrb.rsm <- scrb.rsm[!is.na(scrb.rsm$sfrz),]
 scrb.rsm$p.id <- scrb.rsm$jmp/scrb.rsm$njmp
scrb.rsm[is.na(scrb.rsm$p.id),"p.id"] <- 0 
scrb.rsm[scrb.rsm$NM %in% c("15","41"),"p.id"] <- 0.01 

scrb.rsm$CNEB <- info.NM$CNEB[match(as.numeric(scrb.rsm$NM),info.NM$NM)]

scrb.rsm$cb <- NA
for (j in 1:nrow(scrb.rsm)) {
	scrb.rsm$cb[j] <- luq(trmp.NM$vst[trmp.NM$NM %in% scrb.rsm$NM[j] & trmp.NM$yr %in% scrb.rsm$yr[j] & trmp.NM$cb=="heces"])*100/luq(trmp.NM$vst[trmp.NM$NM %in% scrb.rsm$NM[j] & trmp.NM$yr %in% scrb.rsm$yr[j]])
}

scr.NM$esp <- paste(scr.NM$genero,scr.NM$especie)
tt <- aggregate(scrb.solis[,6:(ncol(scrb.solis)-3)],by=list(scrb.solis$NM,scrb.solis$yr),sum,na.rm=T)
colnames(tt)[1:2] <- c("NM","yr")
mi.ss <- scr.NM$yr=="2005" & grepl("Scarabaeinae",scr.NM$familia)
t2 <- data.frame(tapply(scr.NM[mi.ss,c("jmp")],list(scr.NM$NM[mi.ss],scr.NM$esp[mi.ss]),luq))
t2[is.na(t2)] <- 0

t2$NM <- rownames(t2)
t2$yr <- "05"

scrb.NM <- merge(tt,t2[c("09","24","26"),],all=T)
scrb.NM[is.na(scrb.NM)] <- 0
scrb.cneb <- CNEB.nm[match(info.NM$CNEB[match(as.numeric(scrb.NM$NM),info.NM$NM)],CNEB.nm$cdg),]

lit.scrb <- rownames(scrb.OTR)
tds.scrb <- info.NM$CNEB[match(as.numeric(unique(scrb.rsm$NM)),info.NM$NM)]
slc.scrb <- info.NM$CNEB[match(as.numeric(unique(scrb.rsm$NM[scrb.rsm$p.id>.1])),info.NM$NM)]

tds.mrps <- info.NM$CNEB[match(as.numeric(unique(tvn.NM$NM[!is.na(tvn.NM$NM)])),info.NM$NM)]
msm.mrps <- rownames(mrps.OTR)
@ 

<<TablaResumenScrb, echo=false, results=tex>>=
tt <- scrb.rsm[, c("NM", "CNEB", "yr", "vst","cb","sfrz","jmp", "spp")]
tt$notas <- ""
tt$notas[scrb.rsm$p.id <.1] <- "**"
tt$notas[scrb.rsm$p.id==0] <- "*"

tab <- xtable(tt,caption="Transecciones incluídas en los muestreos de escarabajos desde 2005 hasta 2010. NM: código de la transección, yr: año de muestreo, vst: número de trampas colocadas, cb: porcentaje de trampas con cebo de heces, sfrz: esfuerzo de muestreo en horas trampa, jmp: número de ejemplares capturados, spp: número de especies identificadas hasta la fecha, notas: * Muestras no identificadas, ** Muestras identificadas parcialmente", label="TAB:SCRB", digits=c(0,0,0,0,0,1,1,0,0,0))

print(tab,include.rownames=F, caption.placement="top", size="footnotesize")

@

Los escarabajos coprófagos (Coleoptera, Scarabaeinae) han sido propuestos como un grupo indicador de biodiversidad \citep{spector2006scarabaeine}. Al alimentarse principalmente de excrementos y de materia en descomposición, los escarabajos coprófagos son un componente clave en el ciclaje de nutrientes y dispersión de semillas \citep{spector2006scarabaeine, FaH99, FaD97}. Además de su importante papel ecológico, otra característica que hace a los escarabajos coprófagos un blanco interesante para programas de inventario y monitoreo es su alta diversidad y abundancia en el neotrópico, reportándose cerca de 1300 especies y alrededor de 70 géneros \citep{Esc04}. No obstante, a pesar de estas cualidades, no ha sido implementado programas de monitoreo a gran escala para este grupo, en parte debido a la dificultad de realizar protocolos de muestreos robustos que generen datos de distribución y abundancia comparables entre distintas escalas y tipos de hábitats \citep{Hortal:2001rt}, sin embargo existen varios ejemplos de esfuerzos en esta dirección \citep{LF05a, Gal.08}.  

\begin{figure}[htbp]
\begin{center}
<<mapaScrb,eval=true, echo=false, results=hide, fig=true>>=
scrb.OTR.um <- scrb.OTR[rownames(scrb.OTR) %in% CNEB.nm$cdg[CNEB.nm$UM==1],]
scrb.OTR.um <- scrb.OTR.um[,colSums(scrb.OTR.um)>0]

## colocamos los márgenes
par(mar=c(1,0,2,0))
##Cuadrícula con los códigos en los bordes
plot(CNEB,border=NA)
text(rep(-73.5,23),unique(CNEB@data$y),unique(CNEB@data$fila),cex=.5)
text(unique(CNEB@data$x),rep(12.4,27),unique(CNEB@data$col),cex=.5)
##title(main="Escarabajos",sub="NeoMapas 2005 a 2010 y Literatura",line=-1)

## Datos de los museos como celdas sombreadas de la cuadrícula
plot(CNEB[CNEB@data$cdg %in% lit.scrb,],add=T,col="grey83",border="grey77")

## División política
plot(vzla,border="maroon",add=T)

## mostramos las celdas muestreadas y la selección de celdas utilizadas
## en este caso
tmp <- table(scrb.rsm$CNEB)

symbols(coordinates(CNEB[CNEB@data$cdg %in% names(tmp),]),circle=rep(1,length(tmp)),inches=.06,add=T)

symbols(coordinates(CNEB[CNEB@data$cdg %in% slc.scrb,]),circle=rep(1,length(unique(slc.scrb))),inches=.06,add=T,fg=1,bg=1)

symbols(coordinates(CNEB[CNEB@data$cdg %in% names(tmp)[tmp>1],]),circle=rep(1,sum(tmp>1)),inches=.06,bg=2,fg=2,add=T)
##invisible(text(coordinates(CNEB[CNEB@data$cdg %in% tds.scrb,]), labels=CNEB@data[CNEB@data$cdg %in% tds.scrb,"cdg"], cex=0.7,col=1))

@ 
\end{center} 
\caption[Mapa con colectas de escarabajos]{Mapa con colectas de escarabajos coprófagos. Las regiones muestreadas por NeoMapas están representadas por círculos. Círculos sólidos: material completamente identificado, círculos abiertos: material que no ha sido completamente identificado. Las celdas con círculos rojos han sido muestreados en dos años diferentes o contienen más de una transección. Las celdas grises reflejan la distribución de registros provenientes de la revisión de la literatura.}
\label{MAPA:SCB}
\end{figure}


\section{Protocolo de campo para el muestreo de escarabajos coprófagos}
Hasta la fecha, el método de muestreo utilizado con mayor frecuencia ha sido las trampas de caída cebadas con heces o materia orgánica vegetal o animal en descomposición \citep{Halffter-G:1997fk}. Las trampas de caída son muy eficientes pues aprovechan el comportamiento de las especies para recabar muestras de manera continua sin necesidad de una constante interacción del colector \citep{Efford-MG:2009qy}. La mayor limitación en el uso de este tipo de trampas es el tiempo necesario para la colocación de las mismas. Este método ha sido utilizado en estudios que comparan la composición de especies en localidades con distintos grados de fragmentación \citep{LLF08,GiS01,Nal.07a,Andresen:2008uq} o diferentes usos de la tierra \citep{HF05,Gal.08,favila2005diversidad,howden1975effects}. En estos estudios, típicamente se realizan muestreos puntuales en áreas geográficas reducidas, en donde las trampas son arregladas formando grupos a lo largo de una transecta. El interés se centra entonces en obtener los estimados puntuales de riqueza, abundancia o composición en un tipo de hábitat para luego poder compararlo con otro \citep{LF05a}. No obstante, para monitorear tendencias de cambios a escala regional o nacional y para discernir si los cambios locales, se enmarcan dentro de estas mismas tendencias, se necesita cubrir una amplia gama de escalas geográficas. Para ello se requiere un diseño muestral eficiente que permita extender y estandarizar los muestreos locales y replicarlos adecuadamente en diferentes regiones con diferentes características ambientales para obtener estimados confiables de las variables de interés: riqueza, diversidad y composición de especies \citep{buzas1996biodiversity,GC01}. El diseño muestral debe tomar en cuenta tanto los factores que influyen directamente en las variables de interés \citep[biogeografía, heterogeneidad de hábitats, estructura del paisaje, condiciones climáticas, etc,][]{JLL08}, como los factores que afectan la detectabilidad de las especies, y por tanto influyen en la confiabilidad de los estimados  \citep[especialmente el esfuerzo de muestreo, la efectividad de los métodos de captura y la heterogeneidad espacial, ][]{KS04}.

Para la técnica de muestreo de escarabajos coprófagos con trampas de caída con atrayente, existen varios aspectos del diseño muestral que pueden influir en los resultados obtenidos: el número de trampas, la duración del muestreo, el arreglo espacial de las trampas, y el tipo de cebo utilizado \citep{filgueiras2009attractivity,flechtmann2009influence,LF05a}). Así, a lo largo de la transecta de muestreo, los grupos de trampas adyacentes probablemente compartan más especies que los grupos más alejados. Una posible solución a este problema de diseño podría ser incrementar las distancias entre grupos de trampas, pero esto debe sobrepasarse con el riesgo de perder especies entre grupos \citep{Fisher:1999fj}. Entonces, un diseño muestral óptimo representa un compromiso entre el grado de independencia entre las trampas, el tiempo y el costo asociado con el espaciado de los grupos de trampas  y la eficiencia en estratificar las unidades de muestreo entre los distintos tipos de hábitats \citep{RMK07}.

En general, el protocolo consistió en ubicar un número variable de grupos de trampas de caída cebadas con ca.~20 grs de heces humanas, carroña o fruta en descomposición. En todos los casos la unidad de muestreo fue la trampa de caída \citep{LF05a} y cuantificamos el esfuerzo de muestreo como la suma de las horas que cada trampa se mantuvo activa en el campo (horas*trampa). El número total de trampas, la proporción de cebos utilizados y la disposición de las mismas a lo largo de la transecta fue variable, pero se mantuvo una distancia mínima de ca. 50 m entre trampas. 

Las trampas de caída fueron hechas utilizando envases plásticos de 12,5 cm de diámetro y 13 cm de profundidad, cubiertas por un plato plástico para proteger a la trampa del sol y la lluvia \citep{spector2006scarabaeine}. Las trampas contenían una solución preservante, (agua sobresaturada con sal, o agua y etanol en proporciones 40\% y 60\%, o alcohol técnico al 95\%). El cebo fue colocado en una bolsa de tul de nylon que luego fue suspendido con un alambre corto. Para ello, enterramos el alambre en el suelo, de manera que el cebo quedó suspendido por encima del líquido preservativo de los envases plásticos. El material fue colectado diario o interdiario por tres o cuatro días consecutivos (tiempos de revisión 24, 48, 72 y 96 horas). Generalmente sólo se realizaron sustituciones de  cebos cuando este fue removido por algún animal o en caso de inundación de la trampa. Adicionalmente, tomamos una detallada descripción del tipo de hábitat, así como de las principales perturbaciones (como quemas, deforestación, construcciones de viviendas, etc.). En cada revisión, el material colectado se limpió pasando la muestra por un colador y enjuagando con solución preservativa limpia. Seguidamente, era transferido a bolsas plásticas con alcohol técnico/solución preservativa limpia y las bolsas fueron rotuladas con el código de la transecta, el punto de muestreo, fecha y hora.

<<echo=false,results=tex>>=
fams <- c()
for (i in colnames(scrb.NM)) {
  fams <- c(fams,unique(Escarabajos$trb[match(strsplit(i,"\\.")[[1]][1],Escarabajos$gen)]))
}
fams[grep("Oxysternum",colnames(scrb.NM))] <- "Phanaeini"
fams[grep("Tetramerteia",colnames(scrb.NM))] <- "Phanaeini"
fams[grep("Euristernus",colnames(scrb.NM))] <- "Oniticellini"

mi.tt <- data.frame()
for (i in unique(fams[!is.na(fams)])) {
  mi.tt <- rbind(mi.tt,i=rowSums( rowsum(scrb.NM[,fams %in% i],scrb.cneb$bioreg)))
}
mi.tt <- t(mi.tt)
colnames(mi.tt) <- abbreviate(unique(fams[!is.na(fams)]))
rownames(mi.tt) <- levels(scrb.cneb$bioreg)[-1]
mi.tt <- cbind(mi.tt,total=rowSums(mi.tt))
mi.tt <- rbind(mi.tt,total=colSums(mi.tt))
mi.tt <- mi.tt[c(1,5,2,3,4,6),]
print(xtable(mi.tt,digits=0,caption=paste("Ejemplares capturados por tribu y bioregión.",paste(abbreviate(unique(fams[!is.na(fams)])),": ",unique(fams[!is.na(fams)]),sep="", collapse="; ")), label="TAB:SCRBFAM"),caption.placement="top", size="footnotesize")
@ 


Los ejemplares de tres transectas (NM09, NM24 y NM26) colectados en 2005 fueron identificados por Antonio dAscencao (Universidad de los Andes, ULA) y se mantienen en su colección. El resto del material fue identificado por Ángel Solis (Instituto Nacional de Biodiversidad de Costa Rica, INBIO), utilizando la clave de \citet{Vaz-de-Mello:2007kx}, y referencias contenidas en ella, este material se mantiene en la colección del Centro de Ecología del Instituto Venezolano de Investigaciones Científicas almacenados en grupos de especies o morfoespecies por trampa en bolsas plásticas con alcohol técnico. Los nombres de las especies fueron validados con la base de datos taxonómica de The Scarabaeinae Research Network \citep{scarabnet}.

\section{Ensayo y aplicación del protocolo de campo}


\subsection{Fase 1: Ensayo de métodos}

En 2005 realizamos la calibración de los métodos de colecta de escarabajos y mariposas en cinco transecciones de prueba. En estas transecciones variamos el número de trampas, el tamaño de los grupos de trampas y la composición de los cebos. Además procuramos cubrir la totalidad de la ruta seleccionada para obtener una representación completa de la variabilidad espacial de la transección. Por este motivo la intensidad del muestreo fue mayor, aunque no se utilizó un protocolo común. Los resultados de este ensayo se presentaron por primera vez en un informe de resultados para la organización responsable del financiamiento.

<<scrbfase1, echo=false, results=hide>>=
tmp <- scrb.rsm[scrb.rsm$yr < 2006,]
mtz <- scrb.NM[scrb.NM$yr=="05",-(1:2)]
@

Durante el ensayo de métodos se capturaron \Sexpr{sum(tmp$jmp, na.rm=T)} ejemplares en \Sexpr{round(sum(tmp$sfrz, na.rm=T),2)} horas*trampa de esfuerzo de muestreo. Esto significa una efectividad de captura promedio de \Sexpr{round(sum(tmp$sfrz, na.rm=T)/sum(tmp$jmp, na.rm=T),2)} ejemplares por horas*trampa. Se colocaron \Sexpr{sum(tmp$vst, na.rm=T)} trampas para un promedio de  \Sexpr{round(sum(tmp$sfrz, na.rm=T)/sum(tmp$vst, na.rm=T),2)} horas por trampa. Hasta la fecha se han identificado \Sexpr{sum(colSums(mtz, na.rm=T)>0)} especies/morfotipos a partir del material colectado (Tabla \ref{TAB:SCRB}).


\subsection{Fase 2: Estudio piloto}

Realizamos un estudio piloto entre julio y septiembre de 2006 como parte de las actividades del primer curso ``Inventario y monitorización de la biodiversidad neotropical'' en el Centro de Ecología del IVIC. Debido a limitaciones logísticas, este estudio piloto estuvo restringido a nueve de las 27 transecciones visitadas, las cuales fueron seleccionadas para representar todas las bioregiones. 

El protocolo de muestreo aplicado fue elaborado a partir de las recomendaciones del informe de la fase 1, y lo aplicamos de manera uniforme en todas las transecciones, utilizamos 6 a 8 grupos de trampas por transección con 7 a 9 trampas por grupo de trampas, y utilizando exclusivamente cebos de heces humanas. Las trampas permanecieron activas por cuatro días continuos, y las revisiones fueron diarias o interdiarias. 

<<scrbfase2, echo=false, results=hide>>=
tmp <- scrb.rsm[scrb.rsm$yr == 2006,]
mtz <- scrb.NM[scrb.NM$yr=="06",-(1:2)]
@

Durante el estudio piloto se capturaron \Sexpr{sum(tmp$jmp, na.rm=T)} ejemplares en \Sexpr{round(sum(tmp$sfrz, na.rm=T),2)} horas*trampa de esfuerzo de muestreo. Se colocaron \Sexpr{sum(tmp$vst, na.rm=T)} trampas para un promedio de  \Sexpr{round(sum(tmp$sfrz, na.rm=T)/sum(tmp$vst, na.rm=T),2)} horas por trampa. Esto significa una efectividad de captura promedio de \Sexpr{round(sum(tmp$sfrz, na.rm=T)/sum(tmp$jmp, na.rm=T),2)} ejemplares por horas*trampa. Hasta la fecha se han identificado \Sexpr{sum(colSums(mtz, na.rm=T)>0)} especies/morfotipos a partir del material colectado (Tabla \ref{TAB:SCRB}).

Combinamos resultados de la fase 1 y la fase 2 para elaborar un protocolo de campo más eficiente, aunque hay algunos aspectos que todavía pueden ser mejorados.


\begin{figure}[htbp]
\begin{center}
<<EjemplaresEsfuerzoScarabaeinae, fig=true, echo=false, results=hide>>=
cols <- c("2005"=1,"2006"=2,"2008"=1,"2009"=3,"2010"=3)
plot(jmp~sfrz, scrb.rsm,log="y", xlab="Esfuerzo de muestreo", ylab="Ejemplares capturados", col=cols[scrb.rsm$yr],cex=1.9)
text(scrb.rsm$sfrz,scrb.rsm$jmp,scrb.rsm$NM, col=cols[scrb.rsm$yr], cex=.38)
lines(supsmu(scrb.rsm$sfrz,scrb.rsm$jmp,bass=1), lwd=2, col="slateblue4")
@
\end{center} 
\caption{Relación entre número de ejemplares y esfuerzo de muestreo para los muestreos de escarabajos coprófagos. Los números en los círculos se refieren al código de la transección (NM), negro: fase de calibración (2005-2008), rojo: estudio piloto en 2006, verde: muestreo a nivel nacional (2009-2010).}
\label{FIG:SFRZSCRB}
\end{figure}


\subsection{Fase 3: Primer muestreo nacional de escarabajos coprófagos}

Para la segunda edición del curso `Inventario y monitorización de la biodiversidad neotropical'' realizamos un muestreo de escarabajos a nivel nacional con un protocolo de campo ligeramente modificado. La experiencia ganada en la fase 2 permitió afinar algunos detalles del protocolo de campo.

Utilizamos entre 5 y 7 grupos de trampas y procuramos colocar un promedio de 68 a 72 trampas por transección. Decidimos colocar una mayor diversidad de cebos con una meta inicial de 60\% de cebos de heces, pero debido a las limitaciones logísticas y la disponibilidad de cebos, esta proporción fue muy variable, entre un 30\% y un 90\%. Por otro lado, los análisis de los datos previos sugirieron disminuir el periodo de colecta a tres días para disminuir los costos de muestreo, pero mantener las revisiones diarias para permitir un análisis más detallado de la probabilidad de detección y la estimación de abundancias.

<<scrbfase3, echo=false, results=hide>>=
tmp <- scrb.rsm[scrb.rsm$yr > 2008,]
mtz <- scrb.NM[scrb.NM$yr %in% c("09","10"),-(1:2)]
@

Durante el muestreo a nivel nacional se capturaron \Sexpr{sum(tmp$jmp, na.rm=T)} ejemplares en \Sexpr{round(sum(tmp$sfrz, na.rm=T),2)} horas*trampa de esfuerzo de muestreo. Esto significa una efectividad de captura promedio de \Sexpr{round(sum(tmp$sfrz, na.rm=T)/sum(tmp$jmp, na.rm=T),2)} ejemplares por horas*trampa. Se colocaron \Sexpr{sum(tmp$vst, na.rm=T)} trampas para un promedio de  \Sexpr{round(sum(tmp$sfrz, na.rm=T)/sum(tmp$vst, na.rm=T),2)} horas por trampa. Hasta la fecha se han identificado \Sexpr{sum(colSums(mtz, na.rm=T)>0)} especies/morfotipos a partir del material colectado (Tabla \ref{TAB:SCRB}).

\section{Cuantificación de sesgos geográficos y taxonómicos}

El muestreo de Escarabajos estuvo repartido en \Sexpr{luq(tds.scrb)} celdas de la CNEB, pero \Sexpr{luq(tds.scrb)-luq(slc.scrb)} celdas, ubicadas principalmente al norte del país, presentan identificaciones incompletas o parciales (Fig.~\ref{MAPA:SCB}). Comparamos los datos de NeoMapas con los datos disponibles en la literatura consultada sobre Scarabaeinae de Venezuela (Ver anexo \ref{CAP:FUENTES}).
Los muestreos de NeoMapas incluyeron \Sexpr{sum(!(tds.scrb %in% lit.scrb))} celdas no representadas en la literatura consultada, pero quedan vacíos importantes en Zulia, Lara, Falcón, gran parte de los Llanos, y el norte de Bolívar. Además de las regiones que están fuera del universo muestral que tampoco han sido estudiadas adecuadamente. Hasta la fecha \Sexpr{sum(duplicated(scrb.rsm$NM))} transecciones fueron muestreadas en dos oportunidades, y pueden servir como áreas para estudios de comparación temporal de cambios en la composición de especies. En \Sexpr{sum(duplicated(scrb.rsm$CNEB))-sum(duplicated(scrb.rsm$NM))} celdas se realizaron muestreos en más de una transección.

El esfuerzo de muestreo fue similar en la mayor parte de las transecciones, con un promedio de \Sexpr{round(mean(scrb.rsm$sfrz),1)} horas*trampa, con algunas excepciones, \Sexpr{sum(scrb.rsm$sfrz<4000)} por debajo de 4000 h*t y \Sexpr{sum(scrb.rsm$sfrz>7000)} por encima de 7000 h*t, que se deben principalmente a diferencias en diseño muestral durante la fase 1, o a transecciones con muestreos afectados por problemas logísticos. La efectividad del muestreo fue muy variable, y aparentemente está más relacionada con las condiciones ambientales que con el esfuerzo de muestreo (Fig.~\ref{FIG:SFRZSCRB}).



<<eval=false, echo=false, results=hide>>=
aggregate(colSums(scrb.OTR),list(Escarabajos[Escarabajos$cdg_especie %in% colnames(scrb.OTR),"tribu"]),sum)
table(Escarabajos[Escarabajos$cdg_especie %in% unique(scrb.BDV$cdg_taxon[!(scrb.BDV$cdg_taxon %in% scrb.BDV0$cdg_taxon)]),"trb"])
@


El \Sexpr{round(sum(mi.tt["total",c("Dltc","Cprn")])*100/mi.tt["total","total"],2)}\% de los ejemplares capturados e identificados pertenecen a las tribus Deltochilini y Coprini. La primera fue más abundante en ? y Canthonini fue la tribu dominante en ? (Tabla \ref{TAB:SCRBFAM}). Estas diferencias probablemente reflejan diferencias importantes en la composición de especies entre bioregiones, mientras que en la literatura se observa un sesgo taxonómico, con la tribu Phanaeini sobrerepresentada, y Canthonini y Onthophagini subrepresentada \citetext{Sánchez-Mercado y Ferrer-Paris, en preparación}. Probablemente los sesgos en la literatura se deban a la cantidad de especies colectadas que no han sido descritas o correctamente identificadas, y son reportadas en la literatura como morfotipos sin nombre válido. De hecho, las diferencias en los criterios de diferentes expertos impiden la comparación exacta de la composición taxonómica entre fuentes diferentes.


Los muestreos de escarabajos de NeoMapas aportan datos de distribución para muchas especies no representadas en la literatura, y posiblemente poco representadas en colecciones. Por otro lado, las identificaciones del material de NeoMapas está actualizado y organizado. En contraste, gran parte de los datos de colecciones están pendiente por ser identificado y digitalizado. 


\section{Análisis preliminar}

<<Selección datos escarabajos, echo=false, results=hide>>=
slc.09 <- scrb.rsm[scrb.rsm$sfrz>3000 & scrb.rsm$p.id>.1 & scrb.rsm$yr %in% c("2009","2010"),"NM"]
##slc.09 <- slc.09[slc.09!="15"]
slc.06 <- scrb.rsm[scrb.rsm$yr %in% "2006" & !(scrb.rsm$NM %in% slc.09),"NM"]

tmp <- rbind(
scrb.NM[scrb.NM$yr %in% c("06") & scrb.NM$NM %in% slc.06,],
scrb.NM[scrb.NM$yr %in% c("09","10") & scrb.NM$NM %in% slc.09,])

rownames(tmp) <- paste(tmp$NM,"::20",tmp$yr,sep="")
tmp <- tmp[,-(1:2)]

scrb.sfrz <- scrb.rsm[match(rownames(tmp), paste(scrb.rsm$NM,scrb.rsm$yr,sep="::")),"sfrz"]
scrb.CN <- scrb.rsm[match(rownames(tmp), paste(scrb.rsm$NM,scrb.rsm$yr,sep="::")),"CNEB"]

scrb.NM <- tmp[,colSums(tmp)>0]
scrb.NM.c <- scrb.NM/(scrb.sfrz/24)

scrb.NM.alpha <- rowSums(scrb.NM>0)
scrb.OTR.alpha <- rowSums(scrb.OTR.um>0)
scrb.cneb <- CNEB.nm[match(scrb.CN,CNEB.nm$cdg),]
scrb.OTR.cneb <- CNEB.nm[match(rownames(scrb.OTR.um),CNEB.nm$cdg),]

##rownames(scrb.NM) <- info.NM$Nombre[match(as.numeric(rownames(scrb.NM)),info.NM$NM)]
@

Debido a los cambios realizados en el diseño muestral original, y al hecho de que el material de algunas transecciones no se ha identificado completamente, decidimos limitar los análisis a un conjunto seleccionado de transecciones de los años 2006 y 2009.

\begin{figure}[htbp]
\begin{center}
<<SCRBCRE,eval=true,echo=false,results=hide,fig=true,width=6,height=6>>=
scrb.tau <- specaccum(scrb.NM[,-grep(".sp",colnames(scrb.NM))],method="exact",conditioned=FALSE,gamma="chao")
scrb.tds.tau <- specaccum(scrb.NM,method="exact",conditioned=FALSE,gamma="chao")
scrb.cor.tau <- specaccum(scrb.NM.c,method="exact",conditioned=FALSE,gamma="chao")
##scrb.OTR.tau <- specaccum(scrb.OTR,method="exact",conditioned=FALSE,gamma="chao")
scrb.OTR.tau <- specaccum(scrb.OTR.um,method="exact",conditioned=FALSE,gamma="chao")

max.scrb <- 120
##length(unique(scrb.BDV$especie[scrb.BDV$cdg_ref=="scarabnet"]))

cols <- c("grey42","grey77","pink3")
cols <- c("slateblue4","lightseagreen","pink3")
## realizamos una figura con las curvas para cada grupo
par(mar=c(4,4,2,1))

plot(scrb.OTR.tau, main="Scarabaeinae",
     xlab="", ylab="", 
     ylim=c(0,max.scrb*1.15),
     ci.type="polygon", col = cols[2], ci.col = cols[2],border=cols[2])
plot(scrb.OTR.tau,add=T,ci=0)
##plot(scrb.tds.tau,add=T,ci=0,lty=2)
plot(scrb.tds.tau,add=T,ci.type="polygon", col = 1, ci.col = cols[1], border=cols[1])
plot(scrb.tau,add=T,ci.type="line", col = 1, ci.col = cols[1],ci.lty=2)
abline(h=max.scrb,lty=3,col=2)
text(60,max.scrb+3,paste("ScarabNet:",max.scrb,"spp."),col=2,cex=.8)

@
\end{center} 
\caption{Curva de rarefacción del número de especies por unidad regional de análisis para los escarabajos de la subfamilia Scarabaeinae según los datos de NeoMapas (color azul), y los de la literatura (color verde).}
\label{FIG:SCRBCRE}
\end{figure}


Para el análisis de los datos de escarabajos coprófagos escogimos transecciones  adecuadamente identificadas y con un esfuerzo de muestreo superior a 3000 h*t. Por ello combinamos \Sexpr{luq(slc.09)} transecciones muestreadas en 2009 (\Sexpr{paste("NM",slc.09,sep="",collapse=", ")}) con \Sexpr{luq(slc.06)} transecciones muestreadas en 2006 (\Sexpr{paste("NM",slc.06,sep="",collapse=", ")}, Tabla \ref{TAB:SCRB}). Este conjunto de transecciones representa la variabilidad ambiental y biogeográfica de Venezuela, y considera los muestreos más actualizados para las regiones que fueron visitadas en más de una oportunidad. Ciertamente estos muestreos difieren en la composición de cebos utilizada. Sin embargo análisis preliminares sobre la diferencia en la efectividad de los cebos y las preferencias de las especies por tipo de cebo indican que este no es un problema tan grave para la escala de los datos que estamos analizando, en la cual predominan variables ecológicas y la composición biótica regional por encima de las diferencias de comportamiento de las especies.  

\begin{figure}[htbp]
\begin{center}
<<scrbBoxPlot, eval=true,echo=false,results=hide,fig=true,width=6,height=6>>=
cols <- c("grey42","grey77")
cols <- c("slateblue4","lightseagreen","pink3")
## realizamos una figura con las curvas para cada grupo
par(mar=c(4,4,1,1),oma=rep(0,4))

max.y <- 40
boxplot(scrb.NM.alpha~scrb.cneb$bioreg,at=c(1:6)-.25,width=rep(.1,6),xlim=c(1.6,6.47),varwidth=T,boxwex=.3,ylim=c(0,max.y),notch=F,axes=F,col = cols[1])
title(xlab="Bioregión", ylab="Número de especies por celda", line=3)
axis(2)
axis(1,1:6,rep("",6))
axis(1,seq(1,6,by=2),levels(scrb.cneb$bioreg)[seq(1,6,by=2)],line=-.4,lty=0)
axis(1,seq(2,6,by=2),levels(scrb.cneb$bioreg)[seq(2,6,by=2)],line=.4,lty=0)
boxplot(scrb.OTR.alpha~scrb.OTR.cneb$bioreg,at=c(1:6)+.25,add=T,varwidth=T,boxwex=.3,col=cols[2],notch=F,axes=F)
box()

if (any(scrb.OTR.alpha>max.y)) {
	text(as.numeric(scrb.OTR.cneb$bioreg[scrb.OTR.alpha>max.y])+.25,rep(max.y,sum(scrb.OTR.alpha>max.y)),scrb.OTR.alpha[scrb.OTR.alpha>max.y], cex=.7)
	arrows(as.numeric(scrb.OTR.cneb$bioreg[scrb.OTR.alpha>max.y])+.25, rep(max.y-4,sum(scrb.OTR.alpha>max.y)), as.numeric(scrb.OTR.cneb$bioreg[scrb.OTR.alpha>max.y])+.25, rep(max.y-1.2,sum(scrb.OTR.alpha>max.y)),length = 0.03)
}

@ 

\end{center} 
\caption{Riqueza $\alpha$ de la subfamilia Scarabaeinae para las celdas de la CNEB por cada bioregión según los datos de NeoMapas (2006-2010), y los datos de la literatura.}
\label{FIG:SCRBALPHA}
\end{figure}


Para \Sexpr{sum(scrb.cneb$cdg %in% rownames(scrb.OTR.um))} celdas se cuenta con datos de NeoMapas y de otras fuentes...


Los muestreos de Scarabaeinae de NeoMapas son más eficientes y detectan más especies que las reportadas en la literatura, incluso tomando en cuenta las diferencias en tamaño muestral (Fig.~\ref{FIG:SCRBCRE}). En este caso el conocimiento previo parece ser insuficiente y probablemente presenta sesgos en la representación de especies de géneros de taxonomía complicada o poco conocida. Al excluir los morfotipos sin nombres válidos de la lista de especie de NeoMapas, la curva de acumulación de especies baja más de un tercio, pero sigue estando por encima de la curva de la revisión de la literatura.

Los datos de los escarabajos coprófagos también muestran discrepancia entre regiones (Tab.~\ref{TAB:SCRBBRG}). Según NeoMapas, Guayana tiene una mayor riqueza de especies, seguida por Centro y Costa, y con valores considerablemente más bajos en las demás bioregiones. Sin embargo los datos de la literatura reflejan mayor riqueza en los Andes y menor riqueza en Occidente y Guayana. Los datos de la literatura parecen reflejar una distribución desigual y desproporcional de los trabajos publicados en cada bioregión. En general los valores observados y estimados por NeoMapas estuvieron por encima de los valores obtenidos en la bibliografía, especialmente los estimados a nivel nacional.

\begin{landscape}
<<TablaSppScrb, eval=true, echo=false, fig=false, results=tex>>=

rws <- unique(c(rownames(scrb.OTR.um),as.character(scrb.cneb$cdg)))
cls <- unique(c(colnames(scrb.OTR.um),gsub("\\.", " ",colnames(scrb.NM))))

mtz <- matrix(0,ncol=length(cls),nrow=length(rws),dimnames=list(rws,cls))

mtz[rownames(scrb.OTR.um),colnames(scrb.OTR.um)] <- mtz[rownames(scrb.OTR.um),colnames(scrb.OTR.um)]+scrb.OTR.um

mtz[as.character(scrb.cneb$cdg),gsub("\\.", " ",colnames(scrb.NM))] <- 
mtz[as.character(scrb.cneb$cdg),gsub("\\.", " ",colnames(scrb.NM))] + as.matrix(scrb.NM)


dts.scrb <- data.frame()
for (br in levels(CNEB.nm$bioreg)[-1]) {
	cdgs <- CNEB.nm$cdg[CNEB.nm$bioreg %in% br]
	sp1 <- specpool(mtz[rownames(mtz) %in% cdgs,])
	sp2 <- specpool(scrb.NM[scrb.cneb$cdg %in% cdgs,])
	sp3 <- specpool(scrb.OTR.um[rownames(scrb.OTR.um) %in% cdgs,])
  dts.scrb <- rbind(dts.scrb,
                    data.frame(bioreg=br,                    			n.NM=sp2$n,
                               spp.NM=sp2$Species,
                               chao.NM=sp2$chao,
                               se.NM=sp2$chao.se,
                                 C.NM=sp2$Species/sp2$chao,
              	n.GBIF=sp3$n,
                               spp.GBIF=sp3$Species,
                               chao.GBIF=sp3$chao,
                               se.GBIF=sp3$chao.se,
                                 C.GBIF=sp3$Species/sp3$chao,
              	n.total=sp1$n,
                               spp.total=sp1$Species,
                               chao.total=sp1$chao,
                               se.total=sp1$chao.se,
                                 C.total=sp1$Species/sp1$chao))

}

	br <- "total"
	cdgs <- CNEB.nm$cdg
	sp1 <- specpool(mtz[rownames(mtz) %in% cdgs,])
	sp2 <- specpool(scrb.NM[scrb.cneb$cdg %in% cdgs,])
	sp3 <- specpool(scrb.OTR.um[rownames(scrb.OTR.um) %in% cdgs,])
  dts.scrb <- rbind(dts.scrb,
                    data.frame(bioreg=br,                    			n.NM=sp2$n,
                               spp.NM=sp2$Species,
                               chao.NM=sp2$chao,
                               se.NM=sp2$chao.se,
                                 C.NM=sp2$Species/sp2$chao,
              	n.GBIF=sp3$n,
                               spp.GBIF=sp3$Species,
                               chao.GBIF=sp3$chao,
                               se.GBIF=sp3$chao.se,
                                 C.GBIF=sp3$Species/sp3$chao,
              	n.total=sp1$n,
                               spp.total=sp1$Species,
                               chao.total=sp1$chao,
                               se.total=sp1$chao.se,
                                 C.total=sp1$Species/sp1$chao))


print(xtable(dts.scrb, caption="Total de especies por bioregión ($S_{obs}$) y estimado de riqueza basados en incidencia de especies ($S_{chao}$) para los muestreos de escarabajos coprófagos (Scarabaeinae) de NeoMapas, y datos de literatura. N: Número de transecciones o celdas de la CNEB. $S_{total}$: total de especies detectadas entre ambas fuentes de datos.",label="TAB:SCRBBRG", align="l|l|ccrlc|ccrlc|ccrlc|"), caption.placement="top", include.rownames=F, include.colnames=F, add.to.row=list(pos=list(-1,5), command=c("\\hline\nBioregión & \\multicolumn{5}{c|}{NeoMapas} & \\multicolumn{5}{c|}{Literatura} & \\multicolumn{5}{c|}{Total}  \\\\\n & N & $S_{obs}$ & \\multicolumn{2}{c|}{$S_{chao} \\pm SE$} & $C_{chao}$ & N & $S_{obs}$ & \\multicolumn{2}{c|}{$S_{chao} \\pm SE$} &$C_{chao}$ & N & $S_{obs}$ & \\multicolumn{2}{c|}{$S_{chao} \\pm SE$} &$C_{chao}$ \\\\\n ","\\hline\n")), size="footnotesize")
@ 

<<VariablesDependientesScarabaeinae,echo=false, results=tex>>=
sd.scrb <- apply(log1p(scrb.NM),1,sd)
abnd.scrb <- apply(log1p(scrb.NM),1,mean)
H0.scrb <- diversity(scrb.NM, index = "shannon")
H1.scrb <- renyi(scrb.NM,scales=1)
ACE.scrb <- estimateR(scrb.NM)["S.ACE",]
## realmente, según el código de estimateR es standard deviation
se.scrb <- estimateR(scrb.NM)["se.ACE",]

Chao.scrb <- estimateR(scrb.NM)["S.chao1",]
## realmente, según el código de estimateR es standard deviation
sec.scrb <- estimateR(scrb.NM)["se.chao1",]
scrb.complet1 <-  rowSums(scrb.NM>0)/Chao.scrb


scrb.completitud <-  rowSums(scrb.NM>0)/ACE.scrb

scrb.rslt.data <- data.frame(cdg=rownames(scrb.NM),sfrz=scrb.sfrz, N.jmp=rowSums(scrb.NM), S.obs=rowSums(scrb.NM>0),log.abnd=abnd.scrb,sd.log.abnd=sd.scrb, H0=H0.scrb, ACE=ACE.scrb, se.ACE=se.scrb,C.ACE=scrb.completitud, Chao=Chao.scrb, se.Chao=sec.scrb, C.chao=scrb.complet1, cneb=scrb.cneb$cdg)

tt.OTR <- t(estimateR(scrb.OTR.um[rownames(scrb.OTR.um) %in% scrb.cneb$cdg,]))
## comparar valores de NeoMapas para estas celdas...

scrb.rslt.data <- merge(scrb.rslt.data,tt.OTR,by.x="cneb",by.y="row.names",all.x=T)




scrb.rslt.data$S.ACE <- scrb.rslt.data$se.ACE.y <- NULL

##with(scrb.rslt.data,mean(S.obs.x/S.obs.y,na.rm=T))

scrb.rslt <- xtable(scrb.rslt.data, caption="Estimados de abundancia, riqueza de especies y diversidad  para los muestreos de escarabajos coprófago de NeoMapas. $E$: esfuerzo de muestreo en horas*trampa (h*t), $N_{total}$: número total de ejemplares de Scarabaeinae, $S_{obs}$: número de especies detectadas.", label="TAB:SCRBEST", align="|ccl|cccrlcrlcrlc|crl|", digits=c(0,0,0, 0,0,0, 2,2,2, 2,2,2, 2,2,2, 0,2,2))

 ##print(scrb.rslt, caption.placement="top", include.rownames=F, include.colnames=F, add.to.row=list(pos=list(-1), command=c("\\hline\n & $E$ (h*t) & $N_{total}$ & $S_{obs}$& \\multicolumn{2}{c}{$\\log N (\\mu \\pm \\sigma)$} & $H$ & \\multicolumn{2}{c|}{ACE $\\pm$ s.e.} \\\\")), hline.after=c(-1,length(abnd.scrb)), size="footnotesize")

 print(scrb.rslt, caption.placement="top", include.rownames=F, include.colnames=F, add.to.row=list(pos=list(-1), command=c("
 \\hline\n \\multicolumn{2}{c}{} & \\multicolumn{12}{c}{NeoMapas} & \\multicolumn{3}{c}{Otras fuentes} \\\\\n
 \\hline\n \\multicolumn{2}{c}{} & $E$ (m*c) & $N_{total}$ & $S_{obs}$& \\multicolumn{2}{c}{$\\log N (\\mu \\pm \\sigma)$} & $H$ & \\multicolumn{2}{c|}{ACE $\\pm$ s.e.} & $C_{ACE}$ & \\multicolumn{2}{c|}{Chao $\\pm$ s.e.} & $C_{Chao}$ & $S_{obs}$ & \\multicolumn{2}{c|}{Chao $\\pm$ s.e.} \\\\")), hline.after=c(-1,nrow(scrb.rslt)), size="footnotesize")

 scrb.rslt.data$Complementariedad.OTR <- with(scrb.rslt.data,Cci(S.obs.y,S.chao1,se.chao1^2))
scrb.rslt.data$Complementariedad.NM <- with(scrb.rslt.data,Cci(S.obs.x,ACE,se.ACE.x^2))
write.csv(file="TablaScrbSI.csv",scrb.rslt.data)


@ 
\end{landscape}

Igualmente los valores observados de riqueza $\alpha$ por transección fueron superiores a los promedios registrados en la literatura por celda (Fig.~\ref{FIG:SCRBALPHA}). Únicamente en los Andes se encontraron celdas con listas de especies superiores al promedio de las reportadas por NeoMapas para esta bioregión.

<<>>=
with(scrb.rslt.data,mean(Chao/S.chao1,na.rm=T))
table(with(scrb.rslt.data,Chao>S.chao1))
with(scrb.rslt.data,coin::wilcoxsign_test(S.obs.x~S.obs.y))
with(mrps.rslt.data,coin::wilcoxsign_test(S.obs.x~S.obs.y))
##with(aves.rslt.data,coin::wilcoxsign_test(S.obs.x~S.obs.y))
@

Los estimados de $\mathrm{ACE}$ estuvieron un \Sexpr{round((median(ACE.scrb/rowSums(scrb.NM>0),na.rm=T)-1)*100,2)}\%  por encima de los valores observados, con un valor mínimo en \Sexpr{names(which.min(ACE.scrb))}  (\Sexpr{round(min(ACE.scrb,na.rm=T),2)}) y el máximo en \Sexpr{names(which.max(ACE.scrb))} ( \Sexpr{round(max(ACE.scrb,na.rm=T),2)}), y en  \Sexpr{names(ACE.scrb)[is.na(ACE.scrb)]} no fue posible estimarlo (Tab.~\ref{TAB:SCRBEST}). Las transecciones \Sexpr{paste(sub("NM[0-9]+ :: ","",rownames(scrb.NM)[rank(1/rowSums(scrb.NM>0))<6 & rank(1/ACE.scrb)<6 & rank(1/H0.scrb)<6]),collapse=", ")} estuvieron entre las 5 primeras en $S_{obs}$, $\mathrm{ACE}$ y $H$. Las transecciones con menores valores de $\log \sigma$ (\Sexpr{paste(sub("NM[0-9]+ :: ", "", names(sd.scrb)[rank(sd.scrb,na.last=T)<6]), collapse=", ")}) fueron aquellas con menor número de ejemplares (promedio de \Sexpr{median(rowSums(scrb.NM)[rank(sd.scrb,na.last=T)<6])}) y especies (promedio de \Sexpr{median(rowSums(scrb.NM>0)[rank(sd.scrb,na.last=T)<6])}).


<<tablaAICscrb,echo=false, eval=true, results=tex>>=

## según sugerencia de Kate
	aics.ttl <- data.frame()
	mis.vars <- c("bioreg","PC1","PC2","PC3")
	k <- length(mis.vars)
	tds.vars <- "bioreg+PC1+PC2+PC3+PC4+PC5+PC6+PC7+PC8+PC9+PC10"
aves.sfrz <- NULL
for (grp in c("scrb")) {
	mi.cneb <- get(paste(grp,"cneb",sep="."))
for (mi.vd in c("abnd","sd","H0","ACE")) {
	
	switch(mi.vd, ACE= {## usamos 1/sigma^2
		mi.wg <- 1/(get(paste("se",grp,sep="."))^2)
		mi.wg <- (get(paste(grp,"completitud",sep=".")))
	
		},
		H0={
		mi.wg <- (get(paste(grp,"sfrz",sep=".")))
		mi.wg <- (get(paste(grp,"completitud",sep=".")))
		},
		sd={
		mi.wg <- (get(paste(grp,"sfrz",sep=".")))
		mi.wg <- (get(paste(grp,"completitud",sep=".")))
		},
		abnd={
		mi.wg <- (get(paste(grp,"sfrz",sep=".")))
		mi.wg <- (get(paste(grp,"completitud",sep=".")))
		})
		
	aics <- data.frame()
	mi.lm <- lm(formula(paste(paste(mi.vd, grp, sep="."), "~", 1)),data=mi.cneb, weights=mi.wg)
	aics <- data.frame(grp=grp, vd=mi.vd, formula="~1", R2.adj=summary(mi.lm)$adj.r.squared, logLik=logLik(mi.lm)[[1]], k=mi.lm$rank+1, n=nrow(mi.lm$model), AIC=AIC(mi.lm), deltaAIC=NA, wi=NA, aic.weights=NA)			
	
	for (i in 1:k) {
		kiis <- combinations(k,i)
		for (j in 1:nrow(kiis)) {
			mi.frm <- paste(paste(mi.vd, grp, sep="."), "~", paste(mis.vars[kiis[j,]], collapse="+"))
			mi.lm <- lm(formula(mi.frm),data=mi.cneb, weights=mi.wg)
			aics <- rbind(aics, data.frame(grp=grp,vd=mi.vd, formula=paste(mis.vars[kiis[j,]], collapse="+"), R2.adj=summary(mi.lm)$adj.r.squared, logLik=logLik(mi.lm)[[1]], k=mi.lm$rank+1,n=nrow(mi.lm$model), AIC=AIC(mi.lm), deltaAIC=NA,wi=NA, aic.weights=NA))			
		}
	}
	

	aics$AICc <- aics$AIC + (2*aics$k*(aics$k+1))/(aics$n-aics$k-1)
	
	aics$deltaAIC <- aics$AICc - min(aics$AICc)
	aics$wi<-exp(1)^(-0.5*aics$deltaAIC)
	aics$aic.weights<-aics$wi/sum(aics$wi)

	aics.ttl <- rbind(aics.ttl,aics)
}
}

aics.scrb <- aics.ttl[ !is.na(aics.ttl$aic.weights), ]

print(xtable(aics.scrb[aics.scrb$aic.weights>0.1, c("vd","formula","k","n","logLik","AICc","aic.weights","R2.adj")], caption="Pesos de Akaike para todos los modelos ajustados", label="TAB:AICCSCRB", digits=c(0,0,0,0,0,2,2,3,2)), caption.placement="top", size="footnotesize", include.rownames=F)

@



El modelo con \Sexpr{(mi.f <- aics.ttl[aics.ttl$vd=="ACE" & aics.ttl$deltaAIC==0 & !is.na(aics.ttl$deltaAIC),"formula"])} explica hasta el \Sexpr{round(aics.ttl[aics.ttl$vd=="ACE" & aics.ttl$deltaAIC==0 & !is.na(aics.ttl$deltaAIC),"R2.adj"]*100)}\% de la variación en $\mathrm{ACE}$, el \Sexpr{round(aics.ttl[aics.ttl$vd=="sd" & aics.ttl$formula == mi.f,"R2.adj"]*100)}\% de la variación en $\log \sigma$, y \Sexpr{round(aics.ttl[aics.ttl$vd=="abnd" & aics.ttl$formula == mi.f,"R2.adj"]*100)}\% de la variación en $\log \mu$, y, en combinación con los otros dos componentes explica entre \Sexpr{paste(round(range(aics.ttl[aics.ttl$vd=="H0" & aics.ttl$formula %in% c("PC1+PC2","PC2","PC2+PC3"),"R2.adj"]*100)), collapse=" y ")}\% de la variación en $H$  (Tab.~\ref{TAB:AICCSCRB}).

\footnotesize
<<eval=true, echo=false, results=verbatim, fig=false>>=
d1.scrb <- vegdist(scrb.NM,"chao")
##table(scrb.cneb[,c("bioreg","est.pr")])
##adonis(mi.d1~bioreg+est.pr,scrb.cneb)
(tmp <- adonis(d1.scrb~bioreg+(PC1+PC2+PC3),scrb.cneb))
@ 
\normalsize

Las diferentes medidas de riqueza, diversidad y abundancia de los escarabajos está más relacionado con la cobertura boscosa representada por el PC2, pero la bioregión es un predictor más importante de la composición, explicando hasta un  \Sexpr{round(sum(tmp$aov.tab$R2[tmp$aov.tab[,"Pr(>F)"]<.05 & !is.na(tmp$aov.tab[,"Pr(>F)"])])*100)} \% de la variación mientras los componentes principales contribuyen con un \Sexpr{round(sum(tmp$aov.tab$R2[tmp$aov.tab[,"Pr(>F)"]>=.05 & !is.na(tmp$aov.tab[,"Pr(>F)"])])*100)} \% adicional.

Los resultados sugieren que la composición de especies está más relacionada con factores históricos o biogeográficos, pero que el número de especies, su diversidad y abundancia están más relacionadas con el tipo de hábitat muestreado, y tienden a aumentar en función de la cobertura boscosa a nivel de paisaje.

\chapter{Muestreo de Aves 2010}
\label{CAP:AVES}

 
NeoMapas Aves es el componente que se ocupa de evaluar y monitorizar la 
diversidad de aves en Venezuela. Entre 2001 y 2003 realizamos pruebas piloto para la evaluación y estandarización de los métodos de muestreo de aves. Entre marzo y abril de 2010 realizamos el primer censo de aves a nivel nacional, que contó con la participación de 21 personas que muestrearon 27 transecciones repartidas por todo el territorio nacional. Los participantes, entre estudiantes y profesionales, asistieron a un curso previo de entrenamiento en metodologías.

En el primer censo de aves a nivel nacional, NeoMapas Aves tuvo los siguientes 
objetivos: 
\begin{itemize} 
\item Realizar en un corto período de tiempo, un inventario de las especies de aves presentes en 27 localidades, que resulte representativo de la diversidad total del país. 
\item Cuantificar la abundancia relativa de las especies de aves a lo largo del territorio nacional. 
\item Realizar pruebas para lograr la estandarización de métodos, que puedan ser 
aplicadas en Venezuela y otras regiones del neotrópico en el futuro y como 
herramienta de monitorización a largo plazo. 
\item Desarrollar y fortalecer la capacidad técnica, al crear equipos de trabajo que combinen estudiantes y científicos. 
\end{itemize}

Los procedimientos y métodos llevados a cabo durante el censo nacional de aves de 2010 se presentan en el reporte técnico número NM.A1.MM01 \citep[][, accesible a través de \url{www.neomapas.org}]{NM.A1.MM01}.


\section{Protocolo de campo para la detección de aves}

Los procedimientos de censado de aves están basados principalmente en el Breeding Bird Survey de Norte América, aplicado desde hace más de 40 años  para la monitorización  de las aves de Estados Unidos y Canadá \citep[][\url{http://www.pwrc.usgs.gov/bbs/index.html}]{bystrak1981north}.

Todos los muestreos se hacen a lo largo de la carretera de la transecta o transección previamente trazada, sin alejarse del carro en ningún momento. Cada transección mide aproximadamente 40 km y está dividida en 50 puntos de muestreo, con una separación de 800 m entre sí. 
 
Existen dos tipos de muestreo. El más importante es el muestreo 1, que se realiza el primer día completo en la localidad y cubre los 50 puntos de la transecta. En este muestreo se colectan los datos esenciales de la investigación. El muestreo 2 sirve de complemento al primero y ayuda a calibrar los datos colectados en el primero mediante la estimación de la detectabilidad. El muestreo 2 se realiza el segundo y último día completo en la localidad, y es más corto y flexible, ya que cubre sólo una selección de 10 puntos. 
 
El método de muestreo en general es el de conteo de puntos (point-counts), donde 
se van registrando todas las especies vistas y escuchadas desde un punto durante un lapso de tiempo determinado (3 minutos por punto para el muestreo 1 y 9 minutos para el muestreo 2). 

El muestreo 1 debería durar de 4,5 a 6 horas, con lo cual debería concluir cerca al mediodía, si no hay perturbaciones o retrasos. El muestreo 2 se realiza de manera similar al 1, pero es más corto y más flexible con una duración aproximada de 3 a 4 horas. 
  
Paralelamente a los datos colectados durante el muestreo, el coordinador lleva 
una lista de chequeos (checklist) donde registra todas las especies de aves vistas o escuchadas, positivamente identificadas por cualquiera de los participantes, dentro o fuera de los muestreos, de día o de noche, durante todos los días de estadía en la localidad. 
 
\section{Ensayo y aplicación del protocolo de campo}

\subsection{Fase 1: ensayo y calibración de métodos}
El método fue evaluado y estandarizado en pruebas piloto entre 2001 y 2003 y 
posteriormente en un par de ensayos entre 2009 y 2010.

\subsection{Fase 2: primer muestreo nacional de aves}

En marzo de 2010 realizamos un curso de entrenamiento teórico-práctico de una semana de duración, para entrenar a los participantes en todos los métodos del trabajo de campo. Los participantes fueron agrupados en equipos de tres (3) personas (un coordinador y dos asistentes), para muestrear las aves de todas las transecciones asignadas (entre tres y cinco transecciones por grupo) en el período de trabajo de campo, con una duración aproximada de 15 días. 
 
Los coordinadores de equipo fueron expertos en identificación de aves escogidos por su experiencia en las diferentes regiones del país que les fueron asignadas. Los asistentes fueron estudiantes o profesionales, con conocimiento entre básico y avanzado de las aves del país.  
 
En cada transección se procuró realizar los dos muestreos en días consecutivos.

\section{Cuantificación de sesgos geográficos y taxonómicos}
<<Fuentes alternativas Aves, echo=false, results=hide>>=
aves.LIT <- t(spp.aves[,grep("NA[1-9]",colnames(spp.aves))])
colnames(aves.LIT) <- tolower(Aves.iocn[match(spp.aves$Latname,Aves.iocn$Latname),"altname"])

aves.LIT.um <- aves.LIT[!(rownames(aves.LIT) %in% "NA5a"),]

rownames(aves.LIT.um) <- trans.info[match(rownames(aves.LIT.um),paste("NA",trans.info$IDTransecta,sep="")),"CNEB"]

aves.GBIF <- CNEB.mtz.Aves[rownames(CNEB.mtz.Aves) %in% CNEB.nm$cdg[CNEB.nm$VEN==1],]
aves.GBIF <- aves.GBIF[,colSums(aves.GBIF)>0]
aves.GBIF.completo <- aves.GBIF
aves.GBIF <- aves.GBIF[,tolower(colnames(aves.GBIF)) %in% tolower(Aves.iocn$altname)]

aves.GBIF.um <- CNEB.mtz.Aves[rownames(CNEB.mtz.Aves) %in% CNEB.nm$cdg[CNEB.nm$UM==1],]
aves.GBIF.um <- aves.GBIF.um[,colSums(aves.GBIF.um)>0]

aves.GBIF.um <- aves.GBIF.um[,tolower(colnames(aves.GBIF.um)) %in% tolower(Aves.iocn$altname)]

tt <- data.frame(t(estimateR(aves.GBIF)))
mi.ss <- rowSums(aves.GBIF)>10 & rowSums(aves.GBIF)>rowSums(aves.GBIF>0) & !is.na(tt$se.chao1) & (tt$se.chao1)<tt$S.obs
 aves.slc <- rownames(aves.GBIF)[mi.ss]


colnames(aves.GBIF.um) <- tolower(Aves.txn[match(colnames(aves.GBIF.um),Aves.txn$spp),"altname"])

spps <- unique(c(colnames(aves.LIT.um),colnames(aves.NM), colnames(aves.GBIF.um)))

table(spps %in% colnames(aves.NM),
spps %in% colnames(aves.GBIF.um))

@


Los muestreos se aves de NeoMapas se han limitado a los ensayos y calibración de métodos y al primer muestreo a nivel nacional, por lo que abarcan un conjunto de unidades muestrales mínimo. En comparación, otras fuentes de información tienen una cobertura más extensa, en este caso, la base de datos de GBIF tiene registros para \Sexpr{ncol(aves.GBIF.um)} especies en \Sexpr{nrow(aves.GBIF.um)} celdas del universo muestral. A pesar de ello, NeoMapas aporta datos para \Sexpr{sum(!(rownames(aves.CN) %in% rownames(aves.GBIF.um)))} celdas que no han sido reportadas en la base de datos de GBIF (Fig. \ref{MAPA:AVS}). 

\begin{figure}[htbp]
\begin{center}
<<mapas,eval=true, echo=false, results=hide, fig=true>>=
## colocamos los márgenes
par(mar=c(1,0,2,0))

##Aves
##Cuadrícula con los códigos en los bordes
plot(CNEB,border=NA)
text(rep(-73.5,23),unique(CNEB@data$y),unique(CNEB@data$fila),cex=.5)
text(unique(CNEB@data$x),rep(12.4,27),unique(CNEB@data$col),cex=.5)

## Datos de GBIF como celdas sombreadas de la cuadrícula
plot(CNEB[CNEB@data$cdg %in% rownames(aves.GBIF),],add=T,col="grey83",border="grey77")

## División política
plot(vzla,border="maroon",add=T)

## mostramos las celdas muestreadas 
symbols(coordinates(CNEB[CNEB@data$cdg %in% slc.avs,]),circle=rep(1,length(slc.avs)),inches=.06,add=T,fg=1,bg=1)
##invisible(text(coordinates(CNEB[CNEB@data$cdg %in% slc.avs,]), labels=CNEB@data[CNEB@data$cdg %in% slc.avs,"cdg"], cex=0.7,col="white"))
@ 
\end{center} 
\caption[Localidades del muestreo de NeoMapas Aves 2010]{Localidades del muestreo de NeoMapas Aves 2010. Las celdas grises representan los registros de presencia de aves incluídos en una consulta a GBIF, los círculos negros representan las transecciones muestreadas por NeoMapas en 2010.}
\label{MAPA:AVS}
\end{figure}

Gráficos para calcular diferencias en composición o proporcionalidad en la representación de órdenes o familias...
Estimar disimilitud entre transectas y compararlo con disimilitud en base a la lista de especies esperadas.

\setkeys{Gin}{width=\textwidth}
\begin{figure}[tb]
\begin{center}
<<MTRZaves,eval=true, echo=false, results=hide, fig=true, width=8, height=6>>=

d1.aves <- vegdist(aves.NM,"chao")
d2.aves <- dist.binary(aves.LIT.um,method=5)## Sørensen

mx.aves <- as.matrix(d1.aves)
tmp <- as.matrix(d2.aves)
mx.aves[upper.tri(mx.aves)] <- tmp[upper.tri(tmp)]

mx.aves <- mx.aves[order(trans.info[match(rownames(aves.NM),trans.info$Nombretransecta),"Bioregión"]),order(trans.info[match(rownames(aves.NM),trans.info$Nombretransecta),"Bioregión"])]

par(mar=c(7,3,1,7),oma=c(0,0,0,0),xpd=F)
image(1:nrow(mx.aves),1:ncol(mx.aves),mx.aves, axes=F, col=c(NA,rev(brewer.pal(11,"BrBG"))), xlab="", ylab="")

abline(v=cumsum(table(trans.info[match(rownames(mx.aves),trans.info$Nombretransecta),"Bioregión"]))+.5, lty=3)
abline(h=cumsum(table(trans.info[match(rownames(mx.aves),trans.info$Nombretransecta),"Bioregión"]))+.5, lty=3)

polygon(cumsum(table(trans.info[match(rownames(mx.aves),trans.info$Nombretransecta),"Bioregión"]))[c(1,2,2,3,3,4,4,5,5,6,6,5,5,4,4,3,3,2,2,1,1)]+.5,cumsum(table(trans.info[match(rownames(mx.aves),trans.info$Nombretransecta),"Bioregión"]))[c(1,1,2,2,3,3,4,4,5,5,6,6,5,5,4,4,3,3,2,2,1)]+.5,lwd=2)

atta <- aggregate(1:ncol(mx.aves),by=list(trans.info[match(rownames(mx.aves),trans.info$Nombretransecta),"Bioregión"]),mean)$x

axis(2,atta[c(1,3,5)],levels(trans.info$Bioregión)[c(2,4,6)],line=.01,lty=0)
axis(2,atta[c(2,4)],levels(trans.info$Bioregión)[c(3,5)],line=.7,lty=0)
axis(2,atta,rep("",5))
axis(1,las=2,1:ncol(mx.aves),rownames(mx.aves),cex.axis=.5)
axis(4,las=2,1:ncol(mx.aves),rownames(mx.aves),cex.axis=.5)
text(rep(1:nrow(mx.aves),ncol(mx.aves)), rep(1:nrow(mx.aves),rep(ncol(mx.aves),ncol(mx.aves))) ,round(as.vector(mx.aves),2),cex=.5)

@
\end{center} 
\caption{Matrix de disimilitud entre las transecciones de Aves del muestreo de 2010 (disimilitud de Chao, triángulo inferior derecho), y disimilitud entre las listas de especies esperadas por transección (disimilitud de Sørensen, triángulo superior izquierdo). Las transecciones están agrupadas por bioregión.}
\label{FIG:AVESMTRZ}
\end{figure}


La vasta experiencia en el estudio de las aves de Venezuela permite ahondar en el análisis de los sesgos taxonómicos de NeoMapas, y estimar con mayor precisión el porcentaje de especies detectadas y la representación de los diversos órdenes y familias. Previo al trabajo de campo G.~A.~Rodríguez generó listas de especies esperadas o posibles para cada transección.

Calculamos la disimilitud, o distancia biótica entre transecciones utilizando los datos del muestreo 1 de NeoMapas Aves y las listas de especies esperadas, y comparamos las matrices de los estimados (Fig.~\ref{FIG:AVESMTRZ}). A pesar de utilizar dos estimadores diferentes (Chao para los datos de conteos del muestreo 1, y Sørensen para los datos de presencia/ausencia de las listas), las matrices tuvieron promedios de disimilitud similares (muestreo 1: \Sexpr{round(mean(d1.aves),3)} y listas \Sexpr{round(mean(d2.aves),3)}). Según los datos del muestreo 1 las diferencias dentro y entre regiones son menos marcadas, a excepción de las transecciones andinas y los alrededores de la Gran Sabana, que muestran mayor distancia con el resto.

<<Tabla ordenes aves, echo=false, results=tex>>=
  
aves.cneb <- CNEB.nm[match(rownames(aves.CN),CNEB.nm$cdg),]

##table(Aves.iocn$Order[match(colnames(aves.NM),Aves.iocn$Latname)])

ordo <- Aves.iocn$Order[match(colnames(aves.NM),tolower(Aves.iocn$altname))]
ordo <- paste(toupper(substring(ordo,1,1)),tolower(substring(ordo,2)),sep="")
ordo[ordo %in% 
(otros <- c('Anseriformes','Ciconiiformes','Coraciiformes', 'Galliformes',         'Gruiformes','Opisthocomiformes', 'Cuculiformes', 'Falconiformes',
 'Podicipediformes', 'Strigiformes', 'Suliformes','Tinamiformes',     'Trogoniformes'))] <- "Otros"

mi.tt <- data.frame()
for (i in unique(ordo)) {
  mi.tt <- rbind(mi.tt,i=rowSums( rowsum(aves.NM[,ordo %in% i],aves.cneb$bioreg)))
}
mi.tt <- t(mi.tt)
colnames(mi.tt) <- abbreviate(unique(ordo))
##colnames(mi.tt) <-  unique(ordo)
rownames(mi.tt) <- levels(aves.cneb$bioreg)[-1]
mi.tt <- cbind(mi.tt,total=rowSums(mi.tt))
mi.tt <- rbind(mi.tt,total=colSums(mi.tt))
mi.tt <- mi.tt[c(1,5,2,3,4,6),]
xtab <- xtable(mi.tt,digits=0,caption=paste("Número de ejemplares observados/escuchados por orden y bioregión. ",paste(abbreviate(unique(ordo)),": ",unique(ordo), " (",table(ordo)[unique(ordo)], " spp.)",
sep="", collapse="; "),". Otros=",paste(otros, collapse=", "),sep=""))

print(xtab, caption.placement="top")
@



Apróximadamente la mitad de los ejemplares contados, y más de la mitad de las especies detectadas son Passeriformes. Tres ordenes tienen pocas especies pero muchos ejemplares contados: Accipitriformes, Psittaciformes y Pelecaniformes.

\begin{figure}[htbp]
\begin{center}
<<EspecieEjemplares, fig=true, echo=false, results=hide>>=
mi.ss <- NM.m1$Especieid != 1379
njmp <- aggregate(NM.m1[mi.ss,"Ntotal"],by=list(NM.m1$IDTransecta[mi.ss]),sum)
nspp <- aggregate(NM.m1[mi.ss,"Especieid"],by=list(NM.m1$IDTransecta[mi.ss]), luq)

mi.dt <- data.frame(NM=trans.info[match(njmp$Group.1,trans.info$IDTransecta),"NM"],
njmp=njmp$x,nspp=nspp$x)

plot(nspp~njmp, mi.dt, cex=1.9,log="y", xlab="Individuos registrados", ylab="Especies detectadas")
text(mi.dt$njmp,mi.dt$nspp,mi.dt$NM,cex=.39)
lines(supsmu(mi.dt$njmp,mi.dt$nspp,bass=1), lwd=2, col="slateblue4")
@
\end{center} 
\caption{Relación entre número de ejemplares y esfuerzo de muestreo para el muestreo de aves de 2010.}
\label{FIG:SFRZAVS}
\end{figure}

Las dos transecciones con mayor número de registros tuvieron una gran cantidad de ejemplares observados a más de 100 metros (Tab. \ref{TAB:OBSAVS}). 

<<echo=false, results=tex>>=
mi.ss <- NM.m1$Especieid != 1379
rsm <- aggregate(NM.m1[mi.ss, c("Nvistos.100", "Nvistos.100.1", "Noidos", "Ntotal")], by=list(NM.m1$IDTransecta[mi.ss]),sum)

rsm <- merge(rsm, nspp)
rsm$NM <- trans.info[match(njmp$Group.1,trans.info$IDTransecta),"NM"]
rsm$CNEB <- trans.info[match(njmp$Group.1,trans.info$IDTransecta),"CNEB"]

colnames(rsm) <- c("Id", "cerca", "lejos", "oidos", "total", "especies", "NM", "CNEB")
print(xtable(rsm[,c("NM","CNEB","cerca","lejos","oidos","total","especies")], caption="Número de individuos observados (cerca: $< 100m$, lejos: $> 100m$) y escuchados, y número de especies detectadas en las transecciones de NeoMapas.", label="TAB:OBSAVS"),caption.placement="top",include.rownames=F)
@

<<echo=false, results=hide, eval=false>>=
mi.ss <- NM.m2$Especieid != 1379
rsm <- aggregate(NM.m2[mi.ss, c("Especieid")], by=list(NM.m2$IDTransecta[mi.ss],NM.m2$Lapso[mi.ss]),luq)

@

<<RqzAlfa,eval=true,echo=false, results=hide,fig=false>>=

aves.NM.alpha <- rowSums(aves.NM>0)
aves.LIT.alpha <- rowSums(aves.LIT>0)[!(rownames(aves.LIT) %in% "NA5a")]
trans.info$LIT.spp[match(names(aves.LIT.alpha),paste("NA",trans.info$IDTransecta,sep=""))] <- aves.LIT.alpha

aves.GBIF.alpha <- rowSums(aves.GBIF.um>0)

aves.cneb <- aves.lit.cneb <- CNEB.nm[match(rownames(aves.CN),CNEB.nm$cdg),]
aves.gbif.cneb <- CNEB.nm[match(rownames(aves.GBIF.um),CNEB.nm$cdg),]
@ 


\section{Análisis preliminar del muestreo 1 de NM Aves 2010}

<<TablaSppAves, eval=true, echo=false, fig=false, results=hide>>=

rws <- unique(c(rownames(aves.GBIF.um),as.character(aves.cneb$cdg)))
cls <- unique(c(colnames(aves.GBIF.um),colnames(aves.NM)))

mtz <- matrix(0,ncol=length(cls),nrow=length(rws),dimnames=list(rws,cls))


mtz[as.character(aves.cneb$cdg),colnames(aves.NM)] <- aves.NM
mtz[rownames(aves.GBIF.um),colnames(aves.GBIF.um)] <- mtz[rownames(aves.GBIF.um),colnames(aves.GBIF.um)]+aves.GBIF.um


dts.aves <- data.frame()
for (br in levels(CNEB.nm$bioreg)[-1]) {

	cdgs <- CNEB.nm$cdg[CNEB.nm$bioreg %in% br]
	sp1 <- specpool(mtz[rownames(mtz) %in% cdgs,])
	sp2 <- specpool(aves.NM[aves.cneb$cdg %in% cdgs,])
	sp3 <- specpool(aves.GBIF.um[rownames(aves.GBIF.um) %in% cdgs,])
	sp4 <- specpool(aves.LIT[trans.info$CNEB %in% cdgs,])

 ## spp.LIT <- colnames(aves.LIT.um)[colSums(aves.LIT.um[aves.lit.cneb$bioreg %in% br,])>0]

  dts.aves <- rbind(dts.aves,
                    data.frame(bioreg=br,                    			n.NM=sp2$n,
                               spp.NM=sp2$Species,
                               chao.NM=sp2$chao,
                               se.NM=sp2$chao.se,
                                 C.NM=sp2$Species/sp2$chao,
              	n.GBIF=sp3$n,
                               spp.GBIF=sp3$Species,
                               chao.GBIF=sp3$chao,
                               se.GBIF=sp3$chao.se,
                                 C.GBIF=sp3$Species/sp3$chao,
              	n.total=sp1$n,
                               spp.total=sp1$Species,
                               chao.total=sp1$chao,
                               se.total=sp1$chao.se,
                                 C.total=sp1$Species/sp1$chao,
                exp=sp4$Species))

}

	br <- "total"
	cdgs <- CNEB.nm$cdg
	sp1 <- specpool(mtz[rownames(mtz) %in% cdgs,])
	sp2 <- specpool(aves.NM[aves.cneb$cdg %in% cdgs,])
	sp3 <- specpool(aves.GBIF.um[rownames(aves.GBIF.um) %in% cdgs,])
	sp4 <- specpool(aves.LIT[trans.info$CNEB %in% cdgs,])
  dts.aves <- rbind(dts.aves,
                    data.frame(bioreg=br,                    			n.NM=sp2$n,
                               spp.NM=sp2$Species,
                               chao.NM=sp2$chao,
                               se.NM=sp2$chao.se,
                                 C.NM=sp2$Species/sp2$chao,
              	n.GBIF=sp3$n,
                               spp.GBIF=sp3$Species,
                               chao.GBIF=sp3$chao,
                               se.GBIF=sp3$chao.se,
                                 C.GBIF=sp3$Species/sp3$chao,
              	n.total=sp1$n,
                               spp.total=sp1$Species,
                               chao.total=sp1$chao,
                               se.total=sp1$chao.se,
                                 C.total=sp1$Species/sp1$chao,
                exp=sp4$Species))

sd.aves <- apply(log1p(aves.NM),1,sd)
abnd.aves <- apply(log1p(aves.NM),1,mean)
H0.aves <- diversity(aves.NM, index = "shannon")
H1.aves <- renyi(aves.NM,scales=1)
ACE.aves <- estimateR(aves.NM)["S.ACE",]
## realmente, según el código de estimateR es standard deviation
se.aves <- estimateR(aves.NM)["se.ACE",]
aves.completitud <-  rowSums(aves.NM>0)/ACE.aves

Chao.aves <- estimateR(aves.NM)["S.chao1",]
sec.aves <- estimateR(aves.NM)["se.chao1",]

aves.complet1 <-  rowSums(aves.NM>0)/Chao.aves


aves.rslt.data <- data.frame(cdg=rownames(aves.NM),N.jmp=rowSums(aves.NM), S.obs=rowSums(aves.NM>0),log.abnd=abnd.aves,sd.log.abnd=sd.aves, H0=H0.aves, ACE=ACE.aves, se.ACE=se.aves, C.ACE=aves.completitud, Chao=Chao.aves, se.Chao=sec.aves, C.chao=aves.complet1, cneb=aves.cneb$cdg)

tt.OTR <- t(estimateR(aves.GBIF[rownames(aves.GBIF) %in% aves.cneb$cdg,]))
## comparar valores de NeoMapas para estas celdas...

aves.rslt.data <- merge(aves.rslt.data,tt.OTR,by.x="cneb",by.y="row.names",all.x=T)

##with(aves.rslt.data,mean(S.obs.x/S.obs.y,na.rm=T))
##with(aves.rslt.data,coin::wilcoxsign_test(S.obs.y~S.obs.x))

##with(mrps.rslt.data,coin::wilcoxsign_test(S.obs.y~S.obs.x))

aves.rslt.data$S.ACE <- aves.rslt.data$se.ACE.y <- NULL
#$
aves.rslt.data$list <- trans.info$LIT.spp[match(aves.rslt.data$cneb,trans.info$CNEB)]

@ 


Los muestreos de aves de NeoMapas registraron menos de la mitad de las especies esperadas por bioregión, y sólo para los Andes y la Centro y Costa se obtuvieron estimados cercanos a los valores esperados (Tab.~\ref{TAB:AVSBRG}). Por su parte los totales observados en los datos de GBIF fueron ligeramente superiores a los esperados calculados en base al conocimiento previo y referencias bibliográfica seleccionadas. 

<<echo=false, results=hide>>=
tmp <- rowSums(aves.GBIF[rownames(aves.GBIF) %in% rownames(aves.LIT.um),]>0)
tmp2 <- rowSums(aves.LIT.um[match(names(tmp),rownames(aves.LIT.um)),]>0)
@

Para las Aves podemos calcular la diferencia entre los valores observados y los valores esperados en cada celda de muestreo de NeoMapas, pues contamos con listas más o menos exhaustivas de las especies esperadas para cada transección, las cuales fueron generadas por G.~A.~Rodríguez en base a conocimiento previo y una revisión de la literatura relevante. NeoMapas detectó entre \Sexpr{round(min(rowSums(aves.NM>0)/rowSums(aves.LIT.um>0))*100,2)} y \Sexpr{round(max(rowSums(aves.NM>0)/rowSums(aves.LIT.um>0))*100,2)} \% de las especies esperadas, con una media de \Sexpr{round(median(rowSums(aves.NM>0)/rowSums(aves.LIT.um>0))*100,2)} \%. GBIF tiene datos para \Sexpr{length(tmp)} de las \Sexpr{nrow(aves.LIT.um)} celdas muestreadas por NeoMapas, en \Sexpr{sum(tmp>tmp2)} celdas GBIF reportó un número de especies superior  a las consideradas inicialmente en nuestras listas, en el resto se detectó una media de \Sexpr{round(median((tmp/tmp2)[tmp<tmp2])*100,2)} \%, con valores entre el \Sexpr{round(min((tmp/tmp2)[tmp<tmp2])*100,2)} y el \Sexpr{round(max((tmp/tmp2)[tmp<tmp2])*100,2)} \%.

\begin{landscape}

<<VariablesDependientes,echo=false, results=tex>>=

print(xtable(dts.aves, caption="Total de especies por bioregión ($S_{obs}$) y estimado de riqueza basados en incidencia de especies ($S_{chao}$) para los muestreos de aves de NeoMapas, y datos de GBIF. N: Número de transecciones o celdas de la CNEB. $S_{esp}$: total de especies esperadas según la revisión de literatura previa a los muestreos.",label="TAB:AVSBRG", align="l|l|ccrlc|ccrlc|ccrlc|c|"), caption.placement="top", include.rownames=F, include.colnames=F, add.to.row=list(pos=list(-1,5), command=c("\\hline\nBioregión & \\multicolumn{5}{c|}{NeoMapas} & \\multicolumn{5}{c|}{GBIF} & \\multicolumn{5}{c|}{GBIF} \\\\\n & N & $S_{obs}$ & \\multicolumn{2}{c}{$S_{chao} \\pm SE$} & $C_{chao}$ & N & $S_{obs}$ & \\multicolumn{2}{c}{$S_{chao} \\pm SE$} & $C_{chao}$ & N & $S_{obs}$ & \\multicolumn{2}{c}{$S_{chao} \\pm SE$} & $C_{chao}$ & Lists\\\\\n ","\\hline\n")), size="small")



aves.rslt <- xtable(aves.rslt.data, caption="Estimados de abundancia, riqueza de especies y diversidad  para los muestreos de aves de NeoMapas. $N_{total}$: número total de individuos de aves detectados durante el muestreo 1, $S_{obs}$: número de especies detectadas. El esfuerzo de muestreo fue de 150 min. de observación para todas las transecciones.", label="TAB:AVSEST", align="|ccl|ccrlcrlcrlc|crl|l|", digits=c(0,0, 0,0,0, 2,2,2, 2,2,2, 2,2,2, 0,2,2,0))

##print(aves.rslt, caption.placement="top", include.rownames=T, include.colnames=F, add.to.row=list(pos=list(-1), command=c("\\hline\n & $N_{total}$ & $S_{obs}$& \\multicolumn{2}{c}{$\\log N (\\mu \\pm \\sigma)$} & $H$ & \\multicolumn{2}{c|}{ACE $\\pm$ s.e.} \\\\")), hline.after=c(-1,length(abnd.aves)), size="footnotesize")

 print(aves.rslt, caption.placement="top", include.rownames=F, include.colnames=F, add.to.row=list(pos=list(-1), command=c("
 \\hline\n \\multicolumn{2}{c}{} & \\multicolumn{11}{|c|}{NeoMapas} & \\multicolumn{3}{|c|}{Otras fuentes} \\\\\n
 \\hline\n \\multicolumn{2}{c}{} & $N_{total}$ & $S_{obs}$& \\multicolumn{2}{c}{$\\log N (\\mu \\pm \\sigma)$} & $H$ & \\multicolumn{2}{c}{ACE $\\pm$ s.e.} & $C_{ACE}$ & \\multicolumn{2}{c}{Chao $\\pm$ s.e.} & $C_{Chao}$ & $S_{obs}$ & \\multicolumn{2}{c|}{Chao $\\pm$ s.e.} & Listas\\\\")), hline.after=c(-1,nrow(aves.rslt)), size="footnotesize")

 aves.rslt.data$Complementariedad.OTR <- with(aves.rslt.data,Cci(S.obs.y,S.chao1,se.chao1^2))
aves.rslt.data$Complementariedad.NM <- with(aves.rslt.data,Cci(S.obs.x,ACE,se.ACE.x^2))
write.csv(file="TablaAvesSI.csv",aves.rslt.data)
 


@ 
\end{landscape}


Para las aves, los estimados de $\mathrm{ACE}$ estuvieron un \Sexpr{round((median(ACE.aves/rowSums(aves.NM>0),na.rm=T)-1)*100,2)}\%  por encima de los valores observados, con un valor mínimo en \Sexpr{names(which.min(ACE.aves))}  (\Sexpr{round(min(ACE.aves,na.rm=T),2)}) y el máximo en \Sexpr{names(which.max(ACE.aves))} (\Sexpr{round(max(ACE.aves,na.rm=T),2)}, Tab.~\ref{TAB:AVSEST}). Las transecciones \Sexpr{paste(sub("NM[0-9]+ :: ","",rownames(aves.NM)[rank(1/rowSums(aves.NM>0))<6 & rank(1/ACE.aves)<6 & rank(1/H0.aves)<6]),collapse=", ")} estuvieron entre las 5 primeras en $S_{obs}$, $\mathrm{ACE}$ y $H$. Las transecciones con menores valores de $\log \sigma$ (\Sexpr{paste(sub("NM[0-9]+ :: ", "", names(sd.aves)[rank(sd.aves,na.last=T)<6]), collapse=", ")}) tuvieron pocos individuos (promedio de \Sexpr{median(rowSums(aves.NM)[rank(sd.aves,na.last=T)<6])}), pero con una riqueza de especies intermedia a baja (promedio de \Sexpr{median(rowSums(aves.NM>0)[rank(sd.aves,na.last=T)<6])}).



%¿Qué tan bien está NeoMapas Aves comparado con el total?: %\Sexpr{paste(dts.aves$bioreg,"=",round(100*dts.aves$spp.NM/dts.aves$total,2),collapse=", ")}.

%¿Qué tan bien está NeoMapas Mariposas comparado con el total?: %\Sexpr{paste(dts.mrps$bioreg,"=",round(100*dts.mrps$spp.NM/dts.mrps$total,2),collapse=", ")}.

%¿Qué tan bien está NeoMapas Escarabajos comparado con el total?: %\Sexpr{paste(dts.scrb$bioreg,"=",round(100*dts.scrb$spp.NM/dts.scrb$total,2),collapse=", ")}.

<<tablaAICaves, echo=false, eval=true, results=tex>>=

## según sugerencia de Kate
	aics.ttl <- data.frame()
	mis.vars <- c("bioreg","PC1","PC2","PC3")
	k <- length(mis.vars)
	tds.vars <- "bioreg+PC1+PC2+PC3+PC4+PC5+PC6+PC7+PC8+PC9+PC10"
aves.sfrz <- NULL
for (grp in c("aves")) {
	mi.cneb <- get(paste(grp,"cneb",sep="."))
for (mi.vd in c("sd","H0","ACE")) {
	
	switch(mi.vd, ACE= {## usamos 1/sigma^2
		mi.wg <- 1/(get(paste("se",grp,sep="."))^2)
		mi.wg <- (get(paste(grp,"completitud",sep=".")))
	
		},
		H0={
		mi.wg <- NULL
		mi.wg <- (get(paste(grp,"completitud",sep=".")))
		},
		sd={
		mi.wg <- NULL
		mi.wg <- (get(paste(grp,"completitud",sep=".")))
	
		})
		
	aics <- data.frame()
	mi.lm <- lm(formula(paste(paste(mi.vd, grp, sep="."), "~", 1)),data=mi.cneb, weights=mi.wg)
	aics <- data.frame(grp=grp, vd=mi.vd, formula="~1", R2.adj=summary(mi.lm)$adj.r.squared, logLik=logLik(mi.lm)[[1]], k=mi.lm$rank+1, n=nrow(mi.lm$model), AIC=AIC(mi.lm), deltaAIC=NA, wi=NA, aic.weights=NA)			
	
	for (i in 1:k) {
		kiis <- combinations(k,i)
		for (j in 1:nrow(kiis)) {
			mi.frm <- paste(paste(mi.vd, grp, sep="."), "~", paste(mis.vars[kiis[j,]], collapse="+"))
			mi.lm <- lm(formula(mi.frm),data=mi.cneb, weights=mi.wg)
			aics <- rbind(aics, data.frame(grp=grp,vd=mi.vd, formula=paste(mis.vars[kiis[j,]], collapse="+"), R2.adj=summary(mi.lm)$adj.r.squared, logLik=logLik(mi.lm)[[1]], k=mi.lm$rank+1,n=nrow(mi.lm$model), AIC=AIC(mi.lm), deltaAIC=NA,wi=NA, aic.weights=NA))			
		}
	}
	

	aics$AICc <- aics$AIC + (2*aics$k*(aics$k+1))/(aics$n-aics$k-1)
	
	aics$deltaAIC <- aics$AICc - min(aics$AICc)
	aics$wi<-exp(1)^(-0.5*aics$deltaAIC)
	aics$aic.weights<-aics$wi/sum(aics$wi)

	aics.ttl <- rbind(aics.ttl,aics)
}
}

aics.aves <- aics.ttl[ !is.na(aics.ttl$aic.weights), ]
print(xtable(aics.aves[aics.aves$aic.weights>0.1 , c("vd","formula","k","n","logLik","AICc","aic.weights","R2.adj")], caption="Pesos de Akaike para todos los modelos ajustados", label="TAB:AICCAVS", digits=c(0,0,0,0,0,2,2,3,2)), caption.placement="top", size="footnotesize", include.rownames=F)

@

El modelo con \Sexpr{aics.ttl[aics.ttl$vd=="ACE" & aics.ttl$deltaAIC==0 & !is.na(aics.ttl$deltaAIC),"formula"]} explica hasta el \Sexpr{round(aics.ttl[aics.ttl$vd=="ACE" & aics.ttl$deltaAIC==0 & !is.na(aics.ttl$deltaAIC),"R2.adj"]*100)}\% de la variación en $\mathrm{ACE}$, y el modelo con \Sexpr{aics.ttl[aics.ttl$vd=="sd" & aics.ttl$deltaAIC==0 & !is.na(aics.ttl$deltaAIC),"formula"]} explica hasta el \Sexpr{round(aics.ttl[aics.ttl$vd=="sd" & aics.ttl$deltaAIC==0 & !is.na(aics.ttl$deltaAIC),"R2.adj"]*100)}\% de la variación en $\log \sigma$, pero ninguna de las variables consideradas realizó un aporte significativo para explicar la variación en $H$ (Tab.~\ref{TAB:AICCMRPS}). 

Para ver cuales variables explican mejor las diferencias en composición podemos hacer un análisis de MANOVA permutacional (adonis).

\footnotesize
<<eval=true, echo=false, results=verbatim, fig=false>>=
d1.aves <- vegdist(aves.NM,"chao")
(tmp <- adonis(d1.aves~bioreg+(PC1+PC2+PC3),aves.cneb))
@ 
\normalsize

El \Sexpr{round(sum(tmp$aov.tab$R2[tmp$aov.tab[,"Pr(>F)"]<.05 & !is.na(tmp$aov.tab[,"Pr(>F)"])])*100)} \% de la variación en la composición es explicado por la bioregión y PC1.


\chapter{Resultados generales y discusión}

Nos planteamos dos preguntas principales: 1) ¿cómo se compara la información generada por NeoMapas con el conocimiento existente sobre la riqueza de especie de los taxones seleccionados y a diferentes escalas geográficas?, y 2) ¿de que manera puede explicarse la composición y diversidad de especies por los patrones de diversidad ambiental?.


Para esto vamos a examinar un subconjunto de los datos obtenidos por NeoMapas. En el caso de las mariposas, tal y como vimos en el capítulo \ref{CAP:MRPS} la identificación es un problema que no está completamente resuelto. Existe una gran cantidad de material por revisar, preparar e identificar. Por ello nos concentramos en el análisis de los datos de los muestreos de 2006 de la familia Pieridae. Este material está identificado en más de un 90\% y es por ello idóneo para los análisis que presentamos a continuación. La familia Pieridae es una de las mejor estudiadas y conocidas en Venezuela y está representada por unas 117 especies \citep{Vil00,Par08}.


Para las aves usamos los datos del muestreo 1 de todas transecciones visitadas en 2010. 


\section{Comparación de patrones de riqueza}

Comparamos estimados de riqueza basados en los datos de los muestreos de NeoMapas con los obtenidos a partir de fuentes alternativas (ver Apéndice \ref{CAP:FUENTES}), a la escala del universo muestral y de las bioregiones utilizadas en el diseño muestral. 



<<eval=true,echo=false,results=hide,fig=false>>=
## solo las especies con nombre

aves.tau <- specaccum(aves.NM,method="exact",conditioned=FALSE,gamma="chao")
aves.lit.tau <- specaccum(aves.LIT.um,method="exact",conditioned=FALSE,gamma="chao")
aves.gbif <- specaccum(aves.GBIF.um,method="exact",conditioned=FALSE,gamma="chao")
  
max.aves <- 1383

@ 



\subsection{A nivel nacional}

A nivel nacional calculamos curvas de acumulación de especies a partir de matrices de especies por localidad, $\mathbf{S}$, en las que cada celda representa el número de ejemplares capturados o detectados por transección (NeoMapas), o el número de registros únicos de una especie por cada celda de la CNEB (otras fuentes). Usamos el método de momentos con un estimado incondicional de la desviación estandard para calcular el promedio y los intervalos de confianza de la curva de acumulación de especies \citep[Fig.~\ref{FIG:CRE},][]{CMC04}.

Se observan dos escenarios diferentes: para Pieridae y Aves la curva de NeoMapas no alcanza un inventario completo de las especies reportadas para el país, y está por debajo de las curvas de las fuentes alternativas de información; para Scarabaeinae, la curva es mayor que la curva de las otras fuentes de información y que el número de especies reportadas en el país según \citep{scarabnet}. 

En el caso de la familia Pieridae y las Aves se puede considerar que las fuentes alternativas son más completas y eficientes, y la diferencia entre las curvas refleja probablemente problemas de detectabilidad de NeoMapas, relacionados con el esfuerzo total de muestreo: Los datos de NeoMapas provienen de una única temporada de muestreo, mientras los datos de otras fuentes reflejan varias décadas de colecta en campo.

En el caso de los escarabajos coprófagos, la situación es diferente. Los muestreos de NeoMapas son más eficientes y detectan más especies que las reportadas en la literatura para un tamaño muestral similar. En este caso el conocimiento previo parece ser insuficiente y probablemente presenta sesgos en la representación de especies de Géneros de taxonomía complicada o poco conocida. Al excluir los morfotipos sin nombres válidos de la lista de especie de NeoMapas, la curva de acumulación de especies baja más de un tercio, pero sigue estando por encima de la curva de la revisión de la literatura.

\subsection{Por bioregiones}

Los valores regionales de riqueza, obtenidos al agrupar las celdas por bioregión y sumar el número de especies distintas, se presentan en las tablas \ref{TAB:MRPSBRG}, \ref{TAB:SCRBBRG} y \ref{TAB:AVSBRG}. Además calculamos el estimado de riqueza regional de Chao basados en la incidencia o prevalencia de las especies en las celdas de cada bioregión \citep{Cal.05}. Para cada grupo los resultados regionales fueron muy distintos. 




Representamos los valores medios del número de especies por celda / transección  para cada bioregión mediante diagramas de cajas en la figura \ref{FIG:ALPHA}. Para todos los grupos los valores medios de NeoMapas estuvieron por encima de los valores calculados con otras fuentes de datos, y para Pieridae y Aves presentaron también una menor dispersión. Los resultados sugieren que NeoMapas ofrece valores menos sesgados de la riqueza local (riqueza $\alpha$) para cada una de las bioregiones. Sin embargo el número total de especies detectadas es considerado un estimador \emph{naïve} de la riqueza, que no toma en cuenta la probabilidad de detección. 

Los resultados de $H$, $\mathrm{ACE}$ y $\log \sigma$ para cada grupo taxonómico se muestran en las tablas \ref{TAB:MRPSEST}, \ref{TAB:SCRBEST} y \ref{TAB:AVSEST}. 





\appendix
\chapter{Fuentes de información alternativas para la comparación de patrones}
\label{CAP:FUENTES}

Para cada uno de los grupos de trabajo buscamos información existente en tres fuentes de datos: digitalización y georeferenciación de registros reportados en la literatura disponible, datos de colecciones biológicas internacionales accesibles a traves de portales de datos de biodiversidad, y datos digitalizados y georeferenciados de colecciones biológicas nacionales. 

\section{Mariposas}

Para el caso de las mariposas los registros en bases de datos internacionales fueron escasos. Nos concentramos principalmente en GBIF\footnote{Global Biodiversity Information Facility, \url{http://data.gbif.org}, consultado en Abril de 2011} encontramos \Sexpr{nrow(GBIF.Lepidoptera[GBIF.Lepidoptera$cneb %in% CNEB.nm$cdg[CNEB.nm$VEN==1],])} registros georeferenciados de Lepidoptera para Venezuela, los cuales corresponden a \Sexpr{luq(GBIF.Lepidoptera[GBIF.Lepidoptera$cneb %in% CNEB.nm$cdg[CNEB.nm$VEN==1],"taxonname"])} nombres taxonómicos (incluyendo especies, subespecies y morfotipos sin identificar). Estos datos son escasos para un grupo tan rico en especies, que consta con más de 100 familias. Entre las familias de mariposas diurnas, la familia Pieridae estuvo mejor representada que el resto con \Sexpr{nrow(GBIF.Pieridae[GBIF.Pieridae$cneb %in% CNEB.nm$cdg[CNEB.nm$VEN==1],])} registros de \Sexpr{luq(GBIF.Pieridae[GBIF.Pieridae$cneb %in% CNEB.nm$cdg[CNEB.nm$VEN==1],"taxonname"])} taxones. Sin embargo decidimos descartar estos datos por inconsistencias en la nomenclatura utilizada, que pueden atribuirse a errores de identificación, desactualización de la nomenclatura, o errores de georeferenciación y para los cuales no hay una solución sencilla.

<<eval=true, echo=false, results=hide>>=
bib1 <- mrps.BDV[substr(mrps.BDV$cdg,0,3) %in% "097",]
bib0 <- mrps.BDV0[substr(mrps.BDV0$cdg,0,3) %in% "097",]
@

Iniciamos la revisión de literatura sobre mariposas de Venezuela desde 2008, y hasta la fecha hemos incluido \Sexpr{luq(mrps.BDV$cdg_ref)} publicaciones, incluyendo \Sexpr{luq(mrps.BDV0$cdg_ref)} artículos con \Sexpr{nrow(mrps.BDV0)} registros georeferenciados de \Sexpr{luq(mrps.BDV0$cdg)} taxones. Para el caso de la familia Pieridae, encontramos \Sexpr{luq(bib1$cdg_ref)} referencias con  \Sexpr{nrow(bib1[grep("^097-",bib1$cdg),])} registros 
de \Sexpr{luq(bib1$cdg[grep("^097-",bib1$cdg)])} taxones, con \Sexpr{nrow(bib0[grep("^097-",bib0$cdg),])} registros georeferenciados de \Sexpr{luq(bib0$cdg[grep("^097-",bib0$cdg)])} taxones.

En cuanto a las colecciones nacionales, nos enfocamos exclusivamente en los datos obtenidos para la familia Pieridae y utilizados en un trabajo previo \citep{Par08}. Estos datos incluyen \Sexpr{sum(jmp.Museos$fuente=="MIZA")} registros digitalizados de la colección del MIZA, algunos de los cuales habían sido publicados en un catálogo electrónico \citep{MIZA}, y ya se encuentran  incluídos en la revisión de la literatura. Otras dos colecciones fueron visitadas y digitalizadas por el autor, obteniendo \Sexpr{sum(jmp.Museos$fuente=="MALUZ")} registros de la colección del Museo de Agronomía de La Universidad del Zulia, y \Sexpr{sum(jmp.Museos$fuente=="MJMO")} registros del Museo Entomológico Dr. J. M. Osorio, Universidad Católica Lisandro Alvarado, para un total de \Sexpr{nrow(jmp.Museos)} registros de ejemplares colectados entre 1940 y 2008, estos datos se reducen a \Sexpr{nrow(unique(jmp.Museos))} registros después de remover los duplicados 

\begin{refsection}
{\small
\begin{longtable}{cp{6cm}p{6cm}p{3cm}}
\caption{Referencias consultadas en la revisión de literatura sobre mariposas de Venezuela} \\ 
  \hline\endhead
\hline\endlastfoot
\hline
\multicolumn{4}{l}{Continúa en la página siguiente}\\
\endfoot
 \hline
 & Especies citadas & Referencia &  Celdas referenciadas \\ 
\hline
<<Bibliografía Mariposas, echo=false, results=tex>>=
kk <-1
tmp <- Mariposas[Mariposas$scdg %in% "a" & Mariposas$ecdg %in% unique(bib1$cdg),]
for (j in 1:nrow(tmp)){
	nns <- paste("\\textit{",tmp$gen[j]," ",tmp$esp[j],"}",sep="")	
	ccs <- unique(bib0$cneb[bib0$cdg %in% tmp$ecdg[j]])
	ccs <- ccs[!is.na(ccs)]
	ccs <- paste(ccs[order(ccs)],collapse="; ")
	tts <- paste("\\citet{",paste(unique(bib1$cdg_ref[bib1$cdg %in% tmp$ecdg[j]]), collapse=","),"}",sep="")
	cat(paste("{\\footnotesize ", kk,"} & {\\small ",nns," & {\\footnotesize ",tts,"} & {\\small ",ccs,"} \\\\" ,sep=""))
	kk <- kk+1
}

@
  \hline
\label{TAB:REFMRPS}
\end{longtable}
}
\end{refsection}

Combinando los datos de la revisión de la literatura y la digitalización de colecciones biológicas tenemos \Sexpr{nrow(unique(mrps.otrs))} registros de \Sexpr{luq(mrps.otrs$especie)} taxones en \Sexpr{ luq(mrps.otrs$cneb)} celdas de la CNEB. Las comparaciones se basaron en  \Sexpr{nrow(unique(mrps.otrs[mrps.otrs$cneb %in% CNEB.nm[CNEB.nm$UM==1,"cdg"],]))} registros de \Sexpr{luq(mrps.otrs$especie[mrps.otrs$cneb %in% CNEB.nm[CNEB.nm$UM==1,"cdg"]])} taxones en \Sexpr{ luq(mrps.otrs$cneb[mrps.otrs$cneb %in% CNEB.nm[CNEB.nm$UM==1,"cdg"]])} celdas del universo muestral utilizado por NeoMapas.

\section{Escarabajos coprófagos}

Para la fecha, existen muy pocos registros de Scarabaeinae en la base de datos de GBIF. Encontramos \Sexpr{nrow(GBIF.Scarabaeidae[GBIF.Scarabaeidae$cneb %in% CNEB.nm$cdg[CNEB.nm$VEN==1],])} registros georeferenciados de Scarabaeidae para Venezuela, los cuales corresponden a \Sexpr{luq(GBIF.Scarabaeidae[GBIF.Scarabaeidae$cneb %in% CNEB.nm$cdg[CNEB.nm$VEN==1],"taxonname"])} nombres taxonómicos (incluyendo especies, subespecies y morfotipos sin identificar). Debido al escaso número de registros de la subfamilia Scarabaeinae, decidimos descartar esta fuente de datos.

Empezamos la revisión de literatura sobre escarabajos coprófagos de Venezuela igualmente en 2008, y hasta la fecha hemos incluido \Sexpr{luq(scrb.BDV$cdg_ref)} publicaciones con \Sexpr{nrow(scrb.BDV)} registros, incluyendo \Sexpr{luq(scrb.BDV0$cdg_ref)} artículos con \Sexpr{nrow(scrb.BDV0)} registros georeferenciados de \Sexpr{luq(scrb.BDV0$ecdg)} taxones (\Sexpr{nrow(unique(scrb.BDV0))} registros únicos). Estos datos están resumidos en la Tabla \ref{TAB:REFSCRB}.  \Sexpr{nrow(scrb.BDV0[scrb.BDV0$cneb %in% CNEB.nm[CNEB.nm$UM==1,"cdg"],])} registros georeferenciados de \Sexpr{luq(scrb.BDV0$ecdg[scrb.BDV0$cneb %in% CNEB.nm[CNEB.nm$UM==1,"cdg"]])} taxones (\Sexpr{nrow(unique(scrb.BDV0[scrb.BDV0$cneb %in% CNEB.nm[CNEB.nm$UM==1,"cdg"],]))} registros únicos) se encuentran dentro del universo muestral de NeoMapas y fueron utilizados como fuente alternativa para realizar comparaciones con los datos de escarabajos de NeoMapas.

\begin{refsection}
{\small
\begin{longtable}{cp{6cm}p{6cm}p{3cm}}
\caption{Lista de especies citadas en la revisión de literatura sobre escarabajos coprófagos de Venezuela} \\ 
  \hline\endhead
\hline\endlastfoot
\hline
\multicolumn{4}{l}{Continúa en la página siguiente}\\
\endfoot
 \hline
 & Especies citadas & Referencia &  Celdas referenciadas \\ 
\hline
<<Bibliografía Escarabajos, echo=false, results=tex>>=
kk <-1
tmp <- Escarabajos[Escarabajos$cdg_especie %in% unique(scrb.BDV$ecdg),]
for (j in 1:nrow(tmp)){
	nns <- paste("\\textit{",tmp$gen[j]," ",tmp$epiteto[j],"}",sep="")	
	ccs <- unique(scrb.BDV0$cneb[scrb.BDV0$ecdg %in% tmp$cdg_especie[j]])
	ccs <- ccs[!is.na(ccs)]
	ccs <- paste(ccs[order(ccs)],collapse="; ")
	tts <- paste("\\citet{",paste(unique(scrb.BDV$cdg_ref[scrb.BDV$ecdg %in% tmp$cdg_especie[j]]), collapse=","),"}",sep="")
	cat(paste("{\\footnotesize ", kk,"} & {\\small ",nns," & {\\footnotesize ",tts,"} & {\\small ",ccs,"} \\\\" ,sep=""))
	kk <- kk+1
}
@
  \hline
\label{TAB:REFSCRB}
\end{longtable}
}
\end{refsection}

Los registros de colecciones nacionales presentaron problemas de identificaciones desactualizadas o incompletas. En 2008 realizamos una visita inicial a la colección del MIZA junto con Ángel Solís para la identificación y digitalización del material presente, pero hasta la fecha no hemos podido completar este trabajo. Por ello no podemos utilizar esta fuente de información en este momento. 

\section{Aves}

Para el caso de las aves las colecciones nacionales y la bibliografía publicada constituyen excelentes fuentes de datos sobre la diversidad de este grupo taxonómico. Varias colecciones nacionales han digitalizados sus registros y catálogos, esperamos establecer vínculos de colaboración con estas instituciones para análisis futuros. Igualmente existe una bibliografía muy completa sobre la distribución de aves en Venezuela, pero no se le ha dado un tratamiento de revisión sistemática para extraer datos de distribución como ha sido el caso para mariposas y escarabajos coprófagos. Sin embargo, como parte del trabajo preparatorio de NeoMapas Aves, compilamos listas de especies esperadas para cada una de las transecciones visitadas a partir de las referencias más importantes de cada zona \citep{Sanz:2010vn, Goodwin:1992lr, Lentino:1991uq, Rodriguez:2000kx, Sharpe:1997fj, Hilty2003, Ascanio:2005yq}.

Las comparaciones las basamos exclusivamente en los registros de Aves presentes en la base de datos de GBIF. Encontramos \Sexpr{nrow(GBIF.Aves[GBIF.Aves$cneb %in% CNEB.nm$cdg[CNEB.nm$VEN==1],])} registros georeferenciados de Aves para Venezuela, los cuales corresponden a \Sexpr{luq(GBIF.Aves[GBIF.Aves$cneb %in% CNEB.nm$cdg[CNEB.nm$VEN==1],"taxonname"])} nombres taxonómicos (incluyendo especies, subespecies y morfotipos sin identificar). Validamos estos nombres con la lista taxonómica de la IOC\citep{Gill:qy}, y concluimos con 
\Sexpr{sum(aves.GBIF.completo)} registros de \Sexpr{ncol(aves.GBIF.completo)} especies, pero eliminamos \Sexpr{sum(!(tolower(colnames(aves.GBIF.completo)) %in% tolower(Aves.iocn$altname)))} especies con reportes dudosos, y nos quedamos con \Sexpr{sum(aves.GBIF)} registros de \Sexpr{ncol(aves.GBIF)} especies. Utilizamos \Sexpr{sum(aves.GBIF[rownames(aves.GBIF) %in% CNEB.nm[CNEB.nm$UM==1,"cdg"],])} registros de \Sexpr{sum(colSums(aves.GBIF[rownames(aves.GBIF) %in% CNEB.nm[CNEB.nm$UM==1,"cdg"],])>0)}

\printbibliography[section=1, title=Referencias sobre pieridae de Venezuela, heading=subbibliography] 
\printbibliography[section=2, title=Referencias sobre scarabaeinae de Venezuela, heading=subbibliography] 

\chapter{Detalles de los métodos de análisis}

\section{Medidas de riqueza, diversidad y abundancia relativa}

Utilizamos los datos de frecuencia o conteos de NeoMapas para estimar la riqueza, diversidad, composición y abundancia relativa de las transecciones muestreadas por NeoMapas. Calculamos (1) un estimador de riqueza basado en abundancia relativa de las especies ($\mathrm{ACE}$, Abundance-base Coverage Estimation; Colwell and Coddington 1994), (2) el índice de diversidad de Shannon-Weaver ($H$) (Luoto, Virkkala et al. 2004) , y (3) la desviación estandard del logaritmo de los conteos, $\log \sigma$, como un estimador de la equidad en la distribución de abundancias. Los cálculos se basaron en la matriz de especies por transección descrita anteriormente  ($\mathbf{S}$), utilizando el número de individuos como una medida de la abundancia relativa en cada transección.

\section{Composición de especies}

Realizamos un análisis de composición basado en medidas de distancia biótica o disimilitud. Primero calculamos los índices de $D_{\mathrm{jaccard}}$, $D_{\mathrm{mountford}}$, y $D_{\mathrm{chao}}$  aplicados a cada par de fila de la matriz $\mathbf{S}$ para cada uno de los grupos taxonómicos \citep{Cal.05, LL98,Wolda81}. A las matrices resultantes, $\mathbf{D}$, les aplicamos un algoritmo de clasificación jerárquica por aglomeración y calculamos el coeficiente de aglomeración de la clasificación obtenida ($c_{ag}$). El coeficiente de aglomeración se basa en la relación entre la disimilitud de cada uno de los pasos del algoritmo y la disimilitud del paso final y por tanto es una medida de la estructura de la clasificación obtenida. Valores de $c_{ag}$ cercanos a 1 indican mayor estructura y valores cercanos a 1 indican menor estructura.

<<Composicion, eval=true, echo=false, fig=false,results=tex>>=
dts <- c()
mtds <- c("mountford","jaccard","chao")
for (mtd in mtds) {
  mi.d0 <- vegdist(mrps.NM,mtd)
  mi.d1 <- vegdist(scrb.NM,mtd)
  mi.d2 <- vegdist(aves.NM,mtd)
  mi.h0 <- agnes(mi.d0)
  mi.h1 <- agnes(mi.d1)
  mi.h2 <- agnes(mi.d2)
  dts <- c(dts,mi.h0$ac,mi.h1$ac,mi.h2$ac)
}

xtable(matrix(dts,ncol=3,
       dimnames=list(c("Pieridae","Scarabaeinae","Aves"),
         mtds)),
       caption="Coeficiente de aglomeración según un algoritmo de aglomeración jerárquica (agnes) para tres medidas de disimilitud biótica y los tres grupos de estudio de NeoMapas.")

@ 

Los resultados indican que las matrices construidas con el índice de \emph{chao} tienen mayor estructura que las matrices construidas con los otros índices. Por otro lado la matriz de distancias basadas en los datos de las Piérides están más estructuradas que las de los otros grupos.

La disimilitud biótica es una medida de diversidad o riqueza $\beta$ entre transecciones.




\section{Correlación de la diversidad con variables ambientales y biogeográficas}
\subsection{Modelos lineales}

Posteriormente analizamos la relación entre las variables ambientales y biogeográficas y diferentes componentes de la diversidad de especies entre transectas (abundancia, riqueza, diversidad y composición). Ajustamos una serie de modelos lineales para examinar potenciales predictores de riqueza ($\mathrm{ACE}$, $H$, $\log \sigma$) utilizando una matriz de variables por transección, $\mathbf{E}$. Utilizamos modelos con todas las posibles combinaciones de los scores de los tres primeros componentes principales ($\mathrm{PC1}$, $\mathrm{PC2}$ y $\mathrm{PC3}$) para cada celda, y las bioregiones ($\mathrm{BIOREG}$) como variable categorica. El modelo completo fue de la forma $y = \mathrm{PC1} + \mathrm{PC2} + \mathrm{PC3} + \mathrm{BIOREG}$, donde $y$ es la variable de interés. Ajustamos los modelos por medio de mínimos cuadrados ponderados, utilizando el esfuerzo de muestreo como estimado del peso de cada observación, excepto para el modelo de $\mathrm{ACE}$, en el que utilizamos el inverso de la varianza de los estimados \citep[$1/\sigma^2$][]{Carroll:1988ys}. Posteriormente calculamos la versión corregida del Criterio de Información de Akaike y los pesos de Akaike de cada modelo \citep[AICc, ][]{BA02b}.

\subsection{Análisis de composición}

Posteriormente aplicamos un análisis permutacional y multivariado de la varianza (PMANOVA) a la matriz $\mathbf{D}$ para evaluar la contribución de las variables ambientales y las bioregiones en la matriz $\mathbf{E}$ para explicar la composición de especies. Ajustamos un modelo lineal sin interacciones. PMANOVA es un análogo no paramétrico de MANOVA y describe la forma en que la variación en una matriz de distancia o disimilitud multivariada puede ser atribuida a diferentes tratamientos experimentales o covariables no controladas \citep{}(Anderson 2001; McArdle and Anderson 2001). Este método se basa en matrices de distancia en vez de mínimos cuadrados, y la significancia de los términos del modelo es aproximada por pseudo-tests de F basados en permutaciones de la matriz de datos originales (McArdle and Anderson 2001).


\chapter{Figuras y tablas para las publicaciones}


<<ManuscritoMapa1,eval=true,echo=false,results=hide,fig=true,width=9,height=7>>=
##plot(vegnsn)
##polygon(c(750000, 950000,950000,750000),c(390000,390000,400000,400000))
##polygon(c(750000, 850000,850000,750000),c(390000,390000,400000,400000),col=1)
##text(c(750000,850000,950000),c(420000,420000,420000),c("0","100","200"),cex=.5)
##text(c(850000),c(370000),c("km"),cex=.5)

xy1 <- data.frame(x=c(1725000, 1925000, 1925000, 1725000), y=c(290000, 290000, 300000, 300000))
coordinates(xy1) <- c("x","y")
proj4string(xy1)<- vegnsn@proj4string

xy2 <- data.frame(x=c(1725000, 1825000, 1825000, 1725000), y=c(290000, 290000, 300000, 300000))
coordinates(xy2) <- c("x","y")
proj4string(xy2)<- vegnsn@proj4string

xy3 <- data.frame(x=c(1725000,1825000,1925000,1825000),y=c(320000,320000,320000,270000))
coordinates(xy3) <- c("x","y")
proj4string(xy3)<- vegnsn@proj4string

ll1 <- rgdal::spTransform(xy1,vzla@proj4string)
ll2 <- rgdal::spTransform(xy2,vzla@proj4string)
ll3 <- rgdal::spTransform(xy3,vzla@proj4string)

##op <- par(fig=c(0.20,1,0,1),xpd=F,mar=c(0.1,0.1,0.1,0.1))
op <- par(fig=c(0,1,0,1),xpd=F,mar=c(0.1,0.1,0.1,0.1))

mi.ds <- c(0,30,70,20,35,40)
mi.ag <- c(0,45,135,135,45,135)
mi.cl <- c(0,"grey36","grey56","grey46","grey56","grey46")
plot(vzla,col=NA,border=NA,ylim=c(0,13))
plot(CNEB[CNEB@data$cdg %in% VBG$cdg[VBG$vzla>0],],border="grey77",add=T)
text(rep(-73.5,23),unique(CNEB@data$y),unique(CNEB@data$fila),cex=.5)
text(unique(CNEB@data$x),rep(12.4,27),unique(CNEB@data$col),cex=.5)
br <- CNEB.nm$bioreg[order(CNEB.nm$row,CNEB.nm$col)]
br[!(CNEB.nm$cdg[order(CNEB.nm$row,CNEB.nm$col)] %in% um)] <- "Otro"
plot(CNEB,density=mi.ds[br],
     border=mi.cl[br],
     angle=mi.ag[br],col=mi.cl[br],add=T)
## División política
plot(vzla,border=1,add=T)
plot(vzla[vzla@data$ID %in% 36,],add=T,border=1,col=NA)

polygon(coordinates(ll1))
polygon(coordinates(ll2),col=1)
text(coordinates(ll3),c("0","100","200","km"),cex=.9)
text(coordinates(ll3)[2,],"km",cex=.8)

xs <- seq(-72,-60,by=2)
ys <- rep(0.5,length(xs))
points(xs,ys,pch=3,cex=.7)
text(xs,ys-.3,paste(abs(xs),"º00' W",sep=""),cex=.7)

ys <- seq(1,11,by=2)
xs <- rep(-58,length(ys))
points(xs,ys,pch=3,cex=.7)
text(xs+.3,ys,paste(abs(ys),"º00' N",sep=""),cex=.7,srt=90)

text(aggregate(coordinates(CNEB),list(CNEB.nm$bioreg),median)[-1,2:3],c("OC","AM","CM","LL","GS"),font=2,cex=1.6)

##op <- par(fig=c(0,.19,0,.5),new=TRUE,xpd=T,mar=c(0,0,0,0))
##plot(c(0,1),c(0,1),axes=F,xlab=NA,ylab=NA,pch=NA)
##legend(0,1,c("Occident","Andean mountains","Coastal mountains","Orinoco floodplain","Guayana shield"),density=mi.ds[-1], angle=mi.ag[-1], bty="n", cex=.9, col=mi.cl[-1],border=mi.cl[-1])



## agregar mapa de ubicación continental [bajar resolución...]
##op <- par(fig=c(0,.19,.5,1),new=TRUE,xpd=F,mar=c(0,0,0,0))
##plot(amgnsn,border="grey73", xlim=c(-4500004,4000004),ylim=c(-6568465,8264709))
abline(h=0,lty=3,col=1)
##plot(amgnsn[amgnsn@data$COUNTRY %in% "VENEZUELA",],col=1,add=T)
##box()
par(op)

@
<<ManuscritoMapa2,eval=true,echo=false,results=hide,fig=true,width=4,height=7>>=

plot(amgnsn,border="grey73", xlim=c(-4500004,4000004),ylim=c(-6568465,8264709))
abline(h=0,lty=3,col=1)
plot(amgnsn[amgnsn@data$COUNTRY %in% "VENEZUELA",],col=1,add=T)
box()
@

\begin{figure}[htbp]
\begin{center}
<<ManuscritoMapas,eval=true,echo=false,results=hide,fig=true,width=8,height=8>>=
cols <- c("grey42","grey77","pink3")
## realizamos una figura con los mapas de cada grupo
layout(matrix(1:4,ncol=2,byrow=T))
par(mar=c(1,0,2,0),cex=1,cex.main=2)
    


##Pieridae
plot(CNEB,border=NA)
plot(CNEB[CNEB@data$cdg %in% unique(mrps.otrs$cneb) & CNEB@data$vzla>0,], add=T, col="grey93",border="grey77")
plot(CNEB[CNEB@data$cdg %in% mrps.slc & CNEB@data$vzla>0,], add=T, col="grey63",border="grey23")

plot(vzla,border="grey33",add=T)
tmp <- info.NM$CNEB[match(as.numeric(unique(tvn.NM$NM)),info.NM$NM)]
mrps.nms <- unique(tmp[!is.na(tmp)])
symbols(coordinates(CNEB[CNEB@data$cdg %in% mrps.nms,]),circle=rep(1,length(mrps.nms)),inches=.021,add=T,fg=1)
symbols(coordinates(CNEB[CNEB@data$cdg %in% rownames(mrps.CN),]),circle=rep(1,nrow(mrps.CN)),inches=.021,add=T,fg=1,bg=1)
#title(main="(a)",adj=0)
title(main="Butterflies",adj=0)

polygon(coordinates(ll1),lwd=5)
text(coordinates(ll3)[c(1,3),1],coordinates(ll3)[c(1,3),2]+.3,c("0","200km"),cex=1.1)

##Escarabajos
plot(CNEB,border=NA)
plot(CNEB[CNEB@data$cdg %in% lit.scrb & CNEB@data$vzla>0,], add=T, col="grey93",border="grey77")
plot(CNEB[CNEB@data$cdg %in% scrb.slc & CNEB@data$vzla>0,], add=T, col="grey63",border="grey23")

plot(vzla,border="grey33",add=T)
scrb.nms <- unique(scrb.rsm$CNEB[scrb.rsm$NM %in% c(slc.06,slc.09)])
symbols(coordinates(CNEB[CNEB@data$cdg %in% unique(scrb.rsm$CNEB),]),circle=rep(1,luq(scrb.rsm$CNEB)),inches=.021,add=T,fg=1)
symbols(coordinates(CNEB[CNEB@data$cdg %in% scrb.nms,]),circle=rep(1,length(scrb.nms)),inches=.021,add=T,fg=1,bg=1)
##title(main="(b)",adj=0)
title(main="Dung beetles",adj=0)


##Aves
plot(CNEB,border=NA)
plot(CNEB[CNEB@data$cdg %in% rownames(aves.GBIF),],add=T,col="grey93",border="grey77")
plot(CNEB[CNEB@data$cdg %in% aves.slc & CNEB@data$vzla>0,], add=T, col="grey63",border="grey23")

plot(vzla,border="grey33",add=T)
symbols(coordinates(CNEB[CNEB@data$cdg %in% slc.avs,]),circle=rep(1,length(slc.avs)),inches=.021,add=T,fg=1,bg=1)
##title(main="(c)",adj=0)
title(main="Birds",adj=0)

@
\end{center} 
\caption{Mapas. \Sexpr{nrow(aves.GBIF)/sum(CNEB.nm$VEN)} \% de cobertura de los datos de GBIF, \Sexpr{luq(lit.scrb)/sum(CNEB.nm$VEN)} \% los escarabajos y \Sexpr{luq(mrps.otrs$cneb)/sum(CNEB.nm$VEN)}
NeoMapas incluyó muestreos en \Sexpr{sum(!(mrps.nms %in% unique(mrps.otrs$cneb)))} celdas no representadas en las colecciones y literatura sobre mariposas,  \Sexpr{sum(!(unique(scrb.rsm$CNEB) %in% unique(lit.scrb)))} celdas no representadas en la literatura sobre escarabajos, y  \Sexpr{sum(!(slc.avs %in% rownames(aves.GBIF)))} celdas no representadas en los registros de GBIF sobre aves. Esto representa una expansión del \Sexpr{sum(!(mrps.nms %in% unique(mrps.otrs$cneb)))/luq(mrps.otrs$cneb)},  \Sexpr{sum(!(unique(scrb.rsm$CNEB) %in% unique(lit.scrb)))/luq(lit.scrb)} y \Sexpr{sum(!(slc.avs %in% rownames(aves.GBIF)))/nrow(aves.GBIF)}.}
\label{MAPA:TDS}
\end{figure}

\begin{figure}[htbp]
\begin{center}
<<ManuscritoCRE,eval=true,echo=false,results=hide,fig=true,width=8,height=8>>=
cols <- c("grey22","grey87","pink3","white")
## realizamos una figura con las curvas para cada grupo
layout(matrix(1:4,ncol=2,byrow=T))
par(mar=c(3,3,2,1), oma=c(3,3,0,0),cex=1,cex.lab=2,cex.main=2,cex.axis=1.6)

plot(mrps.msm.tau,
     xlab="", ylab="",  
     ylim=c(0,max.mrps*1.10),
     ci.type="polygon", col = cols[2], ci.col = cols[2],border=cols[2])
     title(main="Butterflies",adj=0)

plot(mrps.msm.tau,add=T,ci=0)
plot(mrps.tau,add=T,ci.type="polygon", col = cols[4], ci.col = cols[1],border=cols[1])
abline(h=max.mrps,lty=3,col=1)
text(35,max.mrps+6,paste("Viloria (1990):",max.mrps,"spp."),col=1,cex=1)


plot(scrb.OTR.tau, 
     xlab="", ylab="", 
     ylim=c(0,max.scrb*1.10),
     ci.type="polygon", col = cols[2], ci.col = cols[2],border=cols[2])
     title(main="Dung beetles",adj=0)

plot(scrb.OTR.tau,add=T,ci=0)
##plot(scrb.tds.tau,add=T,ci=0,lty=2)
plot(scrb.tds.tau,add=T,ci.type="polygon", col = cols[4], ci.col = cols[1],border=cols[1])
plot(scrb.tau,add=T,ci.type="line", col = 1, ci.col = cols[1],ci.lty=2)
abline(h=max.scrb,lty=3,col=1)
text(66,max.scrb+5,paste("ScarabNet:",max.scrb,"spp."),col=1,cex=1)

plot(aves.gbif,
     xlab="", ylab="", 
     ylim=c(0,max.aves*1.10),
     ci.type="polygon", col = cols[2], ci.col = cols[2],border=cols[2])
     title(main="Aves",adj=0)

plot(aves.gbif,add=T,ci=0)
plot(aves.tau,add=T,ci.type="polygon", col = cols[4], ci.col = cols[1],border=cols[1])
##plot(aves.lit.tau,add=T,ci.type="polygon", col = 2, ci.col = cols[3],border=cols[3])

abline(h=max.aves,lty=3,col=1)
text(40,max.aves+50,paste("Hilty (2003):",max.aves,"spp."),col=1,cex=1)
title(xlab="VBG cells", ylab="Accumulated species richness", outer=T,line=.5)

##symbols(c(1,2),c(1,1),boxplots=matrix(c(.5,2,0,0,.5,.5,2,0,0,.5),ncol=5,byrow=T),bg=cols,fg=cols,lwd=2,xlim=c(0.7,3),axes=F,xlab="",ylab="")
##text(c(1,2),c(1.3,1.3),c("NeoMaps","Other\nsources"))

@
\end{center} 
\caption{Curva de rarefacción del número de especies por unidad regional de análisis para cada grupo taxonómico según los datos de NeoMapas, y los de otras fuentes: Para Pieridae utilizamos datos de la literatura y colecciones nacionales, para Scarabaeinae utilizamos datos de la revisión bibliográfica, para Aves utilizamos los registros de GBIF. En el caso de Scarabaeinae la curva intermedia se basa en los datos de NeoMapas excluyendo morfotipos sin nombre válido, los cuales están subrepresentados en la fuentes bibliográficas.}
\label{FIG:CRE}
\end{figure}



\begin{figure}[htbp]
\begin{center}
<<ManuscritoBoxplot,eval=true,echo=false, results=hide, fig=true, width=8, height=8>>=
cols <- c("grey42","grey77")
cols <- c("grey22","grey87","white","black")

labs <- c("otro","Occident","Andean mountains","Coastal mountains","Llanos","Guayana")

labs <- c("otro","OC","AM","CM","LL","GY")

## realizamos una figura con las curvas para cada grupo
layout(matrix(1:4,ncol=2,byrow=T))
par(mar=c(3,3,2,1), oma=c(3,3,0,0),cex=1,cex.lab=2,cex.main=2,cex.axis=1.6)

max.y <- 60
boxplot(mrps.NM.alpha~mrps.cneb$bioreg,at=c(1:6)-.25,width=rep(.1,6),xlim=c(1.6,6.47),varwidth=T,boxwex=.3,ylim=c(0,max.y),notch=F,axes=F,col = cols[1], pars=list(boxcol=cols[4],medcol=cols[3],whisklty=1))
title(main="Butterflies",adj=0)

axis(2)
axis(1,1:6,rep("",6))
##mrps.cneb$bioreg[mrps.NM.alpha>40]
##boxplot(rowSums(mrps.OTR>0)~m2.cneb$bioreg)
boxplot(mrps.MSM.alpha~mrps.msm.cneb$bioreg,at=c(1:6)+.25,add=T,varwidth=T,boxwex=.3,col="grey74",notch=F,axes=F,pars=list(boxcol=cols[4],medcol=cols[4],whisklty=1))
box()

text(as.numeric(mrps.msm.cneb$bioreg[mrps.MSM.alpha>max.y])+.25,rep(max.y,sum(mrps.MSM.alpha>max.y)),mrps.MSM.alpha[mrps.MSM.alpha>max.y], cex=.7)
arrows(as.numeric(mrps.msm.cneb$bioreg[mrps.MSM.alpha>max.y])+.25, rep(max.y-4,sum(mrps.MSM.alpha>max.y)), as.numeric(mrps.msm.cneb$bioreg[mrps.MSM.alpha>max.y])+.25, rep(max.y-1.2,sum(mrps.MSM.alpha>max.y)),length = 0.03)

max.y <- 40
boxplot(scrb.NM.alpha~scrb.cneb$bioreg,at=c(1:6)-.25,width=rep(.1,6),xlim=c(1.6,6.47),varwidth=T,boxwex=.3,ylim=c(0,max.y),notch=F,axes=F,col = cols[1],pars=list(boxcol=cols[4],medcol=cols[3],whisklty=1))
title(main="Dung beetles",adj=0)
axis(2)
axis(1,1:6,rep("",6))
##scrb.cneb$bioreg[scrb.NM.alpha>40]
##boxplot(rowSums(mrps.OTR>0)~m2.cneb$bioreg)
boxplot(scrb.OTR.alpha~scrb.OTR.cneb$bioreg,at=c(1:6)+.25,add=T,varwidth=T,boxwex=.3,col="grey74",notch=F,axes=F,pars=list(boxcol=cols[4],medcol=cols[4],whisklty=1))
box()

text(as.numeric(scrb.OTR.cneb$bioreg[scrb.OTR.alpha>max.y])+.25,rep(max.y,sum(scrb.OTR.alpha>max.y)),scrb.OTR.alpha[scrb.OTR.alpha>max.y], cex=.7)
arrows(as.numeric(scrb.OTR.cneb$bioreg[scrb.OTR.alpha>max.y])+.25, rep(max.y-4,sum(scrb.OTR.alpha>max.y)), as.numeric(scrb.OTR.cneb$bioreg[scrb.OTR.alpha>max.y])+.25, rep(max.y-1.2,sum(scrb.OTR.alpha>max.y)),length = 0.03)

max.y <- 350
boxplot(aves.NM.alpha~aves.cneb$bioreg,at=c(1:6)-.25,width=rep(.1,6),xlim=c(1.6,6.47),varwidth=T,boxwex=.3,ylim=c(0,max.y),notch=F,axes=F,col = cols[1],pars=list(boxcol=cols[4],medcol=cols[3],whisklty=1))
title(main="Aves",adj=0)
axis(2)
axis(1,seq(1,6,by=2),labs[seq(1,6,by=2)])
axis(1,seq(2,6,by=2),labs[seq(2,6,by=2)],line=1.1,lty=0)
boxplot(aves.GBIF.alpha~aves.gbif.cneb$bioreg,at=c(1:6)+.25,add=T,varwidth=T,boxwex=.3,col=cols[2],notch=F,axes=F,pars=list(boxcol=cols[4],medcol=cols[4],whisklty=1))
##boxplot(aves.LIT.alpha~aves.lit.cneb$bioreg,at=c(1:6)+.5,add=T,varwidth=T,boxwex=.3,col=cols[3],border=2,notch=F,axes=F)
box()

text(as.numeric(aves.gbif.cneb$bioreg[aves.GBIF.alpha>max.y])+.25,rep(max.y,sum(aves.GBIF.alpha>max.y)),aves.GBIF.alpha[aves.GBIF.alpha>max.y], cex=.7)
arrows(as.numeric(aves.gbif.cneb$bioreg[aves.GBIF.alpha>max.y])+.25, rep(max.y-24,sum(aves.GBIF.alpha>max.y)), as.numeric(aves.gbif.cneb$bioreg[aves.GBIF.alpha>max.y])+.25, rep(max.y-10.2,sum(aves.GBIF.alpha>max.y)),length = 0.03)


par(xpd=T)
##symbols(c(1,2),c(1,1),boxplots=matrix(c(.5,2,1,1,.5,.5,2,1,1,.5),ncol=5,byrow=T),bg=cols,fg=1,lwd=1,xlim=c(0.7,2.3),ylim=c(.25,1.95),axes=F,lty=1,xlab="",ylab="")

bxp(list(stats=matrix(c(.5,1,2,3,3.5,.5,1,2,3,3.5,.5,1,2,3,3.5),ncol=3),
n=c(10,0,10), conf=matrix(c(0,4.5,0,4.5,0,4.5),ncol=3), out=c(5,5), group=c(1,3), names=c("NeoMaps", NA,"Previous data")), pars=list(boxcol=c(cols[4],NA,cols[4]),medcol=c(cols[3],NA,cols[4]),whisklty=1,boxfill=c(cols[1],NA,cols[2]), whiskcol=c(cols[4],NA,cols[4]), staplecol=c(cols[4],NA,cols[4])), width=c(.15,0.4,.15),axes=F,show.names=T)

arrows(3,5.15,3,5.35,length = 0.03)

text(c(2),c(0,1,2,3,4, 5.3),c("","25%","50%","75%","1.5 interquantile\nrange","outlying\nobservations"),cex=1.05)

text(c(1,3),c(-.19,-.19),c("NeoMaps","Previous\ndata"),cex=1.4)

title(xlab=NA, ylab="Number of species per cell", outer=T,line=1)
@ 
\end{center} 
\caption{Riqueza $\alpha$ para las celdas de la CNEB por cada bioregión y cada grupo taxonómico según los datos de NeoMapas, y los de otras fuentes: Para Pieridae utilizamos datos de la literatura y colecciones nacionales, para Scarabaeinae utilizamos datos de la revisión bibliográfica, para Aves utilizamos los registros de GBIF.}
\label{FIG:ALPHA}
\end{figure}


\begin{figure}[htbp]
\begin{center}
<<ManuscritoFigAves,eval=true,echo=false, results=hide, fig=true, width=8, height=8>>=

layout(matrix(1:2,ncol=1))

spp.det <- aves.rslt.data$S.obs.x
spp.det <- aves.rslt.data$ACE
spp.esp <- aves.rslt.data$list
br <- CNEB.nm$bioreg[match(aves.rslt.data$cneb,CNEB.nm$cdg)]

 plot(spp.det~spp.esp,xlab="Expected species richness",ylab=expression(S[ACE]))
points(spp.det~spp.esp,subset=br!="Guayana",pch=19)
mi.lm1 <- lm(spp.det~spp.esp,subset=br!="Guayana")
abline(a=0,b=mean((spp.det/spp.esp)[br != "Guayana"])
,lty=2)

LITdst.1 <- vegdist(aves.LIT.um[aves.lit.cneb$bioreg != "Guayana",], "jaccard", binary=T)
NMdst.1 <- vegdist(aves.NM[aves.cneb$bioreg != "Guayana",],"chao")
LITdst <- vegdist(aves.LIT.um,"bray",binary=T) ## = Sorensen
LITdst <- vegdist(aves.LIT.um,"jaccard",binary=T) 
NMdst <- vegdist(aves.NM,"chao")

plot(LITdst,NMdst,col="grey47",xlab=expression(paste("Expected biotic distance (", D[jaccard],")")),ylab=expression(D[Chao]))
points(LITdst.1,NMdst.1,pch=19)
abline(a=0,b=1,lty=2)
##lines(supsmu(LITdst,NMdst),col=1,lwd=2)

mantel(LITdst,NMdst)
##mantel(LITdst.1,NMdst.1)
cor.test(spp.det[br!="Guayana"],spp.esp[br!="Guayana"])
cor.test(spp.det,spp.esp)

##mi.lm2 <- lm(spp.det~poly(spp.esp,degree=2))
## lines(50:550,predict(mi.lm2,newdata=data.frame(spp.esp=50:550)),lwd=2)




@
\end{center} 
\caption{Correlación entre riqueza estimada y distancia biótica estimada para las celdas de aves, y los valores esperados según las listas.}
\label{FIG:CORR}
\end{figure}


\setkeys{Gin}{width=.75\textwidth}
\begin{figure}[htbp]
\begin{center}
<<PrediccionEspacialConteos, echo=false, eval=true, results=hide, fig=true, width=7, height=12>>=
mi.ss <- jmp.NM$valido=="SI"
tt <- aggregate(jmp.NM$jmp[mi.ss],by=list(fase=jmp.NM$fase[mi.ss], CN=jmp.NM$CN[mi.ss], spp=jmp.NM$spp[mi.ss]),luq)
colnames(tt)[4] <- "njmp"

t2 <- aggregate(tvn.NM$sfrz,by=list(fase=tvn.NM$fase, CN=tvn.NM$CN),sum,na.rm=T)
colnames(t2)[3] <- "sfrz"

t3 <- merge(tt,t2,by=c("fase","CN"),all.x=T)
t3$tjmp <- t3$njmp*60/t3$sfrz
t3[,c("x","y")] <- coordinates(CNEB)[match(t3$CN,CNEB@data$cdg),]
t2[,c("x","y")] <- coordinates(CNEB)[match(t2$CN,CNEB@data$cdg),]

spp="Anartia jatrophae"
spp="Anartia amathea"
spp <- "Euptoieta hegesia"
spp <- "Dryadula phaetusa"
spp <- "Phoebis sennae"

spp <- "Eurema phiale"
spp="Anartia amathea"

layout(matrix(1:2,ncol=1))
par(mar=c(0,0,0,0))
##for (spp in spps) {
	mi.ss <- t3$spp==spp
	plot(vzla,border="maroon",ylim=c(0,13))
##	title(main=spp,line=-3)
	symbols(t3$x[mi.ss],t3$y[mi.ss], circle=log1p(t3$tjmp[mi.ss]), inches=.1,add=T, bg=t3$fase[mi.ss])
##}

pp <- t3[mi.ss,]
aa <- t2[!(paste(t2$fase,t2$CN) %in% paste(t3$fase[mi.ss],t3$CN[mi.ss])),]
aa$njmp <- 0

mi.dt <- rbind(pp[,colnames(aa)],aa)
mi.dt$fase <- as.factor(mi.dt$fase)

nw.dt <- data.frame(coordinates(CNEB),fase=factor(2,levels=levels(mi.dt$fase)))
colnames(nw.dt) <- c("x","y","fase")

mi.gam <- gam(njmp~s(x,y)+fase, weights=sfrz/1000, data=mi.dt, subset=mi.dt$sfrz>100, family=poisson(log))

CNEB@data$abnd <- round(predict(mi.gam, nw.dt,type="response"),3)

grps <-cut(CNEB@data$abnd,breaks=c(-1,quantile(CNEB@data$abnd[CNEB@data$abnd>0], p=(1:9)/9)))
cols <- c(NA,brewer.pal(9, "YlOrRd"))
plot(CNEB,col=cols[as.numeric(grps)],border=cols[as.numeric(grps)])
plot(vzla,add=T)

symbols(t3$x[mi.ss],t3$y[mi.ss], squares=log1p(t3$tjmp[mi.ss]), inches=.2,add=T)
##symbols(aa$x,aa$y, circles=log1p(aa$sfrz), inches=.07,add=T)
@
\end{center} 
\caption{Ejemplo de predicción espacial de conteos para la especie \emph{\Sexpr{spp}}.}
\label{MAPA:MRPSABND}
\end{figure}
Para las especies más abundantes y de distribución amplia es posible utilizar  modelos aditivos generalizados para realizar una predicción espacial de los conteos esperados de cada especie. Los mapas generados son un primer estimado de los patrones espaciales de abundancia de estas especies. 
En la figura \ref{MAPA:MRPSABND} se observa el ejemplo de \emph{\Sexpr{spp}}. 



Hacemos un análisis de coordenadas principales para ver como explican las variables seleccionadas la relación entre especies y regiones. En la figura observamos el resultado del análisis de escarabajos basado en la raíz cuadrada de la distancia de \emph{chao}. Se observan las variables en azul (flechas para las variables continuas y nombre para las categóricas), los nombres de las localidades en gris y las especies en rojo. Se colocan los nombres de las especies que se pueden considerar indicadoras de las demás especies.

\begin{figure}[htbp]
\begin{center}

<<eval=true, echo=false, results=hide, fig=true>>=

x <- capscale(scrb.NM~PC1+PC2+PC3+bioreg,data=scrb.cneb,
              sqrt.dist = TRUE,
              distance = "chao", dfun=vegdist)
##x <- rda(decostand(scrb.NM,method="log"))
y <- plot(x,scaling=-1,col=2,pch=4,type="none")
text(x,display="cn",scaling=-1,col="blue",cex=.7)
text(x, display = "wa",cex=.5,col="grey56",scaling=-1)
points(x,scaling=-1,display="sp",col=2,pch=3,cex=.6,select=colnames(scrb.NM)[rowSums(indpower(scrb.NM),na.rm=T)<=43])
##identify(y,what="species")
text(x,scaling=-1,display="sp",select=colnames(scrb.NM)[rowSums(indpower(scrb.NM),na.rm=T)>43],cex=.5,col=2)


@ 
\end{center} 
\caption{Coordenadas principales de la composición de escarabajos coprófagos}
\label{FIG:CAPSCRB}
\end{figure}


\setkeys{Gin}{width=.75\textwidth}
  \begin{figure}[htbp]
\begin{center}
<<eval=true, echo=false, results=hide, fig=true, height=6,width=6>>=
mi.mtz <- scrb.NM
mi.d1 <- vegdist(mi.mtz,"chao")
mi.h1 <- as.dendrogram(as.hclust(agnes(mi.d1)), hang=.2)

mis.clrs <- c(1,"brown")[1+(scrb.rsm$p.id<.1)]
mis.pchs <- c(24,21)[1+(scrb.rsm$cb>50)]
names(mis.clrs) <- paste("NM",scrb.rsm$NM, " :: ",scrb.rsm$yr,sep="")
names(mis.pchs) <- paste("NM",scrb.rsm$NM, " :: ",scrb.rsm$yr,sep="")

 colLab <- function(n) {
           if(is.leaf(n)) {
             a <- attributes(n)
             attr(n, "nodePar") <- c(a$nodePar,
                                     list(lab.font=1,
                                          col=1,bg=mis.clrs[a$label],
                                          lab.col=mis.clrs[a$label],
                                          pch=mis.pchs[a$label],cex=1.35,
                                          lab.cex=.88))

           }
           n
     }
     h0e <- dendrapply(mi.h1, colLab)

par(mar=c(5,4,1,1))
plot(h0e,ylab="Índice de disimilitud (Chao)")
@ 
\end{center} 
\caption{Dendrograma de la clasificación de los muestreos de NeoMapas de 2006 y 2009, según la disimilitud de chao y el algoritmo de aglomeración \emph{agnes}. Los círculos denotan muestreos con predominancia de cebos de heces, y los triángulos indican predominancia de otros tipos de cebos (carne en descomposición, frutas, etc). Las transecciones con identificación incompleta están resaltadas en marrón. Ver tabla \ref{TAB:SCRB}.}
\label{FIG:DENDROSCRB}
\end{figure}

Los resultados de NeoMapas permiten explorar la composición de especies entre transecciones, incluso tomando en cuenta las diferencias en esfuerzo de muestreo y la combinación de cebos utilizados (Fig.~\ref{FIG:DENDROSCRB}). En este caso sólo se incluyen las transecciones identificadas por A.~Solís, para evitar confusiones en la nomenclatura de morfotipos. 

<<Todos los AICS, results=tex, echo=false>>=
aics.mrps$grp <- "Pieridae"
aics.scrb$grp <- "Scarabaeinae"
aics.aves$grp <- "Aves"

tabla.aics <- rbind(aics.mrps,aics.scrb,aics.aves)
tabla.aics$R2.adj[tabla.aics$R2.adj<0] <- 0
tabla.aics <- tabla.aics[tabla.aics$vd!="abnd",c("grp", "vd", "formula", "k", "n", "logLik", "AICc", "aic.weights", "R2.adj")]
tabla.aics <- tabla.aics[order(tabla.aics$grp,tabla.aics$vd,tabla.aics$AICc),]

print(xtable(tabla.aics[tabla.aics$aic.weights>.1,],digits=c(0,0,0,0,0,0,2,2,3,2),caption="Comparación de pesos de Akaike para todos los modelos ajustados a los tres grupos taxonómicos"), include.rownames=F, caption.placement="top", size="footnotesize")


@

<<>>=
aggregate(tabla.aics$R2.adj[tabla.aics$aic.weights>.1],list(tabla.aics$grp[tabla.aics$aic.weights>.1],tabla.aics$vd[tabla.aics$aic.weights>.1]),range)

with(tabla.aics[grep("PC1",tabla.aics$formula),],rowsum(aic.weights,grp))

@

Regression alternativa sin ponderación:

<<tablaAICmrps,echo=false, eval=true, results=tex>>=
	aics.alt <- data.frame()
	mis.vars <- c("bioreg","PC1","PC2","PC3")
	k <- length(mis.vars)
	aves.sfrz <- NULL

for (grp in c("mrps","scrb","aves")) {
	mi.cneb <- get(paste(grp,"cneb",sep="."))
for (mi.vd in c("abnd","sd","H0","ACE")) {
	mi.wg <- NULL	
		
	mi.lm <- lm(formula(paste(paste(mi.vd, grp, sep="."), "~", 1)),data=mi.cneb, weights=mi.wg)
	aics <- data.frame(grp=grp, vd=mi.vd, formula="~1", R2.adj=summary(mi.lm)$adj.r.squared, logLik=logLik(mi.lm)[[1]], k=mi.lm$rank+1, n=nrow(mi.lm$model), AIC=AIC(mi.lm), deltaAIC=NA, wi=NA, aic.weights=NA)			
	
	for (i in 1:k) {
		kiis <- combinations(k,i)
		for (j in 1:nrow(kiis)) {
			mi.frm <- paste(paste(mi.vd, grp, sep="."), "~", paste(mis.vars[kiis[j,]], collapse="+"))
			mi.lm <- lm(formula(mi.frm),data=mi.cneb, weights=mi.wg)
			aics <- rbind(aics, data.frame(grp=grp,vd=mi.vd, formula=paste(mis.vars[kiis[j,]], collapse="+"), R2.adj=summary(mi.lm)$adj.r.squared, logLik=logLik(mi.lm)[[1]], k=mi.lm$rank+1,n=nrow(mi.lm$model), AIC=AIC(mi.lm), deltaAIC=NA,wi=NA, aic.weights=NA))			
		}
	}
	

	aics$AICc <- aics$AIC + (2*aics$k*(aics$k+1))/(aics$n-aics$k-1)
	
	aics$deltaAIC <- aics$AICc - min(aics$AICc)
	aics$wi<-exp(1)^(-0.5*aics$deltaAIC)
	aics$aic.weights<-aics$wi/sum(aics$wi)

	mi.lm <- lm(formula(paste(paste(mi.vd,grp,sep="."),"~",
			tds.vars)),data=mi.cneb, weights=mi.wg)
	mi.st <- step(mi.lm, trace=FALSE)			
	aics <- rbind(aics, data.frame(grp=grp,vd=mi.vd, formula=paste(colnames(mi.st$model)[2:(ncol(mi.st$model))]
, collapse=" + "), R2.adj=summary(mi.st)$adj.r.squared, logLik=logLik(mi.st)[[1]],k=mi.st$rank+1, n=nrow(mi.st$model),  	AIC=AIC(mi.st),deltaAIC=NA, wi=NA, aic.weights=NA, AICc=NA))

	aics <- rbind(aics, data.frame(grp=grp, vd=mi.vd, formula=tds.vars, R2.adj=summary(mi.lm)$adj.r.squared, logLik=logLik(mi.lm)[[1]],k=mi.lm$rank+1, n=nrow(mi.lm$model), AIC=AIC(mi.lm), deltaAIC=NA, wi=NA,aic.weights=NA, AICc=NA))

	aics.alt <- rbind(aics.alt,aics)
}
}

aics.alt <- aics.alt[!is.na(aics.alt$aic.weights), ]

print(xtable(aics.alt[aics.alt$aic.weights>0.1, c("vd","formula","k","n","logLik","AICc","aic.weights","R2.adj")], caption="Pesos de Akaike para todos los modelos ajustados a la riqueza, diversidad y abundancia de mariposas Pieridae en los muestreos de 2006.", label="TAB:AICCMRPS", digits=c(0,0,0,0,0,2,2,3,2)), caption.placement="top", size="footnotesize", include.rownames=F)


y <- data.frame(t(estimateR(aves.GBIF.um)))
y$C.ACE <- y$S.obs/y$S.ACE
 y <- cbind(y,CNEB.nm[match(rownames(aves.GBIF.um), CNEB.nm$cdg), c("PC1", "PC2", "PC3","bioreg")])
y$n <-  rowSums(aves.GBIF.um)

mi.lm <- lm(S.ACE~PC1+PC2+PC3+bioreg,data=y,weights=C.ACE,subset=n>100)

with(CNEB.nm[CNEB.nm$UM>0,],plot(PC2,PC1, col="grey77",pch=19))
with(y,symbols(PC2,PC1,circle=S.obs,inches=.12,fg="orangered",add=T))
with(aves.rslt.data,symbols(aves.cneb$PC2,aves.cneb$PC1,ACE,fg="green",inches=.12,add=T))


d.NM <- density(aves.cneb$PC1,weights=aves.completitud/sum(aves.completitud))
d.gbif <- density(CNEB.nm[match(rownames(aves.GBIF.um), CNEB.nm$cdg), c("PC1")],weights=rowSums(aves.GBIF.um)/sum(aves.GBIF.um))
d.UM <- density(CNEB.nm[CNEB.nm$UM>0,"PC1"])

##p.NM <- sum(d.UM$y)*nrow(aves.cneb)/sum(CNEB.nm$UM>0)
##d.NM$y <- d.NM$y*p.NM/sum(d.NM$y)
##p.gbif <- sum(d.UM$y)*nrow(aves.GBIF.um)/sum(CNEB.nm$UM>0)
##d.gbif$y <- d.gbif$y*p.gbif/sum(d.gbif$y)

d.NM$y <- d.NM$y*sum(d.UM$y)/sum(d.NM$y)
d.gbif$y <- d.gbif$y*sum(d.gbif$y)/sum(d.NM$y)

##d.NM$y <- d.NM$y*p.NM/sum(d.NM$y)

plot(d.UM)
lines(d.NM,col=2)
lines(d.gbif,col=3)


@ 

La completitud de los datos de otras fuentes:

<<Cci>>=

Cci <- function(S.obs,S.est,S.var) {
	C <- S.obs/S.est
	var <- ((S.obs/S.est^2)^2) * S.var
	ci <- sqrt(var)*1.96
	sprintf("%.2f (%.2f -- %.2f)",C,C-ci,C+ci)
}

tt <- data.frame(t(estimateR(aves.GBIF)))


 table(rowSums(aves.GBIF)>rowSums(aves.GBIF>0)*1.5, !is.na(tt$se.chao1) & (tt$se.chao1)<tt$S.obs)

mi.ss <- rowSums(aves.GBIF)>rowSums(aves.GBIF>0)*1.5 & !is.na(tt$se.chao1) & (tt$se.chao1)<tt$S.obs

mi.ss <- rowSums(aves.GBIF)>10 & rowSums(aves.GBIF)>rowSums(aves.GBIF>0) & !is.na(tt$se.chao1) & (tt$se.chao1)<tt$S.obs

 aves.slc <- rownames(aves.GBIF)[mi.ss]


table(mi.ss)/nrow(tt)
tt[mi.ss,"S.obs"]/tt[mi.ss,"S.chao1"]
table(mi.ss,rownames(tt) %in% CNEB.nm$cdg[CNEB.nm$UM==1])
 table(rowSums(aves.GBIF)>10,is.na(tt$se.chao1) & tt$se.chao1>0 & (tt$se.chao1)<tt$S.obs)

## alternative adequate sampled

## antes era estimateR.matrix, ¿por qué?
tt <- data.frame(t(estimateR(scrb.OTR)))
table(!is.na(tt$se.chao1) & tt$se.chao1>0 & (tt$se.chao1)<tt$S.obs)/nrow(tt)

tt <- data.frame(t(estimateR(mrps.OTR)))
table(!is.na(tt$se.chao1) & tt$se.chao1>0 & (tt$se.chao1)<tt$S.obs)/nrow(tt)

table(!is.na(tt$se.chao1) & tt$se.chao1>0 & (tt$se.chao1)<tt$S.obs,rownames(tt) %in% CNEB.nm$cdg[CNEB.nm$UM==1])

varpart(H0.mrps,~x+y,~PC1+PC2+PC3,~bioreg,data=mrps.cneb)

varpart(ACE.mrps[!is.na(ACE.mrps)],~poly(x,y,degree=2),~PC1+PC2+PC3,~bioreg,data=mrps.cneb[!is.na(ACE.mrps),])

varpart(ACE.aves[!is.na(ACE.aves)],~poly(x,y,degree=2),~PC1+PC2+PC3,~bioreg,data=aves.cneb[!is.na(ACE.aves),])

varpart(ACE.aves[!is.na(ACE.aves)],~poly(x,y,degree=2),~PC1+PC2+PC3,~bioreg,data=aves.cneb[!is.na(ACE.aves),])

lm.100 <- lm(ACE.aves~poly(x,y,degree=2), data=aves.cneb, weights=aves.completitud)
lm.010 <- lm(ACE.aves~PC1+PC2+PC3, data=aves.cneb, weights=aves.completitud)
lm.001 <- lm(ACE.aves~bioreg, data=aves.cneb, weights=aves.completitud)

lm.110 <- lm(ACE.aves~poly(x,y,degree=2)+PC1+PC2+PC3, data=aves.cneb, weights=aves.completitud)
lm.011 <- lm(ACE.aves~PC1+PC2+PC3+bioreg, data=aves.cneb, weights=aves.completitud)
lm.101 <- lm(ACE.aves~poly(x,y,degree=2)+bioreg, data=aves.cneb, weights=aves.completitud)

lm.111 <- lm(ACE.aves~poly(x,y,degree=2)+PC1+PC2+PC3+bioreg, data=aves.cneb, weights=aves.completitud)

summary(lm.111)$adj.r.squared
@

<<results=tex>>=
##Regression alternativa partición de varianza:

	aics.alt <- data.frame()
	mis.vars <- c("bioreg","PC1","PC2","PC3","poly(x,y,degree=2)")
	k <- length(mis.vars)
	aves.sfrz <- NULL

for (grp in c("mrps","scrb","aves")) {
	mi.cneb <- get(paste(grp,"cneb",sep="."))
for (mi.vd in c("sd","H0","ACE")) {
	mi.wg <- 	get(paste(grp,"completitud",sep="."))
		
	mi.lm <- lm(formula(paste(paste(mi.vd, grp, sep="."), "~", 1)),data=mi.cneb, weights=mi.wg)
	aics <- data.frame(grp=grp, vd=mi.vd, formula="~1", R2.adj=summary(mi.lm)$adj.r.squared, logLik=logLik(mi.lm)[[1]], k=mi.lm$rank+1, n=nrow(mi.lm$model), AIC=AIC(mi.lm), deltaAIC=NA, wi=NA, aic.weights=NA)			
	
	for (i in 1:k) {
		kiis <- combinations(k,i)
		for (j in 1:nrow(kiis)) {
			mi.frm <- paste(paste(mi.vd, grp, sep="."), "~", paste(mis.vars[kiis[j,]], collapse="+"))
			mi.lm <- lm(formula(mi.frm),data=mi.cneb, weights=mi.wg)
			aics <- rbind(aics, data.frame(grp=grp,vd=mi.vd, formula=paste(mis.vars[kiis[j,]], collapse="+"), R2.adj=summary(mi.lm)$adj.r.squared, logLik=logLik(mi.lm)[[1]], k=mi.lm$rank+1,n=nrow(mi.lm$model), AIC=AIC(mi.lm), deltaAIC=NA,wi=NA, aic.weights=NA))			
		}
	}
	

	aics$AICc <- aics$AIC + (2*aics$k*(aics$k+1))/(aics$n-aics$k-1)
	
	aics$deltaAIC <- aics$AICc - min(aics$AICc)
	aics$wi<-exp(1)^(-0.5*aics$deltaAIC)
	aics$aic.weights<-aics$wi/sum(aics$wi)


	aics.alt <- rbind(aics.alt,aics)
}
}

aics.alt <- aics.alt[!is.na(aics.alt$aic.weights), ]

print(xtable(aics.alt[aics.alt$aic.weights>0.1, c("vd","formula","k","n","logLik","AICc","aic.weights","R2.adj")], caption="Pesos de Akaike para todos los modelos ajustados a la riqueza, diversidad y abundancia de mariposas Pieridae en los muestreos de 2006.", label="TAB:AICCMRPS", digits=c(0,0,0,0,0,2,2,3,2)), caption.placement="top", size="footnotesize", include.rownames=F)


@


Otros objetos para los anexos
<<eval=true>>=
save(file="~/NeoMapas/Rdata/Anexos.rda", scrb.NM, scrb.rsm, scrb.cneb, d1.scrb, mrps.NM, mrps.cneb, d1.mrps, aves.NM, aves.cneb, d1.aves, trans.info) ## falta Scarab
@

\chapter{Localidades de muestreo}

<<GenerarKML,echo=false,results=hide, eval=false>>=

@

\chapter{Complementariedad entre fuentes}

<<GenerarKML,echo=false,results=hide, eval=false>>=
rws <- unique(c(rownames(mrps.MSM.um),as.character(mrps.cneb$cdg)))
cls <- unique(c(colnames(mrps.MSM.um),colnames(mrps.NM)))

mtz <- matrix(0,ncol=length(cls),nrow=length(rws),dimnames=list(rws,cls))

mtz[rownames(mrps.MSM.um),colnames(mrps.MSM.um)] <- mtz[rownames(mrps.MSM.um),colnames(mrps.MSM.um)]+ (mrps.MSM.um>0)

mtz[as.character(mrps.cneb$cdg),colnames(mrps.NM)] <- 
mtz[as.character(mrps.cneb$cdg),colnames(mrps.NM)] + (mrps.NM>0)*2

mtz <- mtz[order(rownames(mtz) %in% mrps.slc, rownames(mtz) %in% mrps.slc &  !rownames(mtz) %in% as.character(mrps.cneb$cdg), rownames(mtz) %in% as.character(mrps.cneb$cdg), rowSums(mtz), decreasing=F), order(colSums(mtz),decreasing=T)]

mtz <- mtz[order(CNEB.nm$bioreg[match(rownames(mtz),CNEB.nm$cdg)], rowSums(mtz), decreasing=F), order(colSums(mtz),decreasing=T)]

image(t(mtz),col=c(NA,1,2,3),xlab="Species",ylab="Cells",axes=F)
abline(h=cumsum(table(CNEB.nm$bioreg[match(rownames(mtz),CNEB.nm$cdg)]))/nrow(mtz))

xxs <- data.frame()
for (br in levels(CNEB.nm$bioreg)) {
	xxs <- rbind(xxs,table(mtz[CNEB.nm$bioreg[match(rownames(mtz),CNEB.nm$cdg)]==br]))
}

rownames(xxs) <- levels(CNEB.nm$bioreg)[-1]

	xxs <- rbind(xxs,total=table(mtz))
xxs <- xxs[,-1]
xxs/rowSums(xxs)

## alternative order: first well surveyed, then NeoMaps, then other cells

rownames(mtz) %in% mrps.slc


rws <- unique(c(rownames(scrb.OTR.um),as.character(scrb.cneb$cdg)))
cls <- unique(c(colnames(scrb.OTR.um),gsub("\\.", " ",colnames(scrb.NM))))

mtz <- matrix(0,ncol=length(cls),nrow=length(rws),dimnames=list(rws,cls))

mtz[rownames(scrb.OTR.um),colnames(scrb.OTR.um)] <- mtz[rownames(scrb.OTR.um),colnames(scrb.OTR.um)]+(scrb.OTR.um>0)

mtz[as.character(scrb.cneb$cdg),gsub("\\.", " ",colnames(scrb.NM))] <- 
mtz[as.character(scrb.cneb$cdg),gsub("\\.", " ",colnames(scrb.NM))] + (as.matrix(scrb.NM)>0)*2

table(mtz)

mtz <- mtz[order(CNEB.nm$bioreg[match(rownames(mtz),CNEB.nm$cdg)], rowSums(mtz), decreasing=F), order(colSums(mtz),decreasing=T)]

image(t(mtz),col=c(NA,1,2,3),xlab="Species",ylab="Cells",axes=F)
abline(h=cumsum(table(CNEB.nm$bioreg[match(rownames(mtz),CNEB.nm$cdg)]))/nrow(mtz))


rws <- unique(c(rownames(aves.GBIF.um),as.character(aves.cneb$cdg)))
cls <- unique(c(colnames(aves.GBIF.um),colnames(aves.NM)))

mtz <- matrix(0,ncol=length(cls),nrow=length(rws),dimnames=list(rws,cls))


mtz[as.character(aves.cneb$cdg),colnames(aves.NM)] <- (aves.NM>0)*2
mtz[rownames(aves.GBIF.um),colnames(aves.GBIF.um)] <- mtz[rownames(aves.GBIF.um),colnames(aves.GBIF.um)]+(aves.GBIF.um>0)

mtz <- mtz[order(CNEB.nm$bioreg[match(rownames(mtz),CNEB.nm$cdg)], rowSums(mtz), decreasing=F), order(colSums(mtz),decreasing=T)]

image(t(mtz),col=c(NA,1,2,3),xlab="Species",ylab="Cells",axes=F)
abline(h=cumsum(table(CNEB.nm$bioreg[match(rownames(mtz),CNEB.nm$cdg)]))/nrow(mtz))

@


<<>>=

nm.mtz <- aggregate(mrps.NM,by=list(mrps.cneb$bioreg),sum)
msm.mtz <- aggregate(mrps.MSM.um,by=list(mrps.msm.cneb$bioreg),sum)
ncols <- unique(c(colnames(nm.mtz)[-1],colnames(msm.mtz)[-1]))
mtz <- matrix(ncol=length(ncols),nrow=10)
colnames(mtz) <- ncols
rownames(mtz) <- c(paste("NM",nm.mtz$Group.1),paste("MSM",msm.mtz$Group.1))
mtz[1:5,colnames(nm.mtz)[-1]] <- as.matrix(nm.mtz[,-1])
mtz[6:10,colnames(msm.mtz)[-1]] <- as.matrix(msm.mtz[,-1])
mtz[is.na(mtz)] <- 0
mtz[mtz>0] <- 1

##Marczewski-Steinhaus == Jaccard
C <- sum(abs(mtz[1,]-mtz[5,]))/sum(apply(mtz[c(1,5),],2,max))
C <- sum(abs(mtz[1,]-mtz[6,]))/sum(apply(mtz[c(1,6),],2,max))

diag(as.matrix(vegdist(mtz,"jaccard",binary=T))[6:10,1:5])



nm.mtz <- aggregate(scrb.NM,by=list(scrb.cneb$bioreg),sum)
colnames(nm.mtz)[-1] <- gsub("\\.", " ",colnames(nm.mtz)[-1])
msm.mtz <- aggregate(scrb.OTR.um,by=list(scrb.OTR.cneb$bioreg),sum)
ncols <- unique(c(colnames(nm.mtz)[-1],colnames(msm.mtz)[-1]))
mtz <- matrix(ncol=length(ncols),nrow=10)
colnames(mtz) <- ncols
rownames(mtz) <- c(paste("NM",nm.mtz$Group.1),paste("MSM",msm.mtz$Group.1))
mtz[1:5,colnames(nm.mtz)[-1]] <- as.matrix(nm.mtz[,-1])
mtz[6:10,colnames(msm.mtz)[-1]] <- as.matrix(msm.mtz[,-1])
mtz[is.na(mtz)] <- 0
mtz[mtz>0] <- 1

plot(hclust(vegdist(mtz,"jaccard",binary=T)))
diag(as.matrix(vegdist(mtz,"jaccard",binary=T))[6:10,1:5])


nm.mtz <- aggregate(aves.NM,by=list(aves.cneb$bioreg),sum)
msm.mtz <- aggregate(aves.GBIF.um,by=list(aves.gbif.cneb$bioreg),sum)
ncols <- unique(c(colnames(nm.mtz)[-1],colnames(msm.mtz)[-1]))
mtz <- matrix(ncol=length(ncols),nrow=10)
colnames(mtz) <- ncols
rownames(mtz) <- c(paste("NM",nm.mtz$Group.1),paste("MSM",msm.mtz$Group.1))
mtz[1:5,colnames(nm.mtz)[-1]] <- as.matrix(nm.mtz[,-1])
mtz[6:10,colnames(msm.mtz)[-1]] <- as.matrix(msm.mtz[,-1])
mtz[is.na(mtz)] <- 0
mtz[mtz>0] <- 1

plot(hclust(vegdist(mtz,"jaccard",binary=T)))
diag(as.matrix(vegdist(mtz,"jaccard",binary=T))[6:10,1:5])


Cci <- function(S.obs,S.est,S.var) {
	C <- S.obs/S.est
	var <- ((S.obs/S.est^2)^2) * S.var
	ci <- sqrt(var)*1.96
	sprintf("(%.2f -- %.2f)",C-ci,C+ci)
}

with(dts.scrb,Cci(spp.NM,chao.NM,se.NM))
with(dts.scrb,Cci(spp.GBIF,chao.GBIF,se.GBIF))
paste(with(dts.scrb,Cci(spp.total,chao.total,se.total)),collapse=" ")
paste(with(dts.mrps,Cci(spp.NM,chao.NM,se.NM)),collapse=" ")
(0.56 -- 0.71)
(0.65 -- 0.84)
(0.80 -- 1.01)
(0.67 -- 0.91)
(0.76 -- 0.99)
(0.85 -- 0.97)


(0.69 -- 0.82)
(0.70 -- 0.79)
(0.83 -- 0.93)
(0.61 -- 0.73)
(0.63 -- 0.84)
(0.92 -- 0.98)
@

\printbibliography


\end{document}
